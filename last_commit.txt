Repository: Products.Archetypes


Branch: refs/heads/1.9.x
Date: 2018-08-01T13:37:59+02:00
Author: Fred van Dijk (fredvd) <fredvd@gmail.com>
Commit: https://github.com/plone/Products.Archetypes/commit/7bc06f04b2228b0b111eef7809c7c641e633006d

Prevent AttributeError on deleting a Reference
 from object that is gone.
Backport from master #91. Fixes plone/plone.app.contenttypes#41.

Files changed:
M CHANGES.rst
M Products/Archetypes/ReferenceEngine.py

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex d5912ef3..c8d79e56 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -14,8 +14,9 @@ New features:\n \n Bug fixes:\n \n-- *add item here*\n-\n+- Prevent AttributeError on deleting a Reference from a object that is\n+  gone. Backport from master #91. Fixes plone/plone.app.contenttypes#41.\n+  [fredvd, pbauer]\n \n 1.9.18 (2018-05-03)\n -------------------\ndiff --git a/Products/Archetypes/ReferenceEngine.py b/Products/Archetypes/ReferenceEngine.py\nindex 84a75b9c..5f5ab1f3 100644\n--- a/Products/Archetypes/ReferenceEngine.py\n+++ b/Products/Archetypes/ReferenceEngine.py\n@@ -557,6 +557,8 @@ def _getUUIDFor(self, object):\n     def _deleteReference(self, referenceObject):\n         try:\n             sobj = referenceObject.getSourceObject()\n+            if sobj is None:\n+                return\n             referenceObject.delHook(self, sobj,\n                                     referenceObject.getTargetObject())\n         except ReferenceException:\n'

Repository: Products.Archetypes


Branch: refs/heads/1.9.x
Date: 2018-08-05T16:45:17+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.Archetypes/commit/7068c71c1675a1e4a8321affd771d11d0a2a318f

Merge pull request #110 from plone/fix_delete_reference

Prevent AttributeError on deleting a Reference

Files changed:
M CHANGES.rst
M Products/Archetypes/ReferenceEngine.py

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex d5912ef3..c8d79e56 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -14,8 +14,9 @@ New features:\n \n Bug fixes:\n \n-- *add item here*\n-\n+- Prevent AttributeError on deleting a Reference from a object that is\n+  gone. Backport from master #91. Fixes plone/plone.app.contenttypes#41.\n+  [fredvd, pbauer]\n \n 1.9.18 (2018-05-03)\n -------------------\ndiff --git a/Products/Archetypes/ReferenceEngine.py b/Products/Archetypes/ReferenceEngine.py\nindex 84a75b9c..5f5ab1f3 100644\n--- a/Products/Archetypes/ReferenceEngine.py\n+++ b/Products/Archetypes/ReferenceEngine.py\n@@ -557,6 +557,8 @@ def _getUUIDFor(self, object):\n     def _deleteReference(self, referenceObject):\n         try:\n             sobj = referenceObject.getSourceObject()\n+            if sobj is None:\n+                return\n             referenceObject.delHook(self, sobj,\n                                     referenceObject.getTargetObject())\n         except ReferenceException:\n'

