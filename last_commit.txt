Repository: plone.app.upgrade


Branch: refs/heads/master
Date: 2019-12-14T10:34:26+01:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.app.upgrade/commit/e66c45a237df4595fb5e6169054da00fee42d2f4

Make sure plone.staticresources is installed. https://github.com/plone/Products.CMFPlone/issues/2996

Files changed:
M plone/app/upgrade/v52/betas.py
M plone/app/upgrade/v52/final.py

b'diff --git a/plone/app/upgrade/v52/betas.py b/plone/app/upgrade/v52/betas.py\nindex 24f5faa9..b639b06f 100644\n--- a/plone/app/upgrade/v52/betas.py\n+++ b/plone/app/upgrade/v52/betas.py\n@@ -128,7 +128,17 @@ def to52beta1(context):\n     add_exclude_from_nav_index(context)\n     remove_legacy_resource_registries(context)\n     remove_interface_indexes_from_relations_catalog()\n+    # Make sure plone.staticresources is installed\n+    from Products.CMFPlone.utils import get_installer\n+    qi = get_installer(context)\n+    if not qi.is_product_installed(\'plone.staticresources\'):\n+        qi.install_product(\'plone.staticresources\')\n \n \n def to52rc1(context):\n     loadMigrationProfile(context, \'profile-plone.app.upgrade.v52:to52rc1\')\n+    # Make sure plone.staticresources is installed\n+    from Products.CMFPlone.utils import get_installer\n+    qi = get_installer(context)\n+    if not qi.is_product_installed(\'plone.staticresources\'):\n+        qi.install_product(\'plone.staticresources\')\ndiff --git a/plone/app/upgrade/v52/final.py b/plone/app/upgrade/v52/final.py\nindex a869a3ba..c60414ce 100644\n--- a/plone/app/upgrade/v52/final.py\n+++ b/plone/app/upgrade/v52/final.py\n@@ -77,6 +77,11 @@ def move_dotted_to_named_behaviors(context):\n         )\n \n     logger.info(\'Done moving dotted to named behaviors.\')\n+    # Make sure plone.staticresources is installed\n+    from Products.CMFPlone.utils import get_installer\n+    qi = get_installer(context)\n+    if not qi.is_product_installed(\'plone.staticresources\'):\n+        qi.install_product(\'plone.staticresources\')\n \n \n KEYS_TO_CHANGE = [\n@@ -116,3 +121,8 @@ def change_interface_on_lang_registry_records(context):\n def to521(context):\n     """5.2.0 -> 5.2.1"""\n     loadMigrationProfile(context, \'profile-plone.app.upgrade.v52:to521\')\n+    # Make sure plone.staticresources is installed\n+    from Products.CMFPlone.utils import get_installer\n+    qi = get_installer(context)\n+    if not qi.is_product_installed(\'plone.staticresources\'):\n+        qi.install_product(\'plone.staticresources\')\n'

Repository: plone.app.upgrade


Branch: refs/heads/master
Date: 2019-12-14T10:37:35+01:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.app.upgrade/commit/b32d035f8c39a3505d88c493685e002e7cbf33c8

add changenote

Files changed:
A docs/223.bugfix

b'diff --git a/docs/223.bugfix b/docs/223.bugfix\nnew file mode 100644\nindex 00000000..cc562b6b\n--- /dev/null\n+++ b/docs/223.bugfix\n@@ -0,0 +1,3 @@\n+Make sure plone.staticresources is installed to fix issues with site migrated from 5.0 or 5.1 to 5.2.1.\n+Fixes https://github.com/plone/Products.CMFPlone/issues/2996\n+[pbauer]\n\\ No newline at end of file\n'

Repository: plone.app.upgrade


Branch: refs/heads/master
Date: 2019-12-14T10:38:59+01:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.app.upgrade/commit/d6d5aa6cc6885e16cfa4092b9937c18727125500

ups

Files changed:
A news/223.bugfix
D docs/223.bugfix

b'diff --git a/docs/223.bugfix b/news/223.bugfix\nsimilarity index 100%\nrename from docs/223.bugfix\nrename to news/223.bugfix\n'

Repository: plone.app.upgrade


Branch: refs/heads/master
Date: 2019-12-15T20:34:47-05:00
Author: Eric Steele (esteele) <eric@esteele.net>
Commit: https://github.com/plone/plone.app.upgrade/commit/11d045556a7ac1af6d22ec08c38335191515f178

Merge pull request #223 from plone/install_staticresources_during_upgrade

Make sure plone.staticresources is installed

Files changed:
A news/223.bugfix
M plone/app/upgrade/v52/betas.py
M plone/app/upgrade/v52/final.py

b'diff --git a/news/223.bugfix b/news/223.bugfix\nnew file mode 100644\nindex 00000000..cc562b6b\n--- /dev/null\n+++ b/news/223.bugfix\n@@ -0,0 +1,3 @@\n+Make sure plone.staticresources is installed to fix issues with site migrated from 5.0 or 5.1 to 5.2.1.\n+Fixes https://github.com/plone/Products.CMFPlone/issues/2996\n+[pbauer]\n\\ No newline at end of file\ndiff --git a/plone/app/upgrade/v52/betas.py b/plone/app/upgrade/v52/betas.py\nindex 24f5faa9..b639b06f 100644\n--- a/plone/app/upgrade/v52/betas.py\n+++ b/plone/app/upgrade/v52/betas.py\n@@ -128,7 +128,17 @@ def to52beta1(context):\n     add_exclude_from_nav_index(context)\n     remove_legacy_resource_registries(context)\n     remove_interface_indexes_from_relations_catalog()\n+    # Make sure plone.staticresources is installed\n+    from Products.CMFPlone.utils import get_installer\n+    qi = get_installer(context)\n+    if not qi.is_product_installed(\'plone.staticresources\'):\n+        qi.install_product(\'plone.staticresources\')\n \n \n def to52rc1(context):\n     loadMigrationProfile(context, \'profile-plone.app.upgrade.v52:to52rc1\')\n+    # Make sure plone.staticresources is installed\n+    from Products.CMFPlone.utils import get_installer\n+    qi = get_installer(context)\n+    if not qi.is_product_installed(\'plone.staticresources\'):\n+        qi.install_product(\'plone.staticresources\')\ndiff --git a/plone/app/upgrade/v52/final.py b/plone/app/upgrade/v52/final.py\nindex a869a3ba..c60414ce 100644\n--- a/plone/app/upgrade/v52/final.py\n+++ b/plone/app/upgrade/v52/final.py\n@@ -77,6 +77,11 @@ def move_dotted_to_named_behaviors(context):\n         )\n \n     logger.info(\'Done moving dotted to named behaviors.\')\n+    # Make sure plone.staticresources is installed\n+    from Products.CMFPlone.utils import get_installer\n+    qi = get_installer(context)\n+    if not qi.is_product_installed(\'plone.staticresources\'):\n+        qi.install_product(\'plone.staticresources\')\n \n \n KEYS_TO_CHANGE = [\n@@ -116,3 +121,8 @@ def change_interface_on_lang_registry_records(context):\n def to521(context):\n     """5.2.0 -> 5.2.1"""\n     loadMigrationProfile(context, \'profile-plone.app.upgrade.v52:to521\')\n+    # Make sure plone.staticresources is installed\n+    from Products.CMFPlone.utils import get_installer\n+    qi = get_installer(context)\n+    if not qi.is_product_installed(\'plone.staticresources\'):\n+        qi.install_product(\'plone.staticresources\')\n'

