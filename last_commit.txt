Repository: plone.app.multilingual


Branch: refs/heads/master
Date: 2018-06-27T09:45:37+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.multilingual/commit/9c368dcde82b13927f495346ae231549bf45d0a2

fix LRF deprecation warning

Files changed:
M CHANGES.rst
M src/plone/app/multilingual/browser/migrator.py

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex 338ce028..e66306f4 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -14,6 +14,10 @@ New features:\n \n Bug fixes:\n \n+- Do not show deprecation warning when loading migrator code, \n+  as it is intended to load old LRF there.\n+  [jensens]\n+\n - Fixed tests now that Catalan has translated \'assets\' into \'recursos\'.\n   [maurits]\n \ndiff --git a/src/plone/app/multilingual/browser/migrator.py b/src/plone/app/multilingual/browser/migrator.py\nindex c278090c..5b702957 100644\n--- a/src/plone/app/multilingual/browser/migrator.py\n+++ b/src/plone/app/multilingual/browser/migrator.py\n@@ -3,7 +3,6 @@\n from Acquisition import aq_inner\n from Acquisition import aq_parent\n from plone.app.multilingual import _\n-from plone.app.multilingual.content.lrf import LanguageRootFolder\n from plone.app.multilingual.interfaces import ITranslationManager\n from plone.locking.interfaces import ILockable\n from Products.CMFCore.exceptions import ResourceLockedError\n@@ -19,6 +18,7 @@\n from zope.interface import Interface\n \n import logging\n+import warnings\n \n \n try:\n@@ -37,6 +37,14 @@ class IDexterityContent(Interface):\n     class IBaseObject(Interface):\n         pass\n \n+with warnings.catch_warnings():\n+    warnings.filterwarnings(\n+        "ignore", \n+        message="LanguageRootFolder: LanguageRootFolders should be migrate "\n+                "to DexterityContainers",\n+    )\n+    from plone.app.multilingual.content.lrf import LanguageRootFolder\n+\n \n LP_TRANSLATABLE = \'Products.LinguaPlone.interfaces.ITranslatable\'\n portal_types_blacklist = [\'Collage\', \'FormFolder\', \'Ploneboard\']\n'

Repository: plone.app.multilingual


Branch: refs/heads/master
Date: 2018-06-29T13:32:47+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.multilingual/commit/30ec02629261f1a03304b2204dbbb40b134e4256

Merge pull request #318 from plone/jensens/fix-LRF-deprecation-warning

fix LRF deprecation warning

Files changed:
M CHANGES.rst
M src/plone/app/multilingual/browser/migrator.py

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex 338ce028..e66306f4 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -14,6 +14,10 @@ New features:\n \n Bug fixes:\n \n+- Do not show deprecation warning when loading migrator code, \n+  as it is intended to load old LRF there.\n+  [jensens]\n+\n - Fixed tests now that Catalan has translated \'assets\' into \'recursos\'.\n   [maurits]\n \ndiff --git a/src/plone/app/multilingual/browser/migrator.py b/src/plone/app/multilingual/browser/migrator.py\nindex c278090c..5b702957 100644\n--- a/src/plone/app/multilingual/browser/migrator.py\n+++ b/src/plone/app/multilingual/browser/migrator.py\n@@ -3,7 +3,6 @@\n from Acquisition import aq_inner\n from Acquisition import aq_parent\n from plone.app.multilingual import _\n-from plone.app.multilingual.content.lrf import LanguageRootFolder\n from plone.app.multilingual.interfaces import ITranslationManager\n from plone.locking.interfaces import ILockable\n from Products.CMFCore.exceptions import ResourceLockedError\n@@ -19,6 +18,7 @@\n from zope.interface import Interface\n \n import logging\n+import warnings\n \n \n try:\n@@ -37,6 +37,14 @@ class IDexterityContent(Interface):\n     class IBaseObject(Interface):\n         pass\n \n+with warnings.catch_warnings():\n+    warnings.filterwarnings(\n+        "ignore", \n+        message="LanguageRootFolder: LanguageRootFolders should be migrate "\n+                "to DexterityContainers",\n+    )\n+    from plone.app.multilingual.content.lrf import LanguageRootFolder\n+\n \n LP_TRANSLATABLE = \'Products.LinguaPlone.interfaces.ITranslatable\'\n portal_types_blacklist = [\'Collage\', \'FormFolder\', \'Ploneboard\']\n'

