Repository: Products.PlonePAS


Branch: refs/heads/master
Date: 2019-11-11T13:07:17+01:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/Products.PlonePAS/commit/9a45ea2fd8c6c763f597d57c16839649273c0791

Plone 5.2 compatibility: fix deprecated imports

Files changed:
A news/51.bugfix
M src/Products/PlonePAS/testing.py
M src/Products/PlonePAS/tests/cookie_auth.rst

b"diff --git a/news/51.bugfix b/news/51.bugfix\nnew file mode 100644\nindex 00000000..6faa31ab\n--- /dev/null\n+++ b/news/51.bugfix\n@@ -0,0 +1,2 @@\n+Fix deprecated imports.\n+[thet]\ndiff --git a/src/Products/PlonePAS/testing.py b/src/Products/PlonePAS/testing.py\nindex 39bcf180..ffba794b 100644\n--- a/src/Products/PlonePAS/testing.py\n+++ b/src/Products/PlonePAS/testing.py\n@@ -1,12 +1,11 @@\n # -*- coding: utf-8 -*-\n from plone.app.contenttypes.testing import PLONE_APP_CONTENTTYPES_FIXTURE\n-from plone.app.testing import setRoles\n from plone.app.testing import TEST_USER_ID\n from plone.app.testing import applyProfile\n from plone.app.testing import FunctionalTesting\n from plone.app.testing import IntegrationTesting\n from plone.app.testing import PloneSandboxLayer\n-from plone.testing import z2\n+from plone.testing import zope as zope_testing\n \n import Products.PlonePAS\n \n@@ -20,7 +19,7 @@ def setUpZope(self, app, configurationContext):\n         # The z3c.autoinclude feature is disabled in the Plone fixture base\n         # layer.\n         self.loadZCML(package=Products.PlonePAS)\n-        z2.installProduct(app, 'Products.PlonePAS')\n+        zope_testing.installProduct(app, 'Products.PlonePAS')\n \n     def setUpPloneSite(self, portal):\n         applyProfile(portal, 'Products.PlonePAS:PlonePAS')\ndiff --git a/src/Products/PlonePAS/tests/cookie_auth.rst b/src/Products/PlonePAS/tests/cookie_auth.rst\nindex 7405a560..fb92ceee 100644\n--- a/src/Products/PlonePAS/tests/cookie_auth.rst\n+++ b/src/Products/PlonePAS/tests/cookie_auth.rst\n@@ -28,7 +28,7 @@ User exists in the user folder inside the Plone Site.\n \n Login to Plone Site using Basic Auth works.\n \n-  >>> from plone.testing.z2 import Browser\n+  >>> from plone.testing.zope import Browser\n   >>> browser = Browser(layer['app'])\n   >>> browser.addHeader('Authorization', 'Basic %s:%s' % (TEST_USER_NAME, TEST_USER_PASSWORD,))\n   >>> browser.open('%s/manage' % portal.absolute_url())\n"

Repository: Products.PlonePAS


Branch: refs/heads/master
Date: 2019-11-11T13:08:23+01:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/Products.PlonePAS/commit/ccfe43f58cb81d02fb24db2a483f4e10962f3a15

Fix buildout infrastructure for Plone 5.2.

Files changed:
M buildout.cfg
M news/51.bugfix
M setup.py
M travis.cfg

b"diff --git a/buildout.cfg b/buildout.cfg\nindex 93e9d85a..7bbdd5c3 100644\n--- a/buildout.cfg\n+++ b/buildout.cfg\n@@ -5,9 +5,9 @@\n #     ./bin/buildout\n \n extends =\n-    https://raw.github.com/collective/buildout.plonetest/master/test-4.x.cfg\n+    https://raw.github.com/collective/buildout.plonetest/master/test-5.2.x.cfg\n parts +=\n-    coverage \n+    coverage\n package-name = Products.PlonePAS\n package-extras = [test]\n \n@@ -19,4 +19,4 @@ eggs = ${test:eggs}\n defaults = ['--coverage', '../../coverage', '-v', '--auto-progress']\n \n [versions]\n-Products.PlonePAS = \n+Products.PlonePAS =\n\\ No newline at end of file\ndiff --git a/news/51.bugfix b/news/51.bugfix\nindex 6faa31ab..ff89e3bc 100644\n--- a/news/51.bugfix\n+++ b/news/51.bugfix\n@@ -1,2 +1,3 @@\n Fix deprecated imports.\n+Fix buildout infrastructure for Plone 5.2.\n [thet]\ndiff --git a/setup.py b/setup.py\nindex 81397d87..13c9ad16 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -58,6 +58,7 @@\n         test=[\n             'plone.app.testing',\n             'plone.testing',\n+            'plone.app.robotframework',\n         ],\n     ),\n )\ndiff --git a/travis.cfg b/travis.cfg\nindex c6b14710..f8ce1e74 100644\n--- a/travis.cfg\n+++ b/travis.cfg\n@@ -2,7 +2,7 @@\n develop = .\n extends =\n     https://raw.githubusercontent.com/collective/buildout.plonetest/master/qa.cfg\n-    https://raw.githubusercontent.com/collective/buildout.plonetest/master/travis-5.x.cfg\n+    https://raw.githubusercontent.com/collective/buildout.plonetest/master/travis-5.2.x.cfg\n \n package-name = Products.PlonePAS\n package-extras = [test]\n"

Repository: Products.PlonePAS


Branch: refs/heads/master
Date: 2019-11-11T22:23:34+01:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/Products.PlonePAS/commit/f66f8fe37a4c863fafcbe285aa0b46a64e726e03

Fix buildout infrastructure as suggested by buildout.plonetest

Files changed:
M .travis.yml
M buildout.cfg
D travis.cfg

b'diff --git a/.travis.yml b/.travis.yml\nindex c7b6f405..caac924c 100644\n--- a/.travis.yml\n+++ b/.travis.yml\n@@ -1,7 +1,25 @@\n+dist: bionic\n language: python\n python: 2.7\n+sudo: false\n+cache:\n+  pip: true\n+  directories:\n+    - eggs\n+matrix:\n+  include:\n+    - python: "2.7"\n+      env: PLONE_VERSION="5.2"\n+    - python: "3.7"\n+      env: PLONE_VERSION="5.2"\n+  sudo: true\n+  fast_finish: true\n+before_install:\n+  - virtualenv -p `which python` .\n+  - bin/pip install -r requirements.txt\n+  - sed -ie "s#test-5.2.x.cfg#test-$PLONE_VERSION.x.cfg#" buildout.cfg\n+  - bin/buildout -N -t 3 annotate\n install:\n-  - mkdir -p buildout-cache/downloads\n-  - pip install zc.buildout\n-  - buildout -c travis.cfg -N -q -t 3\n-script: bin/code-analysis && bin/test\n+  - bin/buildout -N -t 3\n+script:\n+  - bin/test\ndiff --git a/buildout.cfg b/buildout.cfg\nindex 7bbdd5c3..863b4d98 100644\n--- a/buildout.cfg\n+++ b/buildout.cfg\n@@ -19,4 +19,4 @@ eggs = ${test:eggs}\n defaults = [\'--coverage\', \'../../coverage\', \'-v\', \'--auto-progress\']\n \n [versions]\n-Products.PlonePAS =\n\\ No newline at end of file\n+Products.PlonePAS =\ndiff --git a/travis.cfg b/travis.cfg\ndeleted file mode 100644\nindex f8ce1e74..00000000\n--- a/travis.cfg\n+++ /dev/null\n@@ -1,18 +0,0 @@\n-[buildout]\n-develop = .\n-extends =\n-    https://raw.githubusercontent.com/collective/buildout.plonetest/master/qa.cfg\n-    https://raw.githubusercontent.com/collective/buildout.plonetest/master/travis-5.2.x.cfg\n-\n-package-name = Products.PlonePAS\n-package-extras = [test]\n-\n-[versions]\n-setuptools =\n-zc.buildout =\n-\n-[code-analysis]\n-flake8-ignore = C901\n-utf8-header = True\n-imports = True\n-debug-statements = True\n'

Repository: Products.PlonePAS


Branch: refs/heads/master
Date: 2019-11-11T23:12:33+01:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/Products.PlonePAS/commit/8875d21c79a0054dad918226d3eca9f877c261f1

Merge pull request #51 from plone/plone52

Fix deprecated imports

Files changed:
A news/51.bugfix
M .travis.yml
M buildout.cfg
M setup.py
M src/Products/PlonePAS/testing.py
M src/Products/PlonePAS/tests/cookie_auth.rst
D travis.cfg

b'diff --git a/.travis.yml b/.travis.yml\nindex c7b6f405..caac924c 100644\n--- a/.travis.yml\n+++ b/.travis.yml\n@@ -1,7 +1,25 @@\n+dist: bionic\n language: python\n python: 2.7\n+sudo: false\n+cache:\n+  pip: true\n+  directories:\n+    - eggs\n+matrix:\n+  include:\n+    - python: "2.7"\n+      env: PLONE_VERSION="5.2"\n+    - python: "3.7"\n+      env: PLONE_VERSION="5.2"\n+  sudo: true\n+  fast_finish: true\n+before_install:\n+  - virtualenv -p `which python` .\n+  - bin/pip install -r requirements.txt\n+  - sed -ie "s#test-5.2.x.cfg#test-$PLONE_VERSION.x.cfg#" buildout.cfg\n+  - bin/buildout -N -t 3 annotate\n install:\n-  - mkdir -p buildout-cache/downloads\n-  - pip install zc.buildout\n-  - buildout -c travis.cfg -N -q -t 3\n-script: bin/code-analysis && bin/test\n+  - bin/buildout -N -t 3\n+script:\n+  - bin/test\ndiff --git a/buildout.cfg b/buildout.cfg\nindex 93e9d85a..863b4d98 100644\n--- a/buildout.cfg\n+++ b/buildout.cfg\n@@ -5,9 +5,9 @@\n #     ./bin/buildout\n \n extends =\n-    https://raw.github.com/collective/buildout.plonetest/master/test-4.x.cfg\n+    https://raw.github.com/collective/buildout.plonetest/master/test-5.2.x.cfg\n parts +=\n-    coverage \n+    coverage\n package-name = Products.PlonePAS\n package-extras = [test]\n \n@@ -19,4 +19,4 @@ eggs = ${test:eggs}\n defaults = [\'--coverage\', \'../../coverage\', \'-v\', \'--auto-progress\']\n \n [versions]\n-Products.PlonePAS = \n+Products.PlonePAS =\ndiff --git a/news/51.bugfix b/news/51.bugfix\nnew file mode 100644\nindex 00000000..ff89e3bc\n--- /dev/null\n+++ b/news/51.bugfix\n@@ -0,0 +1,3 @@\n+Fix deprecated imports.\n+Fix buildout infrastructure for Plone 5.2.\n+[thet]\ndiff --git a/setup.py b/setup.py\nindex 81397d87..13c9ad16 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -58,6 +58,7 @@\n         test=[\n             \'plone.app.testing\',\n             \'plone.testing\',\n+            \'plone.app.robotframework\',\n         ],\n     ),\n )\ndiff --git a/src/Products/PlonePAS/testing.py b/src/Products/PlonePAS/testing.py\nindex 39bcf180..ffba794b 100644\n--- a/src/Products/PlonePAS/testing.py\n+++ b/src/Products/PlonePAS/testing.py\n@@ -1,12 +1,11 @@\n # -*- coding: utf-8 -*-\n from plone.app.contenttypes.testing import PLONE_APP_CONTENTTYPES_FIXTURE\n-from plone.app.testing import setRoles\n from plone.app.testing import TEST_USER_ID\n from plone.app.testing import applyProfile\n from plone.app.testing import FunctionalTesting\n from plone.app.testing import IntegrationTesting\n from plone.app.testing import PloneSandboxLayer\n-from plone.testing import z2\n+from plone.testing import zope as zope_testing\n \n import Products.PlonePAS\n \n@@ -20,7 +19,7 @@ def setUpZope(self, app, configurationContext):\n         # The z3c.autoinclude feature is disabled in the Plone fixture base\n         # layer.\n         self.loadZCML(package=Products.PlonePAS)\n-        z2.installProduct(app, \'Products.PlonePAS\')\n+        zope_testing.installProduct(app, \'Products.PlonePAS\')\n \n     def setUpPloneSite(self, portal):\n         applyProfile(portal, \'Products.PlonePAS:PlonePAS\')\ndiff --git a/src/Products/PlonePAS/tests/cookie_auth.rst b/src/Products/PlonePAS/tests/cookie_auth.rst\nindex 7405a560..fb92ceee 100644\n--- a/src/Products/PlonePAS/tests/cookie_auth.rst\n+++ b/src/Products/PlonePAS/tests/cookie_auth.rst\n@@ -28,7 +28,7 @@ User exists in the user folder inside the Plone Site.\n \n Login to Plone Site using Basic Auth works.\n \n-  >>> from plone.testing.z2 import Browser\n+  >>> from plone.testing.zope import Browser\n   >>> browser = Browser(layer[\'app\'])\n   >>> browser.addHeader(\'Authorization\', \'Basic %s:%s\' % (TEST_USER_NAME, TEST_USER_PASSWORD,))\n   >>> browser.open(\'%s/manage\' % portal.absolute_url())\ndiff --git a/travis.cfg b/travis.cfg\ndeleted file mode 100644\nindex c6b14710..00000000\n--- a/travis.cfg\n+++ /dev/null\n@@ -1,18 +0,0 @@\n-[buildout]\n-develop = .\n-extends =\n-    https://raw.githubusercontent.com/collective/buildout.plonetest/master/qa.cfg\n-    https://raw.githubusercontent.com/collective/buildout.plonetest/master/travis-5.x.cfg\n-\n-package-name = Products.PlonePAS\n-package-extras = [test]\n-\n-[versions]\n-setuptools =\n-zc.buildout =\n-\n-[code-analysis]\n-flake8-ignore = C901\n-utf8-header = True\n-imports = True\n-debug-statements = True\n'

