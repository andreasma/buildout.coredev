Repository: plone.app.portlets


Branch: refs/heads/master
Date: 2019-08-11T09:39:51+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.app.portlets/commit/00453974c1fc463dfce2041994e6c66866b5f3fe

fix review portlet when show on the portal-root

Files changed:
M plone/app/portlets/portlets/review.pt

b'diff --git a/plone/app/portlets/portlets/review.pt b/plone/app/portlets/portlets/review.pt\nindex e150d5f..89611b0 100644\n--- a/plone/app/portlets/portlets/review.pt\n+++ b/plone/app/portlets/portlets/review.pt\n@@ -15,10 +15,7 @@\n            tal:content="view/title" />\n   </header>\n   <div class="portletContent"\n-       tal:define="plone_layout context/@@plone_layout;\n-                   portal context/@@plone_portal_state/portal;\n-                   \n-                   supress_icon    view/data/no_icons;\n+       tal:define="supress_icon    view/data/no_icons;\n                    supress_thumb   view/data/no_thumbs;\n                    thumb_scale python:view.thumb_scale();\n                    ">\n@@ -26,7 +23,6 @@\n       <tal:items tal:repeat="obj view/review_items">\n           <li class="portletItem"\n               tal:define="oddrow repeat/obj/odd;\n-                          imagescale context/@@images;\n                           review_state_class obj/review_state_class;\n                           image obj/images;\n                           hasImage obj/hasImage;\n@@ -37,9 +33,9 @@\n                  tal:attributes="href string:${obj/path}/view;\n                                  title obj/description;\n                                  class string:$review_state_class tile $item_class">\n-                                 \n-            <img  tal:condition="python:hasImage and thumb_scale!=\'none\' and imagescale is not None"\n-                   tal:replace="structure python:image.scale(\'image\', scale=thumb_scale).tag(css_class=\'pull-right thumb-\'+thumb_scale)"/>\n+\n+            <img tal:condition="python:not supress_thumb and hasImage and thumb_scale"\n+                 tal:replace="structure python:image.scale(\'image\', scale=thumb_scale).tag(css_class=\'pull-right thumb-\'+thumb_scale)"/>\n \n                   <span tal:replace="obj/title">\n                       Title\n'

Repository: plone.app.portlets


Branch: refs/heads/master
Date: 2019-08-11T09:41:38+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.app.portlets/commit/571d7957810ccd778ee4e33438d220f4c1a3c28f

add changenote

Files changed:
A news/130.bugfix

b'diff --git a/news/130.bugfix b/news/130.bugfix\nnew file mode 100644\nindex 0000000..9bc5db7\n--- /dev/null\n+++ b/news/130.bugfix\n@@ -0,0 +1 @@\n+Fix review portlet when show on the portal-root\n\\ No newline at end of file\n'

Repository: plone.app.portlets


Branch: refs/heads/master
Date: 2019-11-28T10:44:47+01:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.app.portlets/commit/88387e252190d3cc93607977c3fc1f65cdc65a79

Merge pull request #130 from plone/fix_thumbs_in_review_portlet

fix review portlet when show on the portal-root

Files changed:
A news/130.bugfix
M plone/app/portlets/portlets/review.pt

b'diff --git a/news/130.bugfix b/news/130.bugfix\nnew file mode 100644\nindex 0000000..9bc5db7\n--- /dev/null\n+++ b/news/130.bugfix\n@@ -0,0 +1 @@\n+Fix review portlet when show on the portal-root\n\\ No newline at end of file\ndiff --git a/plone/app/portlets/portlets/review.pt b/plone/app/portlets/portlets/review.pt\nindex e150d5f..89611b0 100644\n--- a/plone/app/portlets/portlets/review.pt\n+++ b/plone/app/portlets/portlets/review.pt\n@@ -15,10 +15,7 @@\n            tal:content="view/title" />\n   </header>\n   <div class="portletContent"\n-       tal:define="plone_layout context/@@plone_layout;\n-                   portal context/@@plone_portal_state/portal;\n-                   \n-                   supress_icon    view/data/no_icons;\n+       tal:define="supress_icon    view/data/no_icons;\n                    supress_thumb   view/data/no_thumbs;\n                    thumb_scale python:view.thumb_scale();\n                    ">\n@@ -26,7 +23,6 @@\n       <tal:items tal:repeat="obj view/review_items">\n           <li class="portletItem"\n               tal:define="oddrow repeat/obj/odd;\n-                          imagescale context/@@images;\n                           review_state_class obj/review_state_class;\n                           image obj/images;\n                           hasImage obj/hasImage;\n@@ -37,9 +33,9 @@\n                  tal:attributes="href string:${obj/path}/view;\n                                  title obj/description;\n                                  class string:$review_state_class tile $item_class">\n-                                 \n-            <img  tal:condition="python:hasImage and thumb_scale!=\'none\' and imagescale is not None"\n-                   tal:replace="structure python:image.scale(\'image\', scale=thumb_scale).tag(css_class=\'pull-right thumb-\'+thumb_scale)"/>\n+\n+            <img tal:condition="python:not supress_thumb and hasImage and thumb_scale"\n+                 tal:replace="structure python:image.scale(\'image\', scale=thumb_scale).tag(css_class=\'pull-right thumb-\'+thumb_scale)"/>\n \n                   <span tal:replace="obj/title">\n                       Title\n'

