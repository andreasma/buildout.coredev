Repository: diazo


Branch: refs/heads/master
Date: 2019-04-19T15:54:27+02:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/diazo/commit/75a48d521880e882815183e82929e4bbb07347ae

Close file

Ensure that ``dummy.html`` is closed.

Fixes diazo#75

Files changed:
M lib/diazo/compiler.py

b"diff --git a/lib/diazo/compiler.py b/lib/diazo/compiler.py\nindex f496a53..14e692b 100644\n--- a/lib/diazo/compiler.py\n+++ b/lib/diazo/compiler.py\n@@ -29,12 +29,12 @@\n \n \n def set_parser(stylesheet, parser, compiler_parser=None):\n-    dummy_doc = etree.parse(\n-        open(\n-            pkg_resources.resource_filename('diazo', 'dummy.html'),\n-        ),\n-        parser=parser,\n-    )\n+    file_obj = pkg_resources.resource_filename('diazo', 'dummy.html')\n+    with open(file_obj) as file_handler:\n+        dummy_doc = etree.parse(\n+            file_handler,\n+            parser=parser,\n+        )\n     name = 'file:///__diazo__'\n     resolver = CustomResolver({name: stylesheet})\n     if compiler_parser is None:\n"

Repository: diazo


Branch: refs/heads/master
Date: 2019-04-19T15:55:29+02:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/diazo/commit/15f836b6dca75647e6c7599c481e32f42f04d1c9

Add new entry

Files changed:
A news/75.bugfix

b'diff --git a/news/75.bugfix b/news/75.bugfix\nnew file mode 100644\nindex 0000000..fe0d61e\n--- /dev/null\n+++ b/news/75.bugfix\n@@ -0,0 +1,2 @@\n+Avoid a ResourceWarning.\n+[gforcada]\n'

Repository: diazo


Branch: refs/heads/master
Date: 2019-04-22T23:29:43+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/diazo/commit/2651b863e749e0561a49e1bd56f92be41b8a4f5a

Merge pull request #76 from plone/gforcada-patch-1

Close file

Files changed:
A news/75.bugfix
M lib/diazo/compiler.py

b"diff --git a/lib/diazo/compiler.py b/lib/diazo/compiler.py\nindex f496a53..14e692b 100644\n--- a/lib/diazo/compiler.py\n+++ b/lib/diazo/compiler.py\n@@ -29,12 +29,12 @@\n \n \n def set_parser(stylesheet, parser, compiler_parser=None):\n-    dummy_doc = etree.parse(\n-        open(\n-            pkg_resources.resource_filename('diazo', 'dummy.html'),\n-        ),\n-        parser=parser,\n-    )\n+    file_obj = pkg_resources.resource_filename('diazo', 'dummy.html')\n+    with open(file_obj) as file_handler:\n+        dummy_doc = etree.parse(\n+            file_handler,\n+            parser=parser,\n+        )\n     name = 'file:///__diazo__'\n     resolver = CustomResolver({name: stylesheet})\n     if compiler_parser is None:\ndiff --git a/news/75.bugfix b/news/75.bugfix\nnew file mode 100644\nindex 0000000..fe0d61e\n--- /dev/null\n+++ b/news/75.bugfix\n@@ -0,0 +1,2 @@\n+Avoid a ResourceWarning.\n+[gforcada]\n"

