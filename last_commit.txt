Repository: plone.recipe.alltests


Branch: refs/heads/master
Date: 2018-06-26T18:39:31+02:00
Author: David Glick (davisagli) <david@glicksoftware.com>
Commit: https://github.com/plone/plone.recipe.alltests/commit/3abfed4e545bff958d2806e670210dbee452cad2

Fix for python 3

Files changed:
M CHANGES.rst
M src/plone/recipe/alltests/__init__.py
M src/plone/recipe/alltests/runner.py

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex 1c0a7cb..1ab1c89 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -10,7 +10,8 @@ New:\n \n Fixes:\n \n-- *add item here*\n+- Fix imports when buildout was installed using pip.\n+  [davisagli]\n \n \n 1.5 (2015-03-21)\ndiff --git a/src/plone/recipe/alltests/__init__.py b/src/plone/recipe/alltests/__init__.py\nindex e38669a..f19f8c0 100644\n--- a/src/plone/recipe/alltests/__init__.py\n+++ b/src/plone/recipe/alltests/__init__.py\n@@ -1,9 +1,6 @@\n import os\n import re\n \n-from zc.buildout import easy_install\n-from zc.recipe.egg import Egg\n-\n \n EXCLUDE_PACKAGES = set((\n     \'distribute\',\n@@ -17,6 +14,8 @@\n class Recipe(object):\n \n     def __init__(self, buildout, name, options):\n+        from zc.recipe.egg import Egg\n+\n         self.buildout, self.options, self.name = buildout, options, name\n         self.egg = Egg(buildout, options[\'recipe\'], options)\n \n@@ -41,6 +40,8 @@ def __init__(self, buildout, name, options):\n         )\n \n     def install(self):\n+        from zc.buildout import easy_install\n+\n         options = self.options\n         location = options[\'location\']\n \ndiff --git a/src/plone/recipe/alltests/runner.py b/src/plone/recipe/alltests/runner.py\nindex 180a5df..8bdda8d 100644\n--- a/src/plone/recipe/alltests/runner.py\n+++ b/src/plone/recipe/alltests/runner.py\n@@ -9,7 +9,7 @@\n \n def run_test(name, script, path, arg, package):\n     error = False\n-    print RUNNING_TESTS % name\n+    print(RUNNING_TESTS % name)\n     sys.stdout.flush()\n     value = os.system(TEST_COMMAND % dict(\n         script=script,\n@@ -19,7 +19,7 @@ def run_test(name, script, path, arg, package):\n     ))\n     if value > 0:\n         error = True\n-    print FINISHED_TESTS % name\n+    print(FINISHED_TESTS % name)\n     sys.stdout.flush()\n     return error\n \n@@ -73,13 +73,13 @@ def main(args):\n             errors.append(package)\n \n     if len(errors):\n-        print "Packages with test failures:\\n"\n+        print("Packages with test failures:\\n")\n         for e in errors:\n-            print \'Failing tests in %s\' % e\n-    print "\\nTotal time elapsed: %.3f seconds" % (time.time() - start)\n-    print "\\nGrand total: %d packages, %d failures\\n" % (\n+            print(\'Failing tests in %s\' % e)\n+    print("\\nTotal time elapsed: %.3f seconds" % (time.time() - start))\n+    print("\\nGrand total: %d packages, %d failures\\n" % (\n         total_packages, len(errors)\n-    )\n+    ))\n \n     if len(errors) > 0:\n         sys.exit(1)\n'

Repository: plone.recipe.alltests


Branch: refs/heads/master
Date: 2018-09-19T14:44:39+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.recipe.alltests/commit/655ccb650aae7a9ae41ec527ee1809e6d27194f2

Merge pull request #5 from plone/python3

Fix for python 3

Files changed:
M CHANGES.rst
M src/plone/recipe/alltests/__init__.py
M src/plone/recipe/alltests/runner.py

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex 1c0a7cb..1ab1c89 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -10,7 +10,8 @@ New:\n \n Fixes:\n \n-- *add item here*\n+- Fix imports when buildout was installed using pip.\n+  [davisagli]\n \n \n 1.5 (2015-03-21)\ndiff --git a/src/plone/recipe/alltests/__init__.py b/src/plone/recipe/alltests/__init__.py\nindex e38669a..f19f8c0 100644\n--- a/src/plone/recipe/alltests/__init__.py\n+++ b/src/plone/recipe/alltests/__init__.py\n@@ -1,9 +1,6 @@\n import os\n import re\n \n-from zc.buildout import easy_install\n-from zc.recipe.egg import Egg\n-\n \n EXCLUDE_PACKAGES = set((\n     \'distribute\',\n@@ -17,6 +14,8 @@\n class Recipe(object):\n \n     def __init__(self, buildout, name, options):\n+        from zc.recipe.egg import Egg\n+\n         self.buildout, self.options, self.name = buildout, options, name\n         self.egg = Egg(buildout, options[\'recipe\'], options)\n \n@@ -41,6 +40,8 @@ def __init__(self, buildout, name, options):\n         )\n \n     def install(self):\n+        from zc.buildout import easy_install\n+\n         options = self.options\n         location = options[\'location\']\n \ndiff --git a/src/plone/recipe/alltests/runner.py b/src/plone/recipe/alltests/runner.py\nindex 180a5df..8bdda8d 100644\n--- a/src/plone/recipe/alltests/runner.py\n+++ b/src/plone/recipe/alltests/runner.py\n@@ -9,7 +9,7 @@\n \n def run_test(name, script, path, arg, package):\n     error = False\n-    print RUNNING_TESTS % name\n+    print(RUNNING_TESTS % name)\n     sys.stdout.flush()\n     value = os.system(TEST_COMMAND % dict(\n         script=script,\n@@ -19,7 +19,7 @@ def run_test(name, script, path, arg, package):\n     ))\n     if value > 0:\n         error = True\n-    print FINISHED_TESTS % name\n+    print(FINISHED_TESTS % name)\n     sys.stdout.flush()\n     return error\n \n@@ -73,13 +73,13 @@ def main(args):\n             errors.append(package)\n \n     if len(errors):\n-        print "Packages with test failures:\\n"\n+        print("Packages with test failures:\\n")\n         for e in errors:\n-            print \'Failing tests in %s\' % e\n-    print "\\nTotal time elapsed: %.3f seconds" % (time.time() - start)\n-    print "\\nGrand total: %d packages, %d failures\\n" % (\n+            print(\'Failing tests in %s\' % e)\n+    print("\\nTotal time elapsed: %.3f seconds" % (time.time() - start))\n+    print("\\nGrand total: %d packages, %d failures\\n" % (\n         total_packages, len(errors)\n-    )\n+    ))\n \n     if len(errors) > 0:\n         sys.exit(1)\n'

