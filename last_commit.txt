Repository: plone.app.discussion


Branch: refs/heads/2.2.x
Date: 2019-02-08T15:20:53+01:00
Author: Godefroid Chapelle (gotcha) <gotcha@bubblenet.be>
Commit: https://github.com/plone/plone.app.discussion/commit/b12dcd708a72d3074f16e876a9bc92c53ca31680

Log catalog clear and rebuild

Files changed:
M CHANGES.rst
M plone/app/discussion/patches.py

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex 9ea72a0f..193807c4 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -10,7 +10,7 @@ Breaking changes:\n \n New features:\n \n-- *add item here*\n+- Log catalog clear and rebuild [gotcha]\n \n Bug fixes:\n \ndiff --git a/plone/app/discussion/patches.py b/plone/app/discussion/patches.py\nindex 47ec27b3..7569b3d2 100644\n--- a/plone/app/discussion/patches.py\n+++ b/plone/app/discussion/patches.py\n@@ -1,3 +1,4 @@\n+import logging\n from zope.component import queryUtility\n \n from Acquisition import aq_inner, aq_parent\n@@ -11,6 +12,9 @@\n from plone.app.discussion.interfaces import ICommentingTool\n \n \n+logger = logging.getLogger(\'catalog_clear_and_rebuild\')\n+\n+\n def patchedClearFindAndRebuild(self):\n     """Empties catalog, then finds all contentish objects (i.e. objects\n        with an indexObject method), and reindexes them.\n@@ -23,6 +27,7 @@ def indexObject(obj, path):\n                 safe_callable(obj.indexObject)):\n \n             try:\n+                logger.debug("Indexing %s", path)\n                 obj.indexObject()\n \n                 annotions = IAnnotations(obj)\n'

