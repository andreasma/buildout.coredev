Repository: plone.app.upgrade


Branch: refs/heads/master
Date: 2019-02-12T09:58:11+01:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.app.upgrade/commit/cc839edcf60f1205a32cfdb3ef877e6698e5fbd8

this test cannot run in Plone 5.2 at all since the zexp cannot be imported in 5.2

Files changed:
M plone/app/upgrade/v50/tests.py

b'diff --git a/plone/app/upgrade/v50/tests.py b/plone/app/upgrade/v50/tests.py\nindex 9166ad89..3558241a 100644\n--- a/plone/app/upgrade/v50/tests.py\n+++ b/plone/app/upgrade/v50/tests.py\n@@ -1,4 +1,6 @@\n # -*- coding: utf-8 -*-\n+from pkg_resources import get_distribution\n+from pkg_resources import parse_version\n from plone.app.upgrade.tests.base import MigrationTest\n from plone.app.upgrade.v50.testing import REAL_UPGRADE_FUNCTIONAL\n from plone.app.viewletmanager.interfaces import IViewletSettingsStorage\n@@ -24,6 +26,9 @@\n if PLONE_5:\n     from plone.app.upgrade.v50 import alphas\n \n+plone_version = get_distribution(\'Products.CMFPlone\').version\n+PLONE_52 = parse_version(plone_version) >= parse_version(\'5.2a1\')\n+\n \n class PASUpgradeTest(MigrationTest):\n \n@@ -92,8 +97,7 @@ def test_migrate_members_default_layout(self):\n \n \n @unittest.skipIf(\n-    not six.PY2 or not PLONE_5,\n-    "not Plone 5.0, 5.1 or 5.2 / Python 2")\n+    PLONE_5 and not PLONE_52, "Only test in Plone 5.0 and 5.1")\n class TestFunctionalMigrations(unittest.TestCase):\n     """Run an upgrade from a real Plone 4.0 ZEXP dump.\n \n'

