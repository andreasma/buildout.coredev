Repository: plone.app.contenttypes


Branch: refs/heads/1.4.x
Date: 2018-10-01T15:22:35+02:00
Author: ale-rt (ale-rt) <alessandro.pisa@gmail.com>
Commit: https://github.com/plone/plone.app.contenttypes/commit/c7ffede99a876bac24b9a18a01886aceb9852b59

Fix the Format accessor

Files changed:
M CHANGES.rst
M plone/app/contenttypes/content.py

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex 721ab8c8..806d55a6 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -14,7 +14,9 @@ New features:\n \n Bug fixes:\n \n-- *add item here*\n+- The ``Format`` accessor should actually return the ``format`` attribute\n+  (see plone/Products.CMFPlone#2540)\n+  [ale-rt]\n \n \n 1.4.13 (2018-09-30)\ndiff --git a/plone/app/contenttypes/content.py b/plone/app/contenttypes/content.py\nindex 766fa379..b9068c88 100644\n--- a/plone/app/contenttypes/content.py\n+++ b/plone/app/contenttypes/content.py\n@@ -76,6 +76,14 @@ def results(self, **kwargs):\n class Document(Item):\n     """Convenience subclass for ``Document`` portal type\n     """\n+    def Format(self):\n+        \'\'\' Provide a proper accessor for the format attribute\n+        See https://github.com/plone/Products.CMFPlone/issues/2540\n+        \'\'\'\n+        format = self.format\n+        if six.PY2 and isinstance(format, six.text_type):\n+            format = self.format.encode()\n+        return format\n \n \n @implementer(IFile)\n'

Repository: plone.app.contenttypes


Branch: refs/heads/1.4.x
Date: 2018-10-02T09:50:53+02:00
Author: Alessandro Pisa (ale-rt) <alessandro.pisa@gmail.com>
Commit: https://github.com/plone/plone.app.contenttypes/commit/1539f0afe18bc82c14776e11c94211817137b09b

Merge pull request #490 from plone/fix-format-1.4

Fix the Format accessor (1.4.x)

Files changed:
M CHANGES.rst
M plone/app/contenttypes/content.py

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex 721ab8c8..806d55a6 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -14,7 +14,9 @@ New features:\n \n Bug fixes:\n \n-- *add item here*\n+- The ``Format`` accessor should actually return the ``format`` attribute\n+  (see plone/Products.CMFPlone#2540)\n+  [ale-rt]\n \n \n 1.4.13 (2018-09-30)\ndiff --git a/plone/app/contenttypes/content.py b/plone/app/contenttypes/content.py\nindex 766fa379..b9068c88 100644\n--- a/plone/app/contenttypes/content.py\n+++ b/plone/app/contenttypes/content.py\n@@ -76,6 +76,14 @@ def results(self, **kwargs):\n class Document(Item):\n     """Convenience subclass for ``Document`` portal type\n     """\n+    def Format(self):\n+        \'\'\' Provide a proper accessor for the format attribute\n+        See https://github.com/plone/Products.CMFPlone/issues/2540\n+        \'\'\'\n+        format = self.format\n+        if six.PY2 and isinstance(format, six.text_type):\n+            format = self.format.encode()\n+        return format\n \n \n @implementer(IFile)\n'

