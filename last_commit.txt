Repository: plone.app.iterate


Branch: refs/heads/master
Date: 2018-06-23T09:44:02+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.app.iterate/commit/7fceeed43776c2ee1b4dad346f834a114b6f0d4d

fix imports and filter for python3

Files changed:
M plone/app/iterate/archiver.py
M plone/app/iterate/copier.py
M plone/app/iterate/dexterity/utils.py
M plone/app/iterate/event.py

b'diff --git a/plone/app/iterate/archiver.py b/plone/app/iterate/archiver.py\nindex b61cb68..f962003 100644\n--- a/plone/app/iterate/archiver.py\n+++ b/plone/app/iterate/archiver.py\n@@ -24,7 +24,7 @@\n from zope.component import adapter\n from zope.interface import implementer\n \n-import interfaces\n+from . import interfaces\n \n \n @implementer(interfaces.IObjectArchiver)\ndiff --git a/plone/app/iterate/copier.py b/plone/app/iterate/copier.py\nindex acd0134..32b77ed 100644\n--- a/plone/app/iterate/copier.py\n+++ b/plone/app/iterate/copier.py\n@@ -34,7 +34,7 @@\n from Products.Archetypes.Referenceable import Referenceable\n from Products.CMFCore.utils import getToolByName\n from Products.DCWorkflow.DCWorkflow import DCWorkflowDefinition\n-from relation import WorkingCopyRelation\n+from .relation import WorkingCopyRelation\n from ZODB.PersistentMapping import PersistentMapping\n from zope import component\n from zope import interface\ndiff --git a/plone/app/iterate/dexterity/utils.py b/plone/app/iterate/dexterity/utils.py\nindex dcb1947..e1dd41b 100644\n--- a/plone/app/iterate/dexterity/utils.py\n+++ b/plone/app/iterate/dexterity/utils.py\n@@ -24,7 +24,7 @@ def get_relations(context):\n         lambda r: r.from_attribute == ITERATE_RELATION_NAME,\n         relations\n     )\n-    return relations\n+    return list(relations)\n \n \n def get_checkout_relation(context):\ndiff --git a/plone/app/iterate/event.py b/plone/app/iterate/event.py\nindex 398ee47..4cd89ae 100644\n--- a/plone/app/iterate/event.py\n+++ b/plone/app/iterate/event.py\n@@ -26,7 +26,7 @@\n from zope.event import notify\n from zope.interface import implementer\n \n-import interfaces\n+from . import interfaces\n \n \n @implementer(interfaces.ICheckoutEvent)\n'

Repository: plone.app.iterate


Branch: refs/heads/master
Date: 2018-06-23T10:44:12+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.app.iterate/commit/e8f92a1c0c62838663b4bb84b22c73a8007ec19c

replace filter with list-comprehension

Files changed:
M plone/app/iterate/dexterity/copier.py

b"diff --git a/plone/app/iterate/dexterity/copier.py b/plone/app/iterate/dexterity/copier.py\nindex d8a474f..fdcb552 100644\n--- a/plone/app/iterate/dexterity/copier.py\n+++ b/plone/app/iterate/dexterity/copier.py\n@@ -123,9 +123,9 @@ def _get_relation_to_baseline(self):\n         id = intids.getId(context)\n         # ask catalog\n         catalog = component.getUtility(ICatalog)\n-        relations = list(catalog.findRelations({'to_id': id}))\n-        relations = filter(lambda r: r.from_attribute == ITERATE_RELATION_NAME,\n-                           relations)\n+        relations = catalog.findRelations({'to_id': id})\n+        relations = [i for i in relations\n+                     if i.from_attribute == ITERATE_RELATION_NAME]\n         # do we have a baseline in our relations?\n         if relations and not len(relations) == 1:\n             raise interfaces.CheckinException('Baseline count mismatch')\n"

Repository: plone.app.iterate


Branch: refs/heads/master
Date: 2018-06-27T00:31:01+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.iterate/commit/c4f951174f2e476abeea87f4d80566473b01b4ef

setDefaultRoles is deprecated. addPermission from AccessControl.Permission is used.

Files changed:
M plone/app/iterate/permissions.py

b"diff --git a/plone/app/iterate/permissions.py b/plone/app/iterate/permissions.py\nindex 39faf34..7978780 100644\n--- a/plone/app/iterate/permissions.py\n+++ b/plone/app/iterate/permissions.py\n@@ -21,12 +21,11 @@\n # Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n ##################################################################\n \n-from Products.CMFCore.permissions import setDefaultRoles\n-\n+from AccessControl.Permission import addPermission\n \n CheckinPermission = 'iterate : Check in content'\n CheckoutPermission = 'iterate : Check out content'\n \n DEFAULT_ROLES = ('Manager', 'Owner', 'Site Administrator', 'Editor')\n-setDefaultRoles(CheckinPermission, DEFAULT_ROLES)\n-setDefaultRoles(CheckoutPermission, DEFAULT_ROLES)\n+addPermission(CheckinPermission, default_roles=DEFAULT_ROLES)\n+addPermission(CheckoutPermission, default_roles=DEFAULT_ROLES)\n"

Repository: plone.app.iterate


Branch: refs/heads/master
Date: 2018-09-17T16:45:49+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.app.iterate/commit/05a7a621856b0602e71f57e4c5f4c768be5e07c2

add changenote and classifiers

Files changed:
M CHANGES.rst
M setup.py

b"diff --git a/CHANGES.rst b/CHANGES.rst\nindex c32edfc..d4f73c2 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -14,7 +14,8 @@ New features:\n \n Bug fixes:\n \n-- *add item here*\n+- Some Python 3 fixes.\n+  [pbauer]\n \n \n 3.3.8 (2018-06-18)\ndiff --git a/setup.py b/setup.py\nindex 96763bd..5e2dace 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -18,11 +18,14 @@\n         'Environment :: Web Environment',\n         'Framework :: Plone',\n         'Framework :: Plone :: 5.1',\n+        'Framework :: Plone :: 5.2',\n         'Framework :: Zope2',\n         'License :: OSI Approved :: GNU General Public License v2 (GPLv2)',\n         'Operating System :: OS Independent',\n         'Programming Language :: Python',\n         'Programming Language :: Python :: 2.7',\n+        'Programming Language :: Python :: 3.6',\n+        'Programming Language :: Python :: 3.7',\n     ],\n     keywords='check-out check-in staging',\n     author='Plone Foundation',\n"

Repository: plone.app.iterate


Branch: refs/heads/master
Date: 2018-09-17T19:50:52+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.app.iterate/commit/1eb48063e68cc5047ddd5f84956ddbed93c3670c

Merge pull request #64 from plone/python3

Python3

Files changed:
M CHANGES.rst
M plone/app/iterate/archiver.py
M plone/app/iterate/copier.py
M plone/app/iterate/dexterity/copier.py
M plone/app/iterate/dexterity/utils.py
M plone/app/iterate/event.py
M plone/app/iterate/permissions.py
M setup.py

b"diff --git a/CHANGES.rst b/CHANGES.rst\nindex c32edfc..d4f73c2 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -14,7 +14,8 @@ New features:\n \n Bug fixes:\n \n-- *add item here*\n+- Some Python 3 fixes.\n+  [pbauer]\n \n \n 3.3.8 (2018-06-18)\ndiff --git a/plone/app/iterate/archiver.py b/plone/app/iterate/archiver.py\nindex b61cb68..f962003 100644\n--- a/plone/app/iterate/archiver.py\n+++ b/plone/app/iterate/archiver.py\n@@ -24,7 +24,7 @@\n from zope.component import adapter\n from zope.interface import implementer\n \n-import interfaces\n+from . import interfaces\n \n \n @implementer(interfaces.IObjectArchiver)\ndiff --git a/plone/app/iterate/copier.py b/plone/app/iterate/copier.py\nindex acd0134..32b77ed 100644\n--- a/plone/app/iterate/copier.py\n+++ b/plone/app/iterate/copier.py\n@@ -34,7 +34,7 @@\n from Products.Archetypes.Referenceable import Referenceable\n from Products.CMFCore.utils import getToolByName\n from Products.DCWorkflow.DCWorkflow import DCWorkflowDefinition\n-from relation import WorkingCopyRelation\n+from .relation import WorkingCopyRelation\n from ZODB.PersistentMapping import PersistentMapping\n from zope import component\n from zope import interface\ndiff --git a/plone/app/iterate/dexterity/copier.py b/plone/app/iterate/dexterity/copier.py\nindex d8a474f..fdcb552 100644\n--- a/plone/app/iterate/dexterity/copier.py\n+++ b/plone/app/iterate/dexterity/copier.py\n@@ -123,9 +123,9 @@ def _get_relation_to_baseline(self):\n         id = intids.getId(context)\n         # ask catalog\n         catalog = component.getUtility(ICatalog)\n-        relations = list(catalog.findRelations({'to_id': id}))\n-        relations = filter(lambda r: r.from_attribute == ITERATE_RELATION_NAME,\n-                           relations)\n+        relations = catalog.findRelations({'to_id': id})\n+        relations = [i for i in relations\n+                     if i.from_attribute == ITERATE_RELATION_NAME]\n         # do we have a baseline in our relations?\n         if relations and not len(relations) == 1:\n             raise interfaces.CheckinException('Baseline count mismatch')\ndiff --git a/plone/app/iterate/dexterity/utils.py b/plone/app/iterate/dexterity/utils.py\nindex dcb1947..e1dd41b 100644\n--- a/plone/app/iterate/dexterity/utils.py\n+++ b/plone/app/iterate/dexterity/utils.py\n@@ -24,7 +24,7 @@ def get_relations(context):\n         lambda r: r.from_attribute == ITERATE_RELATION_NAME,\n         relations\n     )\n-    return relations\n+    return list(relations)\n \n \n def get_checkout_relation(context):\ndiff --git a/plone/app/iterate/event.py b/plone/app/iterate/event.py\nindex 398ee47..4cd89ae 100644\n--- a/plone/app/iterate/event.py\n+++ b/plone/app/iterate/event.py\n@@ -26,7 +26,7 @@\n from zope.event import notify\n from zope.interface import implementer\n \n-import interfaces\n+from . import interfaces\n \n \n @implementer(interfaces.ICheckoutEvent)\ndiff --git a/plone/app/iterate/permissions.py b/plone/app/iterate/permissions.py\nindex 39faf34..7978780 100644\n--- a/plone/app/iterate/permissions.py\n+++ b/plone/app/iterate/permissions.py\n@@ -21,12 +21,11 @@\n # Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n ##################################################################\n \n-from Products.CMFCore.permissions import setDefaultRoles\n-\n+from AccessControl.Permission import addPermission\n \n CheckinPermission = 'iterate : Check in content'\n CheckoutPermission = 'iterate : Check out content'\n \n DEFAULT_ROLES = ('Manager', 'Owner', 'Site Administrator', 'Editor')\n-setDefaultRoles(CheckinPermission, DEFAULT_ROLES)\n-setDefaultRoles(CheckoutPermission, DEFAULT_ROLES)\n+addPermission(CheckinPermission, default_roles=DEFAULT_ROLES)\n+addPermission(CheckoutPermission, default_roles=DEFAULT_ROLES)\ndiff --git a/setup.py b/setup.py\nindex 96763bd..5e2dace 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -18,11 +18,14 @@\n         'Environment :: Web Environment',\n         'Framework :: Plone',\n         'Framework :: Plone :: 5.1',\n+        'Framework :: Plone :: 5.2',\n         'Framework :: Zope2',\n         'License :: OSI Approved :: GNU General Public License v2 (GPLv2)',\n         'Operating System :: OS Independent',\n         'Programming Language :: Python',\n         'Programming Language :: Python :: 2.7',\n+        'Programming Language :: Python :: 3.6',\n+        'Programming Language :: Python :: 3.7',\n     ],\n     keywords='check-out check-in staging',\n     author='Plone Foundation',\n"

