Repository: plone.protect


Branch: refs/heads/master
Date: 2020-02-15T14:18:32+01:00
Author: ale-rt (ale-rt) <alessandro.pisa@gmail.com>
Commit: https://github.com/plone/plone.protect/commit/770e3453c2c0073ef175967ba4223569ed7c86f3

Remove deprecation warnings

Fixes #90

Files changed:
A news/90.bugfix
M plone/protect/utils.py

b'diff --git a/news/90.bugfix b/news/90.bugfix\nnew file mode 100644\nindex 0000000..e72715c\n--- /dev/null\n+++ b/news/90.bugfix\n@@ -0,0 +1 @@\n+Remove deprecation warnings\ndiff --git a/plone/protect/utils.py b/plone/protect/utils.py\nindex e749e76..5c72e2a 100644\n--- a/plone/protect/utils.py\n+++ b/plone/protect/utils.py\n@@ -45,8 +45,15 @@ def __init__(self, *checkers):\n         self.checkers = checkers\n \n     def __call__(self, callable):\n-        spec = inspect.getargspec(callable)\n-        args, defaults = spec[0], spec[3]\n+        try:\n+            spec = inspect.getfullargspec(callable)\n+        except AttributeError:\n+            # Python 2.7 compatibility\n+            spec = inspect.getargspec(callable)\n+\n+        args = spec.args\n+        defaults = spec.defaults\n+\n         try:\n             r_index = args.index("REQUEST")\n         except ValueError:\n'

Repository: plone.protect


Branch: refs/heads/master
Date: 2020-02-15T20:58:47+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.protect/commit/0810e4001c2ff7eda1af350192a96f8337214cdc

Merge pull request #91 from plone/90-modernize-inspect

Remove deprecation warnings

Files changed:
A news/90.bugfix
M plone/protect/utils.py

b'diff --git a/news/90.bugfix b/news/90.bugfix\nnew file mode 100644\nindex 0000000..e72715c\n--- /dev/null\n+++ b/news/90.bugfix\n@@ -0,0 +1 @@\n+Remove deprecation warnings\ndiff --git a/plone/protect/utils.py b/plone/protect/utils.py\nindex e749e76..5c72e2a 100644\n--- a/plone/protect/utils.py\n+++ b/plone/protect/utils.py\n@@ -45,8 +45,15 @@ def __init__(self, *checkers):\n         self.checkers = checkers\n \n     def __call__(self, callable):\n-        spec = inspect.getargspec(callable)\n-        args, defaults = spec[0], spec[3]\n+        try:\n+            spec = inspect.getfullargspec(callable)\n+        except AttributeError:\n+            # Python 2.7 compatibility\n+            spec = inspect.getargspec(callable)\n+\n+        args = spec.args\n+        defaults = spec.defaults\n+\n         try:\n             r_index = args.index("REQUEST")\n         except ValueError:\n'

