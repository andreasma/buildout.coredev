Repository: plone.app.z3cform


Branch: refs/heads/master
Date: 2018-05-18T13:53:55+02:00
Author: Steffen Allner (sallner) <sa@gocept.com>
Commit: https://github.com/plone/plone.app.z3cform/commit/e34c9402a3a19039990594c49400019a1fe47533

`lxml.etree.tostring()` needs this option to produce text.

Files changed:
M CHANGES.rst
M plone/app/z3cform/widget.py

diff --git a/CHANGES.rst b/CHANGES.rst
index ce9d6d8..c3c6db4 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -23,6 +23,10 @@ Bug fixes:
 - Prepare for Python 2 / 3 compatibility
   [pbauer, MatthewWilkes]
 
+- Render mimetype selection box correctly for a ``RichTextWidget`` which also
+  brings back the TinyMCE.
+  [sallner]
+
 
 3.0.4 (2018-02-04)
 ------------------
diff --git a/plone/app/z3cform/widget.py b/plone/app/z3cform/widget.py
index 4bd9b3f..269bf76 100644
--- a/plone/app/z3cform/widget.py
+++ b/plone/app/z3cform/widget.py
@@ -693,7 +693,7 @@ def render(self):
                 # Render the combined widget
                 rendered = '{0}\n{1}'.format(
                     textarea_widget.render(),
-                    etree.tostring(mt_select),
+                    etree.tostring(mt_select, encoding='unicode'),
                 )
             return rendered
 


Repository: plone.app.z3cform


Branch: refs/heads/master
Date: 2018-05-22T13:25:27+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.z3cform/commit/fbdf968671bc3c805d1d5d0212019481a828597a

Merge pull request #92 from plone/python3

Fix RichTextWidget with TinyMCE

Files changed:
M CHANGES.rst
M plone/app/z3cform/widget.py

diff --git a/CHANGES.rst b/CHANGES.rst
index ce9d6d8..c3c6db4 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -23,6 +23,10 @@ Bug fixes:
 - Prepare for Python 2 / 3 compatibility
   [pbauer, MatthewWilkes]
 
+- Render mimetype selection box correctly for a ``RichTextWidget`` which also
+  brings back the TinyMCE.
+  [sallner]
+
 
 3.0.4 (2018-02-04)
 ------------------
diff --git a/plone/app/z3cform/widget.py b/plone/app/z3cform/widget.py
index 4bd9b3f..269bf76 100644
--- a/plone/app/z3cform/widget.py
+++ b/plone/app/z3cform/widget.py
@@ -693,7 +693,7 @@ def render(self):
                 # Render the combined widget
                 rendered = '{0}\n{1}'.format(
                     textarea_widget.render(),
-                    etree.tostring(mt_select),
+                    etree.tostring(mt_select, encoding='unicode'),
                 )
             return rendered
 


