Repository: plone.app.upgrade


Branch: refs/heads/master
Date: 2018-10-01T16:11:01+02:00
Author: Peter Mathis (petschki) <peter.mathis@kombinat.at>
Commit: https://github.com/plone/plone.app.upgrade/commit/76a75564326f35e8ad216e4eee0d2bb2543850d1

make plone.app.folder a conditional dependency

Files changed:
M plone/app/upgrade/v40/alphas.py
M plone/app/upgrade/v40/tests.py
M setup.py

b"diff --git a/plone/app/upgrade/v40/alphas.py b/plone/app/upgrade/v40/alphas.py\nindex 91f1bf39..5503e3f9 100644\n--- a/plone/app/upgrade/v40/alphas.py\n+++ b/plone/app/upgrade/v40/alphas.py\n@@ -477,7 +477,10 @@ def migrateMailHost(context):\n \n \n def migrateFolders(context):\n-    from plone.app.folder.migration import BTreeMigrationView\n+    try:\n+        from plone.app.folder.migration import BTreeMigrationView\n+    except ImportError:\n+        return\n \n     class MigrationView(BTreeMigrationView):\n \ndiff --git a/plone/app/upgrade/v40/tests.py b/plone/app/upgrade/v40/tests.py\nindex be5524d0..66f3fdd0 100644\n--- a/plone/app/upgrade/v40/tests.py\n+++ b/plone/app/upgrade/v40/tests.py\n@@ -327,9 +327,13 @@ def testReplaceSecureMailHost(self):\n         self.assertEqual(new_mh.force_tls, False)\n \n     def testFolderMigration(self):\n-        from plone.app.folder.tests.content import create\n-        from plone.app.folder.tests.test_migration import reverseMigrate\n-        from plone.app.folder.tests.test_migration import isSaneBTreeFolder\n+        try:\n+            from plone.app.folder.tests.content import create\n+            from plone.app.folder.tests.test_migration import reverseMigrate\n+            from plone.app.folder.tests.test_migration import isSaneBTreeFolder\n+        except ImportError:\n+            return\n+\n         # create a folder in an unmigrated state & check it's broken...\n         folder = create('Folder', self.portal, 'foo', title='Foo')\n         reverseMigrate(self.portal)\n@@ -458,7 +462,10 @@ def testClassicThemeResourcesCleanUp(self):\n         self.assertEqual(classictheme.resources_css, [])\n \n     def testGetObjPositionInParentIndex(self):\n-        from plone.app.folder.nogopip import GopipIndex\n+        try:\n+            from plone.app.folder.nogopip import GopipIndex\n+        except ImportError:\n+            return\n         catalog = self.portal.portal_catalog\n         catalog.delIndex('getObjPositionInParent')\n         catalog.addIndex('getObjPositionInParent', 'FieldIndex')\ndiff --git a/setup.py b/setup.py\nindex 896f6c42..efe7b6d0 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -45,7 +45,6 @@\n     install_requires=[\n         'setuptools',\n         'plone.portlets',\n-        'plone.app.folder',\n         'transaction',\n         'zope.component',\n         'zope.interface',\n"

Repository: plone.app.upgrade


Branch: refs/heads/master
Date: 2018-10-01T16:14:04+02:00
Author: Peter Mathis (petschki) <peter.mathis@kombinat.at>
Commit: https://github.com/plone/plone.app.upgrade/commit/9029414ba23d10ecf1fca842e0ee7f0664634ded

add towncrier changelog

Files changed:
A news/175.bugfix

b'diff --git a/news/175.bugfix b/news/175.bugfix\nnew file mode 100644\nindex 00000000..d48895de\n--- /dev/null\n+++ b/news/175.bugfix\n@@ -0,0 +1,3 @@\n+make `plone.app.folder` import conditional, because the package is gone in Plone >= 5.2\n+\n+[petschki]\n\\ No newline at end of file\n'

Repository: plone.app.upgrade


Branch: refs/heads/master
Date: 2018-10-01T17:29:50+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.app.upgrade/commit/af41235d50f5df505b6e746665ef1c8d4d8de25a

Merge pull request #175 from plone/remove-ploneappfolder-dependency

make plone.app.folder a conditional dependency

Files changed:
A news/175.bugfix
M plone/app/upgrade/v40/alphas.py
M plone/app/upgrade/v40/tests.py
M setup.py

b"diff --git a/news/175.bugfix b/news/175.bugfix\nnew file mode 100644\nindex 00000000..d48895de\n--- /dev/null\n+++ b/news/175.bugfix\n@@ -0,0 +1,3 @@\n+make `plone.app.folder` import conditional, because the package is gone in Plone >= 5.2\n+\n+[petschki]\n\\ No newline at end of file\ndiff --git a/plone/app/upgrade/v40/alphas.py b/plone/app/upgrade/v40/alphas.py\nindex 91f1bf39..5503e3f9 100644\n--- a/plone/app/upgrade/v40/alphas.py\n+++ b/plone/app/upgrade/v40/alphas.py\n@@ -477,7 +477,10 @@ def migrateMailHost(context):\n \n \n def migrateFolders(context):\n-    from plone.app.folder.migration import BTreeMigrationView\n+    try:\n+        from plone.app.folder.migration import BTreeMigrationView\n+    except ImportError:\n+        return\n \n     class MigrationView(BTreeMigrationView):\n \ndiff --git a/plone/app/upgrade/v40/tests.py b/plone/app/upgrade/v40/tests.py\nindex be5524d0..66f3fdd0 100644\n--- a/plone/app/upgrade/v40/tests.py\n+++ b/plone/app/upgrade/v40/tests.py\n@@ -327,9 +327,13 @@ def testReplaceSecureMailHost(self):\n         self.assertEqual(new_mh.force_tls, False)\n \n     def testFolderMigration(self):\n-        from plone.app.folder.tests.content import create\n-        from plone.app.folder.tests.test_migration import reverseMigrate\n-        from plone.app.folder.tests.test_migration import isSaneBTreeFolder\n+        try:\n+            from plone.app.folder.tests.content import create\n+            from plone.app.folder.tests.test_migration import reverseMigrate\n+            from plone.app.folder.tests.test_migration import isSaneBTreeFolder\n+        except ImportError:\n+            return\n+\n         # create a folder in an unmigrated state & check it's broken...\n         folder = create('Folder', self.portal, 'foo', title='Foo')\n         reverseMigrate(self.portal)\n@@ -458,7 +462,10 @@ def testClassicThemeResourcesCleanUp(self):\n         self.assertEqual(classictheme.resources_css, [])\n \n     def testGetObjPositionInParentIndex(self):\n-        from plone.app.folder.nogopip import GopipIndex\n+        try:\n+            from plone.app.folder.nogopip import GopipIndex\n+        except ImportError:\n+            return\n         catalog = self.portal.portal_catalog\n         catalog.delIndex('getObjPositionInParent')\n         catalog.addIndex('getObjPositionInParent', 'FieldIndex')\ndiff --git a/setup.py b/setup.py\nindex e220c77f..967b6856 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -46,7 +46,6 @@\n     install_requires=[\n         'setuptools',\n         'plone.portlets',\n-        'plone.app.folder',\n         'transaction',\n         'zope.component',\n         'zope.interface',\n"

