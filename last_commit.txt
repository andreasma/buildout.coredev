Repository: plone.app.customerize


Branch: refs/heads/master
Date: 2018-11-11T21:08:59+01:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/plone.app.customerize/commit/5b5d19a59bc8910773e732f8f18d8488efd52a6e

Avoid leaving a file unclosed

On jenkins in python 3.7 this gives a ResourceWarning:

```
plone/app/customerize/registration.py:157: ResourceWarning: unclosed file &lt;_io.BufferedReader name='plone/app/customerize/tests/standard.pt'&gt;
```

Files changed:
M plone/app/customerize/registration.py

b"diff --git a/plone/app/customerize/registration.py b/plone/app/customerize/registration.py\nindex 3ad7990..838d9fc 100644\n--- a/plone/app/customerize/registration.py\n+++ b/plone/app/customerize/registration.py\n@@ -154,7 +154,9 @@ def getTemplateCodeFromRegistration(reg):\n     attr, template = findViewletTemplate(reg.factory)\n     # TODO: we can't do template.read() here because of a bug in\n     # Zope 3's ZPT implementation.\n-    return open(template.filename, 'rb').read()\n+    with open(template.filename, 'rb') as template_file:\n+        content = template_file.read()\n+    return content\n \n \n def getViewPermissionFromRegistration(reg):\n"

Repository: plone.app.customerize


Branch: refs/heads/master
Date: 2018-11-11T21:10:12+01:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/plone.app.customerize/commit/b0250a77f2d19e94dd6828785642e08870621f00

Update CHANGES.rst

Files changed:
M CHANGES.rst

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex cfca20a..88ce75a 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -15,8 +15,8 @@ New features:\n \n Bug fixes:\n \n-- *add item here*\n-\n+- Fix a ResourceWarning: do not leave a file unclosed.\n+  [gforcada]\n \n 1.3.8 (2018-10-30)\n ------------------\n'

Repository: plone.app.customerize


Branch: refs/heads/master
Date: 2018-11-14T11:26:27+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.customerize/commit/f83a04265245d65fea980ee5909804ae9ed18af6

Merge pull request #17 from plone/gforcada-patch-1

Avoid leaving a file unclosed

Files changed:
M CHANGES.rst
M plone/app/customerize/registration.py

b"diff --git a/CHANGES.rst b/CHANGES.rst\nindex cfca20a..88ce75a 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -15,8 +15,8 @@ New features:\n \n Bug fixes:\n \n-- *add item here*\n-\n+- Fix a ResourceWarning: do not leave a file unclosed.\n+  [gforcada]\n \n 1.3.8 (2018-10-30)\n ------------------\ndiff --git a/plone/app/customerize/registration.py b/plone/app/customerize/registration.py\nindex 3ad7990..838d9fc 100644\n--- a/plone/app/customerize/registration.py\n+++ b/plone/app/customerize/registration.py\n@@ -154,7 +154,9 @@ def getTemplateCodeFromRegistration(reg):\n     attr, template = findViewletTemplate(reg.factory)\n     # TODO: we can't do template.read() here because of a bug in\n     # Zope 3's ZPT implementation.\n-    return open(template.filename, 'rb').read()\n+    with open(template.filename, 'rb') as template_file:\n+        content = template_file.read()\n+    return content\n \n \n def getViewPermissionFromRegistration(reg):\n"

