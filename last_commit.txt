Repository: plone.app.versioningbehavior


Branch: refs/heads/master
Date: 2018-06-11T18:03:30+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.app.versioningbehavior/commit/57bbdc2ebf7bd020c47f7b7dc0e8d69fd786f87e

fix relative import

Files changed:
M plone/app/versioningbehavior/__init__.py

b'diff --git a/plone/app/versioningbehavior/__init__.py b/plone/app/versioningbehavior/__init__.py\nindex 008eedf..d99c1ef 100644\n--- a/plone/app/versioningbehavior/__init__.py\n+++ b/plone/app/versioningbehavior/__init__.py\n@@ -11,7 +11,7 @@ def initialize(context):\n     """Registers modifiers with zope (on zope startup).\n     """\n     if HAVE_BLOBS:\n-        from modifiers import modifiers\n+        from .modifiers import modifiers\n \n         for m in modifiers:\n             context.registerClass(\n'

Repository: plone.app.versioningbehavior


Branch: refs/heads/master
Date: 2018-06-11T18:04:00+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.app.versioningbehavior/commit/83308df958c11a17f0cb95082d6456cc18b54902

migrate all tests away from PloneTestCase

Files changed:
M plone/app/versioningbehavior/testing.py
M plone/app/versioningbehavior/tests/test_IntegrationTests.py
M plone/app/versioningbehavior/tests/test_browser.py
M plone/app/versioningbehavior/tests/test_functional.py
M plone/app/versioningbehavior/tests/test_modifiers.py
M plone/app/versioningbehavior/tests/tests.py

b'diff --git a/plone/app/versioningbehavior/testing.py b/plone/app/versioningbehavior/testing.py\nindex 3ebcfec..144e25d 100644\n--- a/plone/app/versioningbehavior/testing.py\n+++ b/plone/app/versioningbehavior/testing.py\n@@ -1,35 +1,32 @@\n # -*- coding: utf-8 -*-\n-from Products.CMFCore.utils import getToolByName\n-from Products.CMFDiffTool.TextDiff import TextDiff\n+from plone.app.contenttypes.testing import PLONE_APP_CONTENTTYPES_FIXTURE\n+from plone.app.robotframework.testing import REMOTE_LIBRARY_BUNDLE_FIXTURE\n+from plone.app.testing import applyProfile\n from plone.app.testing import FunctionalTesting\n from plone.app.testing import IntegrationTesting\n-from plone.app.testing import PLONE_FIXTURE\n from plone.app.testing import PloneSandboxLayer\n-from plone.app.testing import applyProfile\n from plone.dexterity.fti import DexterityFTI\n-from zope.configuration import xmlconfig\n+from plone.protect import auto as protect_auto\n+from plone.testing import z2\n+from Products.CMFCore.utils import getToolByName\n+from Products.CMFDiffTool.TextDiff import TextDiff\n \n-# Make it work with plone.protect < 3.0.0 where the `auto` module is not available.\n-# This is necessary for Plone 4.3.x compatibility.\n-try:\n-    from plone.protect import auto as protect_auto\n-except ImportError:\n-    class DummyAuto(object):\n-        CSRF_DISABLED = True\n-    protect_auto = DummyAuto()\n+import plone.app.versioningbehavior\n \n \n TEST_CONTENT_TYPE_ID = \'TestContentType\'\n DEFAULT_POLICIES = (\'at_edit_autoversion\', \'version_on_revert\',)\n \n \n-class VersioningLayer(PloneSandboxLayer):\n-    defaultBases = (PLONE_FIXTURE,)\n+class PloneAppVersioningbehaviorLayer(PloneSandboxLayer):\n+\n+    defaultBases = (PLONE_APP_CONTENTTYPES_FIXTURE,)\n \n     def setUpZope(self, app, configurationContext):\n-        import plone.app.versioningbehavior\n-        xmlconfig.file(\'configure.zcml\', plone.app.versioningbehavior,\n-                       context=configurationContext)\n+        # Load any other ZCML that is required for your tests.\n+        # The z3c.autoinclude feature is disabled in the Plone fixture base\n+        # layer.\n+        self.loadZCML(package=plone.app.versioningbehavior)\n \n     def setUpPloneSite(self, portal):\n         applyProfile(portal, \'plone.app.versioningbehavior:default\')\n@@ -81,11 +78,26 @@ def testSetUp(self):\n     def testTearDown(self):\n         protect_auto.CSRF_DISABLED = self.CSRF_DISABLED_ORIGINAL\n \n+PLONE_APP_VERSIONINGBEHAVIOR_FIXTURE = PloneAppVersioningbehaviorLayer()\n+\n+\n+PLONE_APP_VERSIONINGBEHAVIOR_INTEGRATION_TESTING = IntegrationTesting(\n+    bases=(PLONE_APP_VERSIONINGBEHAVIOR_FIXTURE,),\n+    name=\'PloneAppVersioningbehaviorLayer:IntegrationTesting\',\n+)\n+\n+\n+PLONE_APP_VERSIONINGBEHAVIOR_FUNCTIONAL_TESTING = FunctionalTesting(\n+    bases=(PLONE_APP_VERSIONINGBEHAVIOR_FIXTURE,),\n+    name=\'PloneAppVersioningbehaviorLayer:FunctionalTesting\',\n+)\n+\n \n-VERSIONING_FIXTURE = VersioningLayer()\n-VERSIONING_FUNCTIONAL_TESTING = FunctionalTesting(\n-    bases=(VERSIONING_FIXTURE,),\n-    name=\'plone.app.versioningbehavior:functional\')\n-VERSIONING_INTEGRATION_TESTING = IntegrationTesting(\n-    bases=(VERSIONING_FIXTURE,),\n-    name=\'plone.app.versioningbehavior:integration\')\n+PLONE_APP_VERSIONINGBEHAVIOR_ACCEPTANCE_TESTING = FunctionalTesting(\n+    bases=(\n+        PLONE_APP_VERSIONINGBEHAVIOR_FIXTURE,\n+        REMOTE_LIBRARY_BUNDLE_FIXTURE,\n+        z2.ZSERVER_FIXTURE,\n+    ),\n+    name=\'PloneAppVersioningbehaviorLayer:AcceptanceTesting\',\n+)\ndiff --git a/plone/app/versioningbehavior/tests/test_IntegrationTests.py b/plone/app/versioningbehavior/tests/test_IntegrationTests.py\nindex b9c39f1..3506ec9 100644\n--- a/plone/app/versioningbehavior/tests/test_IntegrationTests.py\n+++ b/plone/app/versioningbehavior/tests/test_IntegrationTests.py\n@@ -1,20 +1,23 @@\n # -*- coding: utf-8 -*-\n-from ..testing import VERSIONING_INTEGRATION_TESTING\n+from plone.app.testing import setRoles\n+from plone.app.testing import TEST_USER_ID\n+from plone.app.versioningbehavior.testing import PLONE_APP_VERSIONINGBEHAVIOR_FUNCTIONAL_TESTING\n from plone.dexterity.fti import DexterityFTI\n from Products.CMFCore.utils import getToolByName\n-from Products.CMFEditions.tests import test_IntegrationTests\n-from unittest import makeSuite\n-from unittest import TestSuite\n \n+import unittest\n \n-class TestDexterityIntegration(test_IntegrationTests.TestIntegration):\n+\n+class TestDexterityIntegration(unittest.TestCase):\n     """This tests is the same tests as in CMFEditions, but it\'s run for\n     dexterity Document and dexterity Folder.\n     """\n \n-    layer = VERSIONING_INTEGRATION_TESTING\n+    layer = PLONE_APP_VERSIONINGBEHAVIOR_FUNCTIONAL_TESTING\n+\n+    def setUp(self):\n+        self.portal = self.layer[\'portal\']\n \n-    def afterSetUp(self):\n         # get some tools\n         types_tool = getToolByName(self.portal, \'portal_types\')\n         repo_tool = getToolByName(self.portal, \'portal_repository\')\n@@ -22,7 +25,7 @@ def afterSetUp(self):\n \n         # we need to have the Manager role to be able to add things\n         # to the portal root\n-        self.setRoles([\'Manager\', ])\n+        setRoles(self.portal, TEST_USER_ID, [\'Manager\', ])\n \n         # add an additional user\n         acl_users.userFolderAddUser(\'reviewer\', \'reviewer\',\n@@ -99,9 +102,3 @@ def test13_revertUpdatesCatalog(self):\n         # This test in CMFEditions uses doc.edit, but we have no archetypes\n         # objects so doc.edit is portal.edit (acquisition), which is wrong...\n         pass\n-\n-\n-def test_suite():\n-    suite = TestSuite()\n-    suite.addTest(makeSuite(TestDexterityIntegration))\n-    return suite\ndiff --git a/plone/app/versioningbehavior/tests/test_browser.py b/plone/app/versioningbehavior/tests/test_browser.py\nindex 8ed5879..9b31896 100644\n--- a/plone/app/versioningbehavior/tests/test_browser.py\n+++ b/plone/app/versioningbehavior/tests/test_browser.py\n@@ -1,17 +1,21 @@\n # -*- coding: utf-8 -*-\n """Tests for the `browser` module."""\n-from .. import browser\n-from ..testing import VERSIONING_INTEGRATION_TESTING\n-from plone.app.testing import TEST_USER_ID, TEST_USER_ROLES, setRoles\n+from plone.app.testing import setRoles\n+from plone.app.testing import TEST_USER_ID\n+from plone.app.testing import TEST_USER_ROLES\n+from plone.app.versioningbehavior import browser\n+from plone.app.versioningbehavior.testing import PLONE_APP_VERSIONINGBEHAVIOR_INTEGRATION_TESTING\n from plone.app.versioningbehavior.testing import TEST_CONTENT_TYPE_ID\n from plone.namedfile import NamedBlobFile\n from zope.component import getMultiAdapter\n+\n import re\n import unittest\n \n+\n class BaseViewTestCase(unittest.TestCase):\n \n-    layer = VERSIONING_INTEGRATION_TESTING\n+    layer = PLONE_APP_VERSIONINGBEHAVIOR_INTEGRATION_TESTING\n \n     def setUp(self):\n         self.portal = self.layer[\'portal\']\ndiff --git a/plone/app/versioningbehavior/tests/test_functional.py b/plone/app/versioningbehavior/tests/test_functional.py\nindex 1d09fbf..3c525b4 100644\n--- a/plone/app/versioningbehavior/tests/test_functional.py\n+++ b/plone/app/versioningbehavior/tests/test_functional.py\n@@ -1,18 +1,19 @@\n # -*- coding: utf-8 -*-\n+from plone.app.testing import setRoles\n from plone.app.testing import TEST_USER_ID\n from plone.app.testing import TEST_USER_NAME\n from plone.app.testing import TEST_USER_PASSWORD\n-from plone.app.testing import setRoles\n+from plone.app.versioningbehavior.testing import PLONE_APP_VERSIONINGBEHAVIOR_FUNCTIONAL_TESTING\n from plone.app.versioningbehavior.testing import TEST_CONTENT_TYPE_ID\n-from plone.app.versioningbehavior.testing import VERSIONING_FUNCTIONAL_TESTING\n from plone.testing.z2 import Browser\n+\n import transaction\n import unittest\n \n \n class FunctionalTestCase(unittest.TestCase):\n \n-    layer = VERSIONING_FUNCTIONAL_TESTING\n+    layer = PLONE_APP_VERSIONINGBEHAVIOR_FUNCTIONAL_TESTING\n \n     def setUp(self):\n         self.portal = self.layer[\'portal\']\ndiff --git a/plone/app/versioningbehavior/tests/test_modifiers.py b/plone/app/versioningbehavior/tests/test_modifiers.py\nindex 34e3079..1a3c38e 100644\n--- a/plone/app/versioningbehavior/tests/test_modifiers.py\n+++ b/plone/app/versioningbehavior/tests/test_modifiers.py\n@@ -1,8 +1,11 @@\n # -*- coding: utf-8 -*-\n from five.intid import site\n+from plone.app.testing import setRoles\n+from plone.app.testing import TEST_USER_ID\n+from plone.app.testing import TEST_USER_ROLES\n from plone.app.versioningbehavior.modifiers import CloneNamedFileBlobs\n from plone.app.versioningbehavior.modifiers import SkipRelations\n-from plone.app.versioningbehavior.testing import VERSIONING_INTEGRATION_TESTING\n+from plone.app.versioningbehavior.testing import PLONE_APP_VERSIONINGBEHAVIOR_INTEGRATION_TESTING\n from plone.autoform.interfaces import IFormFieldProvider\n from plone.dexterity.fti import DexterityFTI\n from plone.dexterity.utils import createContent\n@@ -10,10 +13,7 @@\n from plone.namedfile import field\n from plone.namedfile.file import NamedBlobFile\n from plone.supermodel import model\n-from Products.CMFEditions.tests.base import CMFEditionsBaseTestCase\n from six import StringIO\n-from unittest import makeSuite\n-from unittest import TestSuite\n from z3c.relationfield.relation import RelationValue\n from z3c.relationfield.schema import RelationChoice\n from z3c.relationfield.schema import RelationList\n@@ -24,6 +24,8 @@\n from zope.interface import alsoProvides\n from zope.interface import Interface\n \n+import unittest\n+\n \n class IBlobFile(model.Schema):\n     file = field.NamedBlobFile(title=u\'File\')\n@@ -49,14 +51,16 @@ class IRelationsBehavior(model.Schema):\n alsoProvides(IRelationsBehavior, IFormFieldProvider)\n \n \n-class TestModifiers(CMFEditionsBaseTestCase):\n+class TestModifiers(unittest.TestCase):\n \n-    layer = VERSIONING_INTEGRATION_TESTING\n+    layer = PLONE_APP_VERSIONINGBEHAVIOR_INTEGRATION_TESTING\n \n-    def afterSetUp(self):\n+    def setUp(self):\n+        self.portal = self.layer[\'portal\']\n+        self.request = self.layer[\'request\']\n         # we need to have the Manager role to be able to add things\n         # to the portal root\n-        self.setRoles([\'Manager\', ])\n+        setRoles(self.portal, TEST_USER_ID, [\'Manager\'])\n \n     def testCloneNamedFileBlobsInSchema(self):\n         file_fti = DexterityFTI(\n@@ -355,9 +359,3 @@ class Dummy(object):\n \n         self.assertFalse(hasattr(repo_clone, \'single\'))\n         self.assertFalse(hasattr(repo_clone, \'multiple\'))\n-\n-\n-def test_suite():\n-    suite = TestSuite()\n-    suite.addTest(makeSuite(TestModifiers))\n-    return suite\ndiff --git a/plone/app/versioningbehavior/tests/tests.py b/plone/app/versioningbehavior/tests/tests.py\nindex 1c6700e..ca074f6 100644\n--- a/plone/app/versioningbehavior/tests/tests.py\n+++ b/plone/app/versioningbehavior/tests/tests.py\n@@ -1,5 +1,5 @@\n # -*- coding: utf-8 -*-\n-from plone.app.versioningbehavior.testing import VERSIONING_FUNCTIONAL_TESTING\n+from plone.app.versioningbehavior.testing import PLONE_APP_VERSIONINGBEHAVIOR_FUNCTIONAL_TESTING\n from plone.testing import layered\n \n import doctest\n@@ -11,7 +11,7 @@ def test_suite():\n     suite.addTests([\n         layered(\n             doctest.DocFileSuite(\'doctest_behavior.txt\'),\n-            layer=VERSIONING_FUNCTIONAL_TESTING,\n+            layer=PLONE_APP_VERSIONINGBEHAVIOR_FUNCTIONAL_TESTING,\n         ),\n     ])\n     return suite\n'

Repository: plone.app.versioningbehavior


Branch: refs/heads/master
Date: 2018-06-26T23:58:50+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.versioningbehavior/commit/3802f951b466d5af3e7606f757fb543cfc6e8c17

InitializeClass was moved to AccessControl.class_init

Files changed:
M plone/app/versioningbehavior/modifiers.py

b'diff --git a/plone/app/versioningbehavior/modifiers.py b/plone/app/versioningbehavior/modifiers.py\nindex ba1ae02..5e53e2f 100644\n--- a/plone/app/versioningbehavior/modifiers.py\n+++ b/plone/app/versioningbehavior/modifiers.py\n@@ -1,6 +1,6 @@\n # -*- coding: utf-8 -*-\n from Acquisition import aq_base\n-from App.class_init import InitializeClass\n+from AccessControl.class_init import InitializeClass\n from plone.dexterity.utils import iterSchemata, resolveDottedName\n from plone.dexterity.interfaces import IDexterityContent\n from plone.namedfile.interfaces import INamedBlobFileField\n'

Repository: plone.app.versioningbehavior


Branch: refs/heads/master
Date: 2018-09-15T20:34:27+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.app.versioningbehavior/commit/5cbfa866c367adca3f68d7e57dfb952923ddbb2d

add changelog and classifiers

Files changed:
M CHANGES.rst
M setup.py

b"diff --git a/CHANGES.rst b/CHANGES.rst\nindex 36929bd..4e690a6 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -14,7 +14,11 @@ New features:\n \n Bug fixes:\n \n-- *add item here*\n+- Migrate tests away from PloneTestCase\n+  [pbauer]\n+\n+- Fix imports for py3\n+  [pbauer]\n \n \n 1.3.3 (2018-04-03)\ndiff --git a/setup.py b/setup.py\nindex 79799b8..2b38637 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -38,6 +38,8 @@\n         'Operating System :: OS Independent',\n         'Programming Language :: Python',\n         'Programming Language :: Python :: 2.7',\n+        'Programming Language :: Python :: 3.6',\n+        'Programming Language :: Python :: 3.7',\n         'Topic :: Software Development :: Libraries :: Python Modules',\n     ],\n     keywords='plone dexterity behavior versioning CMFEditions',\n"

Repository: plone.app.versioningbehavior


Branch: refs/heads/master
Date: 2018-09-16T07:18:04+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.app.versioningbehavior/commit/9d442cafb94e7022d9e65d579ef0b1405b8b12a0

Merge pull request #39 from plone/python3

Python3

Files changed:
M CHANGES.rst
M plone/app/versioningbehavior/__init__.py
M plone/app/versioningbehavior/modifiers.py
M plone/app/versioningbehavior/testing.py
M plone/app/versioningbehavior/tests/test_IntegrationTests.py
M plone/app/versioningbehavior/tests/test_browser.py
M plone/app/versioningbehavior/tests/test_functional.py
M plone/app/versioningbehavior/tests/test_modifiers.py
M plone/app/versioningbehavior/tests/tests.py
M setup.py

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex 36929bd..4e690a6 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -14,7 +14,11 @@ New features:\n \n Bug fixes:\n \n-- *add item here*\n+- Migrate tests away from PloneTestCase\n+  [pbauer]\n+\n+- Fix imports for py3\n+  [pbauer]\n \n \n 1.3.3 (2018-04-03)\ndiff --git a/plone/app/versioningbehavior/__init__.py b/plone/app/versioningbehavior/__init__.py\nindex 008eedf..d99c1ef 100644\n--- a/plone/app/versioningbehavior/__init__.py\n+++ b/plone/app/versioningbehavior/__init__.py\n@@ -11,7 +11,7 @@ def initialize(context):\n     """Registers modifiers with zope (on zope startup).\n     """\n     if HAVE_BLOBS:\n-        from modifiers import modifiers\n+        from .modifiers import modifiers\n \n         for m in modifiers:\n             context.registerClass(\ndiff --git a/plone/app/versioningbehavior/modifiers.py b/plone/app/versioningbehavior/modifiers.py\nindex ba1ae02..5e53e2f 100644\n--- a/plone/app/versioningbehavior/modifiers.py\n+++ b/plone/app/versioningbehavior/modifiers.py\n@@ -1,6 +1,6 @@\n # -*- coding: utf-8 -*-\n from Acquisition import aq_base\n-from App.class_init import InitializeClass\n+from AccessControl.class_init import InitializeClass\n from plone.dexterity.utils import iterSchemata, resolveDottedName\n from plone.dexterity.interfaces import IDexterityContent\n from plone.namedfile.interfaces import INamedBlobFileField\ndiff --git a/plone/app/versioningbehavior/testing.py b/plone/app/versioningbehavior/testing.py\nindex 3ebcfec..144e25d 100644\n--- a/plone/app/versioningbehavior/testing.py\n+++ b/plone/app/versioningbehavior/testing.py\n@@ -1,35 +1,32 @@\n # -*- coding: utf-8 -*-\n-from Products.CMFCore.utils import getToolByName\n-from Products.CMFDiffTool.TextDiff import TextDiff\n+from plone.app.contenttypes.testing import PLONE_APP_CONTENTTYPES_FIXTURE\n+from plone.app.robotframework.testing import REMOTE_LIBRARY_BUNDLE_FIXTURE\n+from plone.app.testing import applyProfile\n from plone.app.testing import FunctionalTesting\n from plone.app.testing import IntegrationTesting\n-from plone.app.testing import PLONE_FIXTURE\n from plone.app.testing import PloneSandboxLayer\n-from plone.app.testing import applyProfile\n from plone.dexterity.fti import DexterityFTI\n-from zope.configuration import xmlconfig\n+from plone.protect import auto as protect_auto\n+from plone.testing import z2\n+from Products.CMFCore.utils import getToolByName\n+from Products.CMFDiffTool.TextDiff import TextDiff\n \n-# Make it work with plone.protect < 3.0.0 where the `auto` module is not available.\n-# This is necessary for Plone 4.3.x compatibility.\n-try:\n-    from plone.protect import auto as protect_auto\n-except ImportError:\n-    class DummyAuto(object):\n-        CSRF_DISABLED = True\n-    protect_auto = DummyAuto()\n+import plone.app.versioningbehavior\n \n \n TEST_CONTENT_TYPE_ID = \'TestContentType\'\n DEFAULT_POLICIES = (\'at_edit_autoversion\', \'version_on_revert\',)\n \n \n-class VersioningLayer(PloneSandboxLayer):\n-    defaultBases = (PLONE_FIXTURE,)\n+class PloneAppVersioningbehaviorLayer(PloneSandboxLayer):\n+\n+    defaultBases = (PLONE_APP_CONTENTTYPES_FIXTURE,)\n \n     def setUpZope(self, app, configurationContext):\n-        import plone.app.versioningbehavior\n-        xmlconfig.file(\'configure.zcml\', plone.app.versioningbehavior,\n-                       context=configurationContext)\n+        # Load any other ZCML that is required for your tests.\n+        # The z3c.autoinclude feature is disabled in the Plone fixture base\n+        # layer.\n+        self.loadZCML(package=plone.app.versioningbehavior)\n \n     def setUpPloneSite(self, portal):\n         applyProfile(portal, \'plone.app.versioningbehavior:default\')\n@@ -81,11 +78,26 @@ def testSetUp(self):\n     def testTearDown(self):\n         protect_auto.CSRF_DISABLED = self.CSRF_DISABLED_ORIGINAL\n \n+PLONE_APP_VERSIONINGBEHAVIOR_FIXTURE = PloneAppVersioningbehaviorLayer()\n+\n+\n+PLONE_APP_VERSIONINGBEHAVIOR_INTEGRATION_TESTING = IntegrationTesting(\n+    bases=(PLONE_APP_VERSIONINGBEHAVIOR_FIXTURE,),\n+    name=\'PloneAppVersioningbehaviorLayer:IntegrationTesting\',\n+)\n+\n+\n+PLONE_APP_VERSIONINGBEHAVIOR_FUNCTIONAL_TESTING = FunctionalTesting(\n+    bases=(PLONE_APP_VERSIONINGBEHAVIOR_FIXTURE,),\n+    name=\'PloneAppVersioningbehaviorLayer:FunctionalTesting\',\n+)\n+\n \n-VERSIONING_FIXTURE = VersioningLayer()\n-VERSIONING_FUNCTIONAL_TESTING = FunctionalTesting(\n-    bases=(VERSIONING_FIXTURE,),\n-    name=\'plone.app.versioningbehavior:functional\')\n-VERSIONING_INTEGRATION_TESTING = IntegrationTesting(\n-    bases=(VERSIONING_FIXTURE,),\n-    name=\'plone.app.versioningbehavior:integration\')\n+PLONE_APP_VERSIONINGBEHAVIOR_ACCEPTANCE_TESTING = FunctionalTesting(\n+    bases=(\n+        PLONE_APP_VERSIONINGBEHAVIOR_FIXTURE,\n+        REMOTE_LIBRARY_BUNDLE_FIXTURE,\n+        z2.ZSERVER_FIXTURE,\n+    ),\n+    name=\'PloneAppVersioningbehaviorLayer:AcceptanceTesting\',\n+)\ndiff --git a/plone/app/versioningbehavior/tests/test_IntegrationTests.py b/plone/app/versioningbehavior/tests/test_IntegrationTests.py\nindex b9c39f1..3506ec9 100644\n--- a/plone/app/versioningbehavior/tests/test_IntegrationTests.py\n+++ b/plone/app/versioningbehavior/tests/test_IntegrationTests.py\n@@ -1,20 +1,23 @@\n # -*- coding: utf-8 -*-\n-from ..testing import VERSIONING_INTEGRATION_TESTING\n+from plone.app.testing import setRoles\n+from plone.app.testing import TEST_USER_ID\n+from plone.app.versioningbehavior.testing import PLONE_APP_VERSIONINGBEHAVIOR_FUNCTIONAL_TESTING\n from plone.dexterity.fti import DexterityFTI\n from Products.CMFCore.utils import getToolByName\n-from Products.CMFEditions.tests import test_IntegrationTests\n-from unittest import makeSuite\n-from unittest import TestSuite\n \n+import unittest\n \n-class TestDexterityIntegration(test_IntegrationTests.TestIntegration):\n+\n+class TestDexterityIntegration(unittest.TestCase):\n     """This tests is the same tests as in CMFEditions, but it\'s run for\n     dexterity Document and dexterity Folder.\n     """\n \n-    layer = VERSIONING_INTEGRATION_TESTING\n+    layer = PLONE_APP_VERSIONINGBEHAVIOR_FUNCTIONAL_TESTING\n+\n+    def setUp(self):\n+        self.portal = self.layer[\'portal\']\n \n-    def afterSetUp(self):\n         # get some tools\n         types_tool = getToolByName(self.portal, \'portal_types\')\n         repo_tool = getToolByName(self.portal, \'portal_repository\')\n@@ -22,7 +25,7 @@ def afterSetUp(self):\n \n         # we need to have the Manager role to be able to add things\n         # to the portal root\n-        self.setRoles([\'Manager\', ])\n+        setRoles(self.portal, TEST_USER_ID, [\'Manager\', ])\n \n         # add an additional user\n         acl_users.userFolderAddUser(\'reviewer\', \'reviewer\',\n@@ -99,9 +102,3 @@ def test13_revertUpdatesCatalog(self):\n         # This test in CMFEditions uses doc.edit, but we have no archetypes\n         # objects so doc.edit is portal.edit (acquisition), which is wrong...\n         pass\n-\n-\n-def test_suite():\n-    suite = TestSuite()\n-    suite.addTest(makeSuite(TestDexterityIntegration))\n-    return suite\ndiff --git a/plone/app/versioningbehavior/tests/test_browser.py b/plone/app/versioningbehavior/tests/test_browser.py\nindex 8ed5879..9b31896 100644\n--- a/plone/app/versioningbehavior/tests/test_browser.py\n+++ b/plone/app/versioningbehavior/tests/test_browser.py\n@@ -1,17 +1,21 @@\n # -*- coding: utf-8 -*-\n """Tests for the `browser` module."""\n-from .. import browser\n-from ..testing import VERSIONING_INTEGRATION_TESTING\n-from plone.app.testing import TEST_USER_ID, TEST_USER_ROLES, setRoles\n+from plone.app.testing import setRoles\n+from plone.app.testing import TEST_USER_ID\n+from plone.app.testing import TEST_USER_ROLES\n+from plone.app.versioningbehavior import browser\n+from plone.app.versioningbehavior.testing import PLONE_APP_VERSIONINGBEHAVIOR_INTEGRATION_TESTING\n from plone.app.versioningbehavior.testing import TEST_CONTENT_TYPE_ID\n from plone.namedfile import NamedBlobFile\n from zope.component import getMultiAdapter\n+\n import re\n import unittest\n \n+\n class BaseViewTestCase(unittest.TestCase):\n \n-    layer = VERSIONING_INTEGRATION_TESTING\n+    layer = PLONE_APP_VERSIONINGBEHAVIOR_INTEGRATION_TESTING\n \n     def setUp(self):\n         self.portal = self.layer[\'portal\']\ndiff --git a/plone/app/versioningbehavior/tests/test_functional.py b/plone/app/versioningbehavior/tests/test_functional.py\nindex 1d09fbf..3c525b4 100644\n--- a/plone/app/versioningbehavior/tests/test_functional.py\n+++ b/plone/app/versioningbehavior/tests/test_functional.py\n@@ -1,18 +1,19 @@\n # -*- coding: utf-8 -*-\n+from plone.app.testing import setRoles\n from plone.app.testing import TEST_USER_ID\n from plone.app.testing import TEST_USER_NAME\n from plone.app.testing import TEST_USER_PASSWORD\n-from plone.app.testing import setRoles\n+from plone.app.versioningbehavior.testing import PLONE_APP_VERSIONINGBEHAVIOR_FUNCTIONAL_TESTING\n from plone.app.versioningbehavior.testing import TEST_CONTENT_TYPE_ID\n-from plone.app.versioningbehavior.testing import VERSIONING_FUNCTIONAL_TESTING\n from plone.testing.z2 import Browser\n+\n import transaction\n import unittest\n \n \n class FunctionalTestCase(unittest.TestCase):\n \n-    layer = VERSIONING_FUNCTIONAL_TESTING\n+    layer = PLONE_APP_VERSIONINGBEHAVIOR_FUNCTIONAL_TESTING\n \n     def setUp(self):\n         self.portal = self.layer[\'portal\']\ndiff --git a/plone/app/versioningbehavior/tests/test_modifiers.py b/plone/app/versioningbehavior/tests/test_modifiers.py\nindex 34e3079..1a3c38e 100644\n--- a/plone/app/versioningbehavior/tests/test_modifiers.py\n+++ b/plone/app/versioningbehavior/tests/test_modifiers.py\n@@ -1,8 +1,11 @@\n # -*- coding: utf-8 -*-\n from five.intid import site\n+from plone.app.testing import setRoles\n+from plone.app.testing import TEST_USER_ID\n+from plone.app.testing import TEST_USER_ROLES\n from plone.app.versioningbehavior.modifiers import CloneNamedFileBlobs\n from plone.app.versioningbehavior.modifiers import SkipRelations\n-from plone.app.versioningbehavior.testing import VERSIONING_INTEGRATION_TESTING\n+from plone.app.versioningbehavior.testing import PLONE_APP_VERSIONINGBEHAVIOR_INTEGRATION_TESTING\n from plone.autoform.interfaces import IFormFieldProvider\n from plone.dexterity.fti import DexterityFTI\n from plone.dexterity.utils import createContent\n@@ -10,10 +13,7 @@\n from plone.namedfile import field\n from plone.namedfile.file import NamedBlobFile\n from plone.supermodel import model\n-from Products.CMFEditions.tests.base import CMFEditionsBaseTestCase\n from six import StringIO\n-from unittest import makeSuite\n-from unittest import TestSuite\n from z3c.relationfield.relation import RelationValue\n from z3c.relationfield.schema import RelationChoice\n from z3c.relationfield.schema import RelationList\n@@ -24,6 +24,8 @@\n from zope.interface import alsoProvides\n from zope.interface import Interface\n \n+import unittest\n+\n \n class IBlobFile(model.Schema):\n     file = field.NamedBlobFile(title=u\'File\')\n@@ -49,14 +51,16 @@ class IRelationsBehavior(model.Schema):\n alsoProvides(IRelationsBehavior, IFormFieldProvider)\n \n \n-class TestModifiers(CMFEditionsBaseTestCase):\n+class TestModifiers(unittest.TestCase):\n \n-    layer = VERSIONING_INTEGRATION_TESTING\n+    layer = PLONE_APP_VERSIONINGBEHAVIOR_INTEGRATION_TESTING\n \n-    def afterSetUp(self):\n+    def setUp(self):\n+        self.portal = self.layer[\'portal\']\n+        self.request = self.layer[\'request\']\n         # we need to have the Manager role to be able to add things\n         # to the portal root\n-        self.setRoles([\'Manager\', ])\n+        setRoles(self.portal, TEST_USER_ID, [\'Manager\'])\n \n     def testCloneNamedFileBlobsInSchema(self):\n         file_fti = DexterityFTI(\n@@ -355,9 +359,3 @@ class Dummy(object):\n \n         self.assertFalse(hasattr(repo_clone, \'single\'))\n         self.assertFalse(hasattr(repo_clone, \'multiple\'))\n-\n-\n-def test_suite():\n-    suite = TestSuite()\n-    suite.addTest(makeSuite(TestModifiers))\n-    return suite\ndiff --git a/plone/app/versioningbehavior/tests/tests.py b/plone/app/versioningbehavior/tests/tests.py\nindex 1c6700e..ca074f6 100644\n--- a/plone/app/versioningbehavior/tests/tests.py\n+++ b/plone/app/versioningbehavior/tests/tests.py\n@@ -1,5 +1,5 @@\n # -*- coding: utf-8 -*-\n-from plone.app.versioningbehavior.testing import VERSIONING_FUNCTIONAL_TESTING\n+from plone.app.versioningbehavior.testing import PLONE_APP_VERSIONINGBEHAVIOR_FUNCTIONAL_TESTING\n from plone.testing import layered\n \n import doctest\n@@ -11,7 +11,7 @@ def test_suite():\n     suite.addTests([\n         layered(\n             doctest.DocFileSuite(\'doctest_behavior.txt\'),\n-            layer=VERSIONING_FUNCTIONAL_TESTING,\n+            layer=PLONE_APP_VERSIONINGBEHAVIOR_FUNCTIONAL_TESTING,\n         ),\n     ])\n     return suite\ndiff --git a/setup.py b/setup.py\nindex 79799b8..2b38637 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -38,6 +38,8 @@\n         \'Operating System :: OS Independent\',\n         \'Programming Language :: Python\',\n         \'Programming Language :: Python :: 2.7\',\n+        \'Programming Language :: Python :: 3.6\',\n+        \'Programming Language :: Python :: 3.7\',\n         \'Topic :: Software Development :: Libraries :: Python Modules\',\n     ],\n     keywords=\'plone dexterity behavior versioning CMFEditions\',\n'

