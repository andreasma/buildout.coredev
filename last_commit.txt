Repository: plone.portlet.collection


Branch: refs/heads/master
Date: 2019-07-12T12:41:04+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.portlet.collection/commit/0971c56b5f3fdbeedd8e00dfba387e5133534120

fix deprectaed import isDefaultPage

Files changed:
M CHANGES.rst
M plone/portlet/collection/collection.py

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex 1e16590..7bc2705 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -14,7 +14,8 @@ New features:\n \n Bug fixes:\n \n-- *add item here*\n+- Fix deprecated import ``isDefaultPage``.\n+  [jensens]\n \n \n 3.3.1 (2018-11-02)\ndiff --git a/plone/portlet/collection/collection.py b/plone/portlet/collection/collection.py\nindex 0fd379d..26cb346 100644\n--- a/plone/portlet/collection/collection.py\n+++ b/plone/portlet/collection/collection.py\n@@ -1,10 +1,9 @@\n+# -*- coding: utf-8 -*-\n from ComputedAttribute import ComputedAttribute\n-from plone.app.layout.navigation.defaultpage import isDefaultPage\n from plone.app.layout.navigation.root import getNavigationRoot\n from plone.app.portlets.browser import formhelper\n from plone.app.portlets.portlets import base\n from plone.app.uuid.utils import uuidToObject\n-from plone.app.vocabularies.catalog import CatalogSource\n from plone.app.z3cform.widget import RelatedItemsFieldWidget\n from plone.autoform.directives import widget\n from plone.i18n.normalizer.interfaces import IIDNormalizer\n@@ -24,6 +23,10 @@\n import os\n import random\n \n+try:\n+    from Products.CMFPlone.defaultpage import is_default_page\n+except ImportError:\n+    from plone.app.layout.navigation.defaultpage import isDefaultPage as is_default_page  # noqa\n \n COLLECTIONS = []\n \n@@ -125,6 +128,7 @@ class ICollectionPortlet(IPortletDataProvider):\n         required=True,\n         default=False)\n \n+\n @implementer(ICollectionPortlet)\n class Assignment(base.Assignment):\n     """\n@@ -196,7 +200,7 @@ def collection_url(self):\n         if collection is None:\n             return\n         parent = collection.aq_parent\n-        if isDefaultPage(parent, collection):\n+        if is_default_page(parent, collection):\n             collection = parent\n         return collection.absolute_url()\n \n'

Repository: plone.portlet.collection


Branch: refs/heads/master
Date: 2019-07-12T19:22:49+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.portlet.collection/commit/39bbac5291804e61429f241fd0b33fea4d75d534

Merge pull request #21 from plone/rm-deprecated-import

fix deprecated import isDefaultPage

Files changed:
M CHANGES.rst
M plone/portlet/collection/collection.py

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex 1e16590..7bc2705 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -14,7 +14,8 @@ New features:\n \n Bug fixes:\n \n-- *add item here*\n+- Fix deprecated import ``isDefaultPage``.\n+  [jensens]\n \n \n 3.3.1 (2018-11-02)\ndiff --git a/plone/portlet/collection/collection.py b/plone/portlet/collection/collection.py\nindex 0fd379d..26cb346 100644\n--- a/plone/portlet/collection/collection.py\n+++ b/plone/portlet/collection/collection.py\n@@ -1,10 +1,9 @@\n+# -*- coding: utf-8 -*-\n from ComputedAttribute import ComputedAttribute\n-from plone.app.layout.navigation.defaultpage import isDefaultPage\n from plone.app.layout.navigation.root import getNavigationRoot\n from plone.app.portlets.browser import formhelper\n from plone.app.portlets.portlets import base\n from plone.app.uuid.utils import uuidToObject\n-from plone.app.vocabularies.catalog import CatalogSource\n from plone.app.z3cform.widget import RelatedItemsFieldWidget\n from plone.autoform.directives import widget\n from plone.i18n.normalizer.interfaces import IIDNormalizer\n@@ -24,6 +23,10 @@\n import os\n import random\n \n+try:\n+    from Products.CMFPlone.defaultpage import is_default_page\n+except ImportError:\n+    from plone.app.layout.navigation.defaultpage import isDefaultPage as is_default_page  # noqa\n \n COLLECTIONS = []\n \n@@ -125,6 +128,7 @@ class ICollectionPortlet(IPortletDataProvider):\n         required=True,\n         default=False)\n \n+\n @implementer(ICollectionPortlet)\n class Assignment(base.Assignment):\n     """\n@@ -196,7 +200,7 @@ def collection_url(self):\n         if collection is None:\n             return\n         parent = collection.aq_parent\n-        if isDefaultPage(parent, collection):\n+        if is_default_page(parent, collection):\n             collection = parent\n         return collection.absolute_url()\n \n'

