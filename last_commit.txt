Repository: Products.MimetypesRegistry


Branch: refs/heads/master
Date: 2018-03-15T11:21:12+01:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/Products.MimetypesRegistry/commit/26fef72f52d517ee24ca8c0029fed3648027d1d6

more python3 fixes

Files changed:
M Products/MimetypesRegistry/mime_types/__init__.py
M Products/MimetypesRegistry/mime_types/mtr_mimetypes.py

diff --git a/Products/MimetypesRegistry/mime_types/__init__.py b/Products/MimetypesRegistry/mime_types/__init__.py
index 48b5751..eccf174 100644
--- a/Products/MimetypesRegistry/mime_types/__init__.py
+++ b/Products/MimetypesRegistry/mime_types/__init__.py
@@ -1,10 +1,10 @@
 # -*- coding: utf-8 -*-
-from mtr_mimetypes import *
+from .mtr_mimetypes import *
 
-import mtr_mimetypes
-import py_mimetypes
-import smi_mimetypes
-import suppl_mimetypes
+from . import mtr_mimetypes
+from . import py_mimetypes
+from . import smi_mimetypes
+from . import suppl_mimetypes
 
 
 def initialize(registry):
diff --git a/Products/MimetypesRegistry/mime_types/mtr_mimetypes.py b/Products/MimetypesRegistry/mime_types/mtr_mimetypes.py
index bc51f79..9c5fd22 100644
--- a/Products/MimetypesRegistry/mime_types/mtr_mimetypes.py
+++ b/Products/MimetypesRegistry/mime_types/mtr_mimetypes.py
@@ -1,7 +1,7 @@
 # -*- coding: utf-8 -*-
 from Products.MimetypesRegistry.interfaces import IClassifier
 from Products.MimetypesRegistry.MimeTypeItem import MimeTypeItem
-from types import InstanceType
+# from types import InstanceType
 from zope.interface import implementer
 
 import re
@@ -155,8 +155,8 @@ class text_web_textile(MimeTypeItem):
 
 def initialize(registry):
     for mt in reg_types:
-        if not isinstance(mt, InstanceType):
-            mt = mt()
+        # if not isinstance(mt, InstanceType):
+        #     mt = mt()
         registry.register(mt)
 
 


Repository: Products.MimetypesRegistry


Branch: refs/heads/master
Date: 2018-03-22T00:02:20+01:00
Author: ale-rt (ale-rt) <alessandro.pisa@gmail.com>
Commit: https://github.com/plone/Products.MimetypesRegistry/commit/13f7d5e073e9bf754aaeeec8c762d10c0def13d0

Added a changelog

Files changed:
M CHANGES.rst

diff --git a/CHANGES.rst b/CHANGES.rst
index 46dabd7..c4594a6 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,7 +14,7 @@ New features:
 
 Bug fixes:
 
-- *add item here*
+- Add Python 2 / 3 compatibility [pbauer]
 
 
 2.1.2 (2018-02-05)


Repository: Products.MimetypesRegistry


Branch: refs/heads/master
Date: 2018-03-22T07:45:13+01:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/Products.MimetypesRegistry/commit/5af7a1ff6c0b6240d328e8c74ee1394ed52a453e

check if mt is already instanciated or not

Files changed:
M Products/MimetypesRegistry/mime_types/mtr_mimetypes.py

diff --git a/Products/MimetypesRegistry/mime_types/mtr_mimetypes.py b/Products/MimetypesRegistry/mime_types/mtr_mimetypes.py
index 9c5fd22..f27d1fc 100644
--- a/Products/MimetypesRegistry/mime_types/mtr_mimetypes.py
+++ b/Products/MimetypesRegistry/mime_types/mtr_mimetypes.py
@@ -1,9 +1,9 @@
 # -*- coding: utf-8 -*-
 from Products.MimetypesRegistry.interfaces import IClassifier
 from Products.MimetypesRegistry.MimeTypeItem import MimeTypeItem
-# from types import InstanceType
 from zope.interface import implementer
 
+import inspect
 import re
 
 
@@ -155,8 +155,8 @@ class text_web_textile(MimeTypeItem):
 
 def initialize(registry):
     for mt in reg_types:
-        # if not isinstance(mt, InstanceType):
-        #     mt = mt()
+        if inspect.isclass(mt):
+            mt = mt()
         registry.register(mt)
 
 


Repository: Products.MimetypesRegistry


Branch: refs/heads/master
Date: 2018-03-22T08:59:14+01:00
Author: Alessandro Pisa (ale-rt) <alessandro.pisa@gmail.com>
Commit: https://github.com/plone/Products.MimetypesRegistry/commit/b8d04e859cd12fc568bd2d10d0d9ffa73fd749e8

Merge pull request #12 from plone/python3

more python3 fixes

Files changed:
M CHANGES.rst
M Products/MimetypesRegistry/mime_types/__init__.py
M Products/MimetypesRegistry/mime_types/mtr_mimetypes.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 46dabd7..c4594a6 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,7 +14,7 @@ New features:
 
 Bug fixes:
 
-- *add item here*
+- Add Python 2 / 3 compatibility [pbauer]
 
 
 2.1.2 (2018-02-05)
diff --git a/Products/MimetypesRegistry/mime_types/__init__.py b/Products/MimetypesRegistry/mime_types/__init__.py
index 48b5751..eccf174 100644
--- a/Products/MimetypesRegistry/mime_types/__init__.py
+++ b/Products/MimetypesRegistry/mime_types/__init__.py
@@ -1,10 +1,10 @@
 # -*- coding: utf-8 -*-
-from mtr_mimetypes import *
+from .mtr_mimetypes import *
 
-import mtr_mimetypes
-import py_mimetypes
-import smi_mimetypes
-import suppl_mimetypes
+from . import mtr_mimetypes
+from . import py_mimetypes
+from . import smi_mimetypes
+from . import suppl_mimetypes
 
 
 def initialize(registry):
diff --git a/Products/MimetypesRegistry/mime_types/mtr_mimetypes.py b/Products/MimetypesRegistry/mime_types/mtr_mimetypes.py
index bc51f79..f27d1fc 100644
--- a/Products/MimetypesRegistry/mime_types/mtr_mimetypes.py
+++ b/Products/MimetypesRegistry/mime_types/mtr_mimetypes.py
@@ -1,9 +1,9 @@
 # -*- coding: utf-8 -*-
 from Products.MimetypesRegistry.interfaces import IClassifier
 from Products.MimetypesRegistry.MimeTypeItem import MimeTypeItem
-from types import InstanceType
 from zope.interface import implementer
 
+import inspect
 import re
 
 
@@ -155,7 +155,7 @@ class text_web_textile(MimeTypeItem):
 
 def initialize(registry):
     for mt in reg_types:
-        if not isinstance(mt, InstanceType):
+        if inspect.isclass(mt):
             mt = mt()
         registry.register(mt)
 


