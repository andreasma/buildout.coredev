Repository: Products.CMFPlone


Branch: refs/heads/4.3.x
Date: 2018-04-12T00:59:14+02:00
Author: Joni Orponen (Rotonen) <joni.orponen@gmail.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/91dd1c395ab7f50ca6f6c0db678984278bcff9f0

Move the gtbn_funcglobals patch security test to functional tests.

Files changed:
M Products/CMFPlone/tests/testSecurity.py
M docs/CHANGES.rst

diff --git a/Products/CMFPlone/tests/testSecurity.py b/Products/CMFPlone/tests/testSecurity.py
index a411a18f1..44c57b2ad 100644
--- a/Products/CMFPlone/tests/testSecurity.py
+++ b/Products/CMFPlone/tests/testSecurity.py
@@ -12,15 +12,6 @@
 
 class TestAttackVectorsUnit(unittest.TestCase):
 
-    def test_gtbn_funcglobals(self):
-        from Products.CMFPlone.utils import getToolByName
-        try:
-            getToolByName(self.assertTrue,'func_globals')['__builtins__']
-        except TypeError:
-            pass
-        else:
-            self.fail('getToolByName should block access to non CMF tools')
-
     def test_setHeader_drops_LF(self):
         from ZPublisher.HTTPResponse import HTTPResponse
         response = HTTPResponse()
@@ -62,6 +53,15 @@ def test_get_request_var_or_attr_disallowed(self):
 
 class TestAttackVectorsFunctional(ptc.FunctionalTestCase):
 
+    def test_gtbn_funcglobals(self):
+        from Products.CMFPlone.utils import getToolByName
+        try:
+            getToolByName(self.assertTrue,'func_globals')['__builtins__']
+        except TypeError:
+            pass
+        else:
+            self.fail('getToolByName should block access to non CMF tools')
+
     def test_widget_traversal_1(self):
         res = self.publish('/plone/@@discussion-settings/++widget++moderator_email')
         self.assertEqual(302, res.status)
diff --git a/docs/CHANGES.rst b/docs/CHANGES.rst
index c38d14c5b..495b01e6a 100644
--- a/docs/CHANGES.rst
+++ b/docs/CHANGES.rst
@@ -19,7 +19,8 @@ New features:
 
 Bug fixes:
 
-- *add item here*
+- Unflakied a unit test.
+  [Rotonen]
 
 
 4.3.17 (2018-03-07)


Repository: Products.CMFPlone


Branch: refs/heads/4.3.x
Date: 2018-04-12T12:49:14+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/Products.CMFPlone/commit/a9caf4e3bc0a6ab176b8538bbfe318019eeb6bfb

Merge pull request #2382 from plone/roto-move-test-4.3.x

Move the gtbn_funcglobals patch security test to functional tests

Files changed:
M Products/CMFPlone/tests/testSecurity.py
M docs/CHANGES.rst

diff --git a/Products/CMFPlone/tests/testSecurity.py b/Products/CMFPlone/tests/testSecurity.py
index a411a18f1..44c57b2ad 100644
--- a/Products/CMFPlone/tests/testSecurity.py
+++ b/Products/CMFPlone/tests/testSecurity.py
@@ -12,15 +12,6 @@
 
 class TestAttackVectorsUnit(unittest.TestCase):
 
-    def test_gtbn_funcglobals(self):
-        from Products.CMFPlone.utils import getToolByName
-        try:
-            getToolByName(self.assertTrue,'func_globals')['__builtins__']
-        except TypeError:
-            pass
-        else:
-            self.fail('getToolByName should block access to non CMF tools')
-
     def test_setHeader_drops_LF(self):
         from ZPublisher.HTTPResponse import HTTPResponse
         response = HTTPResponse()
@@ -62,6 +53,15 @@ def test_get_request_var_or_attr_disallowed(self):
 
 class TestAttackVectorsFunctional(ptc.FunctionalTestCase):
 
+    def test_gtbn_funcglobals(self):
+        from Products.CMFPlone.utils import getToolByName
+        try:
+            getToolByName(self.assertTrue,'func_globals')['__builtins__']
+        except TypeError:
+            pass
+        else:
+            self.fail('getToolByName should block access to non CMF tools')
+
     def test_widget_traversal_1(self):
         res = self.publish('/plone/@@discussion-settings/++widget++moderator_email')
         self.assertEqual(302, res.status)
diff --git a/docs/CHANGES.rst b/docs/CHANGES.rst
index c38d14c5b..495b01e6a 100644
--- a/docs/CHANGES.rst
+++ b/docs/CHANGES.rst
@@ -19,7 +19,8 @@ New features:
 
 Bug fixes:
 
-- *add item here*
+- Unflakied a unit test.
+  [Rotonen]
 
 
 4.3.17 (2018-03-07)


