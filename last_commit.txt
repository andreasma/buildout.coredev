Repository: plone.app.customerize


Branch: refs/heads/master
Date: 2018-10-02T15:50:06+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.customerize/commit/e9155f3cbc5ef8199d91d784fde3f78f85bc768f

optimize for new bootstrap based ZMI

Files changed:
M CHANGES.rst
M plone/app/customerize/registrations.pt

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex 3c6692d..c613369 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -15,6 +15,10 @@ New features:\n \n Bug fixes:\n \n+- make registrations.html look good in Bootstrap-ZMI,\n+  still working fine in old ZMI.\n+  [jensens]\n+\n - Fix templateViewRegistrationGroups and tests in py3.\n   [pbauer]\n \ndiff --git a/plone/app/customerize/registrations.pt b/plone/app/customerize/registrations.pt\nindex e8fbce6..5ffdf77 100644\n--- a/plone/app/customerize/registrations.pt\n+++ b/plone/app/customerize/registrations.pt\n@@ -1,44 +1,35 @@\n <h1 tal:replace="structure context/manage_page_header" />\n <h1 tal:replace="structure context/manage_tabs" />\n \n-<style type="text/css">\n-  dl {\n-    font-family: Verdana, Helvetica, sans-serif;\n-    font-size: 10pt;\n-    margin-left: 1em;\n-  }\n-  dd {\n-    margin-bottom: 1em;\n-  }\n-  dd span.type {\n-    color: #999;\n-  }\n-  .customized {\n-    background-color: yellow;\n-  }\n-</style>\n+<main class="container-fluid">\n \n-<div>\n-  <p>The following list shows all registered (template-based) views\n-  sorted by interface. Click one of the links to see the contents\n-  of the view template and possibly customize it. Views that already\n-  have been customized are <span class="customized">highlighted like\n-  this</span>.</p>\n-</div>\n+  <style type="text/css">\n+    dd span.type {\n+      color: #999;\n+    }\n+    .customized {\n+      background-color: yellow;\n+    }\n+  </style>\n \n-<div>\n-  <p>ATTENTION: beware using this tool. Errors (e.g. <code>TypeError</code>,\n-  <code>Unauthorized</code> etc) may popup if some kinds of\n-  <code>python:</code> expressions are used in the template, making it\n-  impossible to customize here (try z3c.jbot or regular zcml overrides\n-  instead). The reason is that browser view templates are Zope 3 templates\n-  while items in portal_view_customization are Zope 2 templates. The different\n-  security models underlying the two implementations may break rendering of the\n-  site. If that happens just delete the custom copy using the Contents tab\n-  above.</p>\n+<div class="alert alert-danger" role="alert">\n+  ATTENTION: beware using this tool.\n+  Errors (e.g. <code>TypeError</code>, <code>Unauthorized</code> etc) may popup if some kinds of\n+  <code>python:</code> expressions are used in the template.\n+  This makes it impossible to customize those here (try z3c.jbot or regular zcml overrides instead).\n+  The reason is that browser view templates are Chameleon Pagetemplates while items in portal_view_customization are Zope 2 templates.\n+  The different security models underlying the two implementations may break rendering of thesite.\n+  If that happens just delete the custom copy using the Contents tab above.\n </div>\n \n-<div>\n+  <p class="form-help">\n+    The following list shows all registered (template-based) views\n+    sorted by interface. Click one of the links to see the contents\n+    of the view template and possibly customize it. Views that already\n+    have been customized are <span class="customized">highlighted like\n+    this</span>.\n+  </p>\n+\n   <article tal:repeat="iface python:view.getTemplateViewRegistrations(mangle=False)">\n     <header tal:content="iface/name" />\n     <ul>\n@@ -54,10 +45,11 @@\n                            title info/zptfile;"\n            tal:content="info/viewname">\n         </a>\n-        <span tal:content="string:(${info/type})" class="type" /> <br />\n+        <code tal:content="string:(${info/type})" class="type" /> <br />\n       </li>\n     </ul>\n   </article>\n-</div>\n \n-<h1 tal:replace="structure context/manage_page_footer" />\n+</main>\n+\n+<h1 tal:replace="structure context/manage_page_footer" />\n\\ No newline at end of file\n'

Repository: plone.app.customerize


Branch: refs/heads/master
Date: 2018-10-02T15:51:18+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.customerize/commit/4f8cd4f3ad820af354cb9b012b5c8a4e3e2918b4

isort

Files changed:
M plone/app/customerize/registration.py
M plone/app/customerize/tests/testDocTests.py

b'diff --git a/plone/app/customerize/registration.py b/plone/app/customerize/registration.py\nindex 02e00bb..3ad7990 100644\n--- a/plone/app/customerize/registration.py\n+++ b/plone/app/customerize/registration.py\n@@ -4,6 +4,7 @@\n from five.customerize.interfaces import IViewTemplateContainer\n from five.customerize.utils import findViewletTemplate\n from five.customerize.zpt import TTWViewTemplate\n+from operator import itemgetter\n from os.path import basename\n from plone.browserlayer.interfaces import ILocalBrowserLayerType\n from plone.portlets.interfaces import IPortletRenderer\n@@ -13,7 +14,6 @@\n from zope.component import getUtility\n from zope.publisher.interfaces.browser import IBrowserRequest\n from zope.viewlet.interfaces import IViewlet\n-from operator import itemgetter\n \n \n def getViews(type):\ndiff --git a/plone/app/customerize/tests/testDocTests.py b/plone/app/customerize/tests/testDocTests.py\nindex cd51685..98563ae 100644\n--- a/plone/app/customerize/tests/testDocTests.py\n+++ b/plone/app/customerize/tests/testDocTests.py\n@@ -1,5 +1,7 @@\n # -*- coding: utf-8 -*-\n-from plone.app.customerize.testing import PLONE_APP_CUSTOMERIZE_FUNCTIONAL_TESTING  # noqa\n+from plone.app.customerize.testing import (\n+    PLONE_APP_CUSTOMERIZE_FUNCTIONAL_TESTING  # noqa\n+)\n from plone.testing import layered\n from unittest import TestSuite\n \n'

Repository: plone.app.customerize


Branch: refs/heads/master
Date: 2018-10-02T15:53:33+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.customerize/commit/157a066561edae8f46c36679f07fd0deb91f0fa6

pep8

Files changed:
M plone/app/customerize/tests/testDocTests.py
M plone/app/customerize/tool.py

b"diff --git a/plone/app/customerize/tests/testDocTests.py b/plone/app/customerize/tests/testDocTests.py\nindex 98563ae..3e18c65 100644\n--- a/plone/app/customerize/tests/testDocTests.py\n+++ b/plone/app/customerize/tests/testDocTests.py\n@@ -20,7 +20,7 @@ def check_output(self, want, got, optionflags):\n \n def test_suite():\n     suite = TestSuite()\n-    OPTIONFLAGS = (doctest.ELLIPSIS | doctest.NORMALIZE_WHITESPACE)\n+    OPTIONFLAGS = doctest.ELLIPSIS | doctest.NORMALIZE_WHITESPACE\n     for testfile in ('testBrowserLayers.txt', 'testCustomizeView.txt'):\n         suite.addTest(\n             layered(\n@@ -30,7 +30,7 @@ def test_suite():\n                     package='plone.app.customerize.tests',\n                     checker=Py23DocChecker(),\n                 ),\n-                layer=PLONE_APP_CUSTOMERIZE_FUNCTIONAL_TESTING\n+                layer=PLONE_APP_CUSTOMERIZE_FUNCTIONAL_TESTING,\n             )\n         )\n     return suite\ndiff --git a/plone/app/customerize/tool.py b/plone/app/customerize/tool.py\nindex 3c8a7ba..dbeb642 100644\n--- a/plone/app/customerize/tool.py\n+++ b/plone/app/customerize/tool.py\n@@ -19,8 +19,10 @@ class ViewTemplateContainer(Folder):\n     security = ClassSecurityInfo()\n \n     manage_options = (\n-        dict(label='Registrations', action='registrations.html'),\n-    ) + Folder.manage_options[0:1] + Folder.manage_options[2:]\n+        (dict(label='Registrations', action='registrations.html'),) +\n+        Folder.manage_options[0:1] +\n+        Folder.manage_options[2:]\n+    )\n \n     @security.protected(ManagePortal)\n     def addTemplate(self, id, template):\n@@ -28,4 +30,5 @@ def addTemplate(self, id, template):\n         self._setObject(id, template)\n         return getattr(self, id)\n \n+\n InitializeClass(ViewTemplateContainer)\n"

Repository: plone.app.customerize


Branch: refs/heads/master
Date: 2018-10-02T15:59:35+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.customerize/commit/7b57cc3644ef9f730481d3ff2f5e5db2113907b8

cleanup namespace imports

Files changed:
M plone/__init__.py
M plone/app/__init__.py

b"diff --git a/plone/__init__.py b/plone/__init__.py\nindex 85880ef..68c04af 100644\n--- a/plone/__init__.py\n+++ b/plone/__init__.py\n@@ -1,7 +1,2 @@\n # -*- coding: utf-8 -*-\n-# See http://peak.telecommunity.com/DevCenter/setuptools#namespace-packages\n-try:\n-    __import__('pkg_resources').declare_namespace(__name__)\n-except ImportError:\n-    from pkgutil import extend_path\n-    __path__ = extend_path(__path__, __name__)\n+__import__('pkg_resources').declare_namespace(__name__)\ndiff --git a/plone/app/__init__.py b/plone/app/__init__.py\nindex 85880ef..68c04af 100644\n--- a/plone/app/__init__.py\n+++ b/plone/app/__init__.py\n@@ -1,7 +1,2 @@\n # -*- coding: utf-8 -*-\n-# See http://peak.telecommunity.com/DevCenter/setuptools#namespace-packages\n-try:\n-    __import__('pkg_resources').declare_namespace(__name__)\n-except ImportError:\n-    from pkgutil import extend_path\n-    __path__ = extend_path(__path__, __name__)\n+__import__('pkg_resources').declare_namespace(__name__)\n"

Repository: plone.app.customerize


Branch: refs/heads/master
Date: 2018-10-03T02:11:17+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.customerize/commit/cda0dbec35dd4f8419fe5f449ab5a5ba5faea582

Merge pull request #16 from plone/bootstrap-zmi

optimize for new bootstrap based ZMI

Files changed:
M CHANGES.rst
M plone/__init__.py
M plone/app/__init__.py
M plone/app/customerize/registration.py
M plone/app/customerize/registrations.pt
M plone/app/customerize/tests/testDocTests.py
M plone/app/customerize/tool.py

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex 3c6692d..c613369 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -15,6 +15,10 @@ New features:\n \n Bug fixes:\n \n+- make registrations.html look good in Bootstrap-ZMI,\n+  still working fine in old ZMI.\n+  [jensens]\n+\n - Fix templateViewRegistrationGroups and tests in py3.\n   [pbauer]\n \ndiff --git a/plone/__init__.py b/plone/__init__.py\nindex 85880ef..68c04af 100644\n--- a/plone/__init__.py\n+++ b/plone/__init__.py\n@@ -1,7 +1,2 @@\n # -*- coding: utf-8 -*-\n-# See http://peak.telecommunity.com/DevCenter/setuptools#namespace-packages\n-try:\n-    __import__(\'pkg_resources\').declare_namespace(__name__)\n-except ImportError:\n-    from pkgutil import extend_path\n-    __path__ = extend_path(__path__, __name__)\n+__import__(\'pkg_resources\').declare_namespace(__name__)\ndiff --git a/plone/app/__init__.py b/plone/app/__init__.py\nindex 85880ef..68c04af 100644\n--- a/plone/app/__init__.py\n+++ b/plone/app/__init__.py\n@@ -1,7 +1,2 @@\n # -*- coding: utf-8 -*-\n-# See http://peak.telecommunity.com/DevCenter/setuptools#namespace-packages\n-try:\n-    __import__(\'pkg_resources\').declare_namespace(__name__)\n-except ImportError:\n-    from pkgutil import extend_path\n-    __path__ = extend_path(__path__, __name__)\n+__import__(\'pkg_resources\').declare_namespace(__name__)\ndiff --git a/plone/app/customerize/registration.py b/plone/app/customerize/registration.py\nindex 02e00bb..3ad7990 100644\n--- a/plone/app/customerize/registration.py\n+++ b/plone/app/customerize/registration.py\n@@ -4,6 +4,7 @@\n from five.customerize.interfaces import IViewTemplateContainer\n from five.customerize.utils import findViewletTemplate\n from five.customerize.zpt import TTWViewTemplate\n+from operator import itemgetter\n from os.path import basename\n from plone.browserlayer.interfaces import ILocalBrowserLayerType\n from plone.portlets.interfaces import IPortletRenderer\n@@ -13,7 +14,6 @@\n from zope.component import getUtility\n from zope.publisher.interfaces.browser import IBrowserRequest\n from zope.viewlet.interfaces import IViewlet\n-from operator import itemgetter\n \n \n def getViews(type):\ndiff --git a/plone/app/customerize/registrations.pt b/plone/app/customerize/registrations.pt\nindex e8fbce6..5ffdf77 100644\n--- a/plone/app/customerize/registrations.pt\n+++ b/plone/app/customerize/registrations.pt\n@@ -1,44 +1,35 @@\n <h1 tal:replace="structure context/manage_page_header" />\n <h1 tal:replace="structure context/manage_tabs" />\n \n-<style type="text/css">\n-  dl {\n-    font-family: Verdana, Helvetica, sans-serif;\n-    font-size: 10pt;\n-    margin-left: 1em;\n-  }\n-  dd {\n-    margin-bottom: 1em;\n-  }\n-  dd span.type {\n-    color: #999;\n-  }\n-  .customized {\n-    background-color: yellow;\n-  }\n-</style>\n+<main class="container-fluid">\n \n-<div>\n-  <p>The following list shows all registered (template-based) views\n-  sorted by interface. Click one of the links to see the contents\n-  of the view template and possibly customize it. Views that already\n-  have been customized are <span class="customized">highlighted like\n-  this</span>.</p>\n-</div>\n+  <style type="text/css">\n+    dd span.type {\n+      color: #999;\n+    }\n+    .customized {\n+      background-color: yellow;\n+    }\n+  </style>\n \n-<div>\n-  <p>ATTENTION: beware using this tool. Errors (e.g. <code>TypeError</code>,\n-  <code>Unauthorized</code> etc) may popup if some kinds of\n-  <code>python:</code> expressions are used in the template, making it\n-  impossible to customize here (try z3c.jbot or regular zcml overrides\n-  instead). The reason is that browser view templates are Zope 3 templates\n-  while items in portal_view_customization are Zope 2 templates. The different\n-  security models underlying the two implementations may break rendering of the\n-  site. If that happens just delete the custom copy using the Contents tab\n-  above.</p>\n+<div class="alert alert-danger" role="alert">\n+  ATTENTION: beware using this tool.\n+  Errors (e.g. <code>TypeError</code>, <code>Unauthorized</code> etc) may popup if some kinds of\n+  <code>python:</code> expressions are used in the template.\n+  This makes it impossible to customize those here (try z3c.jbot or regular zcml overrides instead).\n+  The reason is that browser view templates are Chameleon Pagetemplates while items in portal_view_customization are Zope 2 templates.\n+  The different security models underlying the two implementations may break rendering of thesite.\n+  If that happens just delete the custom copy using the Contents tab above.\n </div>\n \n-<div>\n+  <p class="form-help">\n+    The following list shows all registered (template-based) views\n+    sorted by interface. Click one of the links to see the contents\n+    of the view template and possibly customize it. Views that already\n+    have been customized are <span class="customized">highlighted like\n+    this</span>.\n+  </p>\n+\n   <article tal:repeat="iface python:view.getTemplateViewRegistrations(mangle=False)">\n     <header tal:content="iface/name" />\n     <ul>\n@@ -54,10 +45,11 @@\n                            title info/zptfile;"\n            tal:content="info/viewname">\n         </a>\n-        <span tal:content="string:(${info/type})" class="type" /> <br />\n+        <code tal:content="string:(${info/type})" class="type" /> <br />\n       </li>\n     </ul>\n   </article>\n-</div>\n \n-<h1 tal:replace="structure context/manage_page_footer" />\n+</main>\n+\n+<h1 tal:replace="structure context/manage_page_footer" />\n\\ No newline at end of file\ndiff --git a/plone/app/customerize/tests/testDocTests.py b/plone/app/customerize/tests/testDocTests.py\nindex cd51685..3e18c65 100644\n--- a/plone/app/customerize/tests/testDocTests.py\n+++ b/plone/app/customerize/tests/testDocTests.py\n@@ -1,5 +1,7 @@\n # -*- coding: utf-8 -*-\n-from plone.app.customerize.testing import PLONE_APP_CUSTOMERIZE_FUNCTIONAL_TESTING  # noqa\n+from plone.app.customerize.testing import (\n+    PLONE_APP_CUSTOMERIZE_FUNCTIONAL_TESTING  # noqa\n+)\n from plone.testing import layered\n from unittest import TestSuite\n \n@@ -18,7 +20,7 @@ def check_output(self, want, got, optionflags):\n \n def test_suite():\n     suite = TestSuite()\n-    OPTIONFLAGS = (doctest.ELLIPSIS | doctest.NORMALIZE_WHITESPACE)\n+    OPTIONFLAGS = doctest.ELLIPSIS | doctest.NORMALIZE_WHITESPACE\n     for testfile in (\'testBrowserLayers.txt\', \'testCustomizeView.txt\'):\n         suite.addTest(\n             layered(\n@@ -28,7 +30,7 @@ def test_suite():\n                     package=\'plone.app.customerize.tests\',\n                     checker=Py23DocChecker(),\n                 ),\n-                layer=PLONE_APP_CUSTOMERIZE_FUNCTIONAL_TESTING\n+                layer=PLONE_APP_CUSTOMERIZE_FUNCTIONAL_TESTING,\n             )\n         )\n     return suite\ndiff --git a/plone/app/customerize/tool.py b/plone/app/customerize/tool.py\nindex 3c8a7ba..dbeb642 100644\n--- a/plone/app/customerize/tool.py\n+++ b/plone/app/customerize/tool.py\n@@ -19,8 +19,10 @@ class ViewTemplateContainer(Folder):\n     security = ClassSecurityInfo()\n \n     manage_options = (\n-        dict(label=\'Registrations\', action=\'registrations.html\'),\n-    ) + Folder.manage_options[0:1] + Folder.manage_options[2:]\n+        (dict(label=\'Registrations\', action=\'registrations.html\'),) +\n+        Folder.manage_options[0:1] +\n+        Folder.manage_options[2:]\n+    )\n \n     @security.protected(ManagePortal)\n     def addTemplate(self, id, template):\n@@ -28,4 +30,5 @@ def addTemplate(self, id, template):\n         self._setObject(id, template)\n         return getattr(self, id)\n \n+\n InitializeClass(ViewTemplateContainer)\n'

