Repository: plone.app.layout


Branch: refs/heads/2.8.x
Date: 2018-10-13T09:23:18-03:00
Author: Rodrigo Ferreira de Souza (rodfersou) <rodfersou@gmail.com>
Commit: https://github.com/plone/plone.app.layout/commit/5aa199dd39386ddd6062283541812e20561c33b4

Add template and view arguments support to IBodyClassAdapters

Files changed:
M CHANGES.rst
M plone/app/layout/globals/layout.py

b"diff --git a/CHANGES.rst b/CHANGES.rst\nindex e2113f4..b4ae3a7 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -14,7 +14,8 @@ New features:\n \n Bug fixes:\n \n-- *add item here*\n+- Add template and view arguments support to IBodyClassAdapters (fixes `#158 <https://github.com/plone/plone.app.layout/issues/158>`_).\n+  [rodfersou]\n \n \n 2.8.2 (2018-09-28)\ndiff --git a/plone/app/layout/globals/layout.py b/plone/app/layout/globals/layout.py\nindex 0587e45..35c6d11 100644\n--- a/plone/app/layout/globals/layout.py\n+++ b/plone/app/layout/globals/layout.py\n@@ -321,7 +321,10 @@ def bodyClass(self, template, view):\n             IBodyClassAdapter\n         )\n         for name, body_class_adapter in body_class_adapters:\n-            extra_classes = body_class_adapter.get_classes() or []\n+            try:\n+                extra_classes = body_class_adapter.get_classes(template, view) or []\n+            except TypeError:  # This adapter is implemented without arguments\n+                extra_classes = body_class_adapter.get_classes() or []\n             if isinstance(extra_classes, basestring):\n                 extra_classes = extra_classes.split(' ')\n             body_classes.update(extra_classes)\n"

Repository: plone.app.layout


Branch: refs/heads/2.8.x
Date: 2018-10-18T22:56:20+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.layout/commit/07ea1b2a2bc15b8de6f3072fe2be5063d223d48e

Merge pull request #171 from plone/rodfersou/158-280

Add template and view arguments support to IBodyClassAdapters

Files changed:
M CHANGES.rst
M plone/app/layout/globals/layout.py

b"diff --git a/CHANGES.rst b/CHANGES.rst\nindex e2113f4..b4ae3a7 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -14,7 +14,8 @@ New features:\n \n Bug fixes:\n \n-- *add item here*\n+- Add template and view arguments support to IBodyClassAdapters (fixes `#158 <https://github.com/plone/plone.app.layout/issues/158>`_).\n+  [rodfersou]\n \n \n 2.8.2 (2018-09-28)\ndiff --git a/plone/app/layout/globals/layout.py b/plone/app/layout/globals/layout.py\nindex 0587e45..35c6d11 100644\n--- a/plone/app/layout/globals/layout.py\n+++ b/plone/app/layout/globals/layout.py\n@@ -321,7 +321,10 @@ def bodyClass(self, template, view):\n             IBodyClassAdapter\n         )\n         for name, body_class_adapter in body_class_adapters:\n-            extra_classes = body_class_adapter.get_classes() or []\n+            try:\n+                extra_classes = body_class_adapter.get_classes(template, view) or []\n+            except TypeError:  # This adapter is implemented without arguments\n+                extra_classes = body_class_adapter.get_classes() or []\n             if isinstance(extra_classes, basestring):\n                 extra_classes = extra_classes.split(' ')\n             body_classes.update(extra_classes)\n"

