Repository: plone.schemaeditor


Branch: refs/heads/master
Date: 2018-08-14T16:53:42+12:00
Author: ezvirtual (ezvirtual) <ezvirtual@thevirtual.co.nz>
Commit: https://github.com/plone/plone.schemaeditor/commit/b294102f852b0f21b01119b8891bae23b00d4c85

Allow defaults to be set on dexterity type fields via the web UI

Files changed:
M CHANGES.rst
M plone/schemaeditor/browser/schema/listing.py

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex e9f4d9e..70afae8 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -14,7 +14,8 @@ New features:\n \n Bug fixes:\n \n-- *add item here*\n+- Allow defaults to be set on dexterity type fields via the web UI (@@fields)\n+  [ezvirtual]\n \n \n 2.0.19 (2018-02-02)\ndiff --git a/plone/schemaeditor/browser/schema/listing.py b/plone/schemaeditor/browser/schema/listing.py\nindex 3030ab1..ac05e85 100644\n--- a/plone/schemaeditor/browser/schema/listing.py\n+++ b/plone/schemaeditor/browser/schema/listing.py\n@@ -114,8 +114,11 @@ def handleSaveDefaults(self, action):\n             self.status = self.formErrorsMessage\n             return\n \n-        for fname, value in data.items():\n-            self.context.schema[fname].default = value\n+        for widget in self._iterateOverWidgets():\n+            widget_name = widget.field.getName()\n+            if (widget.field.interface is self.context.schema and\n+                    widget_name in data):\n+                self.context.schema[widget_name].default = data[widget_name]\n         notify(SchemaModifiedEvent(self.context))\n \n         # update widgets to take the new defaults into account\n'

Repository: plone.schemaeditor


Branch: refs/heads/master
Date: 2018-08-14T09:46:21+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.schemaeditor/commit/0bd2d1e9877914493142d8cc90a96c61d0dab6c8

Merge pull request #62 from TheVirtualLtd/master

Allow defaults to be set on dexterity type fields via the web UI

Files changed:
M CHANGES.rst
M plone/schemaeditor/browser/schema/listing.py

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex e9f4d9e..70afae8 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -14,7 +14,8 @@ New features:\n \n Bug fixes:\n \n-- *add item here*\n+- Allow defaults to be set on dexterity type fields via the web UI (@@fields)\n+  [ezvirtual]\n \n \n 2.0.19 (2018-02-02)\ndiff --git a/plone/schemaeditor/browser/schema/listing.py b/plone/schemaeditor/browser/schema/listing.py\nindex 3030ab1..ac05e85 100644\n--- a/plone/schemaeditor/browser/schema/listing.py\n+++ b/plone/schemaeditor/browser/schema/listing.py\n@@ -114,8 +114,11 @@ def handleSaveDefaults(self, action):\n             self.status = self.formErrorsMessage\n             return\n \n-        for fname, value in data.items():\n-            self.context.schema[fname].default = value\n+        for widget in self._iterateOverWidgets():\n+            widget_name = widget.field.getName()\n+            if (widget.field.interface is self.context.schema and\n+                    widget_name in data):\n+                self.context.schema[widget_name].default = data[widget_name]\n         notify(SchemaModifiedEvent(self.context))\n \n         # update widgets to take the new defaults into account\n'

