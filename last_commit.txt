Repository: plone.app.content


Branch: refs/heads/3.5.x
Date: 2019-07-19T09:53:53+08:00
Author: adam139 (adam139) <yuejun.tang@gmail.com>
Commit: https://github.com/plone/plone.app.content/commit/c552dc77e9762bd8475d83ffe87a6b97757b3c0f

fix plonejsi18n view's language code function:input 'zh-cn',output should be 'zh_CN'.(#180)

Files changed:
M plone/app/content/browser/i18n.py

b'diff --git a/plone/app/content/browser/i18n.py b/plone/app/content/browser/i18n.py\nindex c2c5394..a049884 100644\n--- a/plone/app/content/browser/i18n.py\n+++ b/plone/app/content/browser/i18n.py\n@@ -39,6 +39,9 @@ def __call__(self, domain=None, language=None):\n         else:\n             if language is None:\n                 language = self.request[\'LANGUAGE\']\n+            tp = language.split("-")\n+            if len(tp) > 1:\n+                language = "%s_%s" % (tp[0],tp[1].upper())            \n             catalog = self._gettext_catalog(domain, language)\n \n         response = self.request.response\n'

Repository: plone.app.content


Branch: refs/heads/3.5.x
Date: 2019-07-19T20:45:05+08:00
Author: Adam (adam139) <tangyuejun@315ok.org>
Commit: https://github.com/plone/plone.app.content/commit/1ff50bed7a92d21823ae759d25dbbd48bbc0c7d0

Merge pull request #181 from plone/fix_language_code

fix plonejsi18n view's language code function:input 'zh-cn',output shâ€¦

Files changed:
M plone/app/content/browser/i18n.py

b'diff --git a/plone/app/content/browser/i18n.py b/plone/app/content/browser/i18n.py\nindex c2c5394..a049884 100644\n--- a/plone/app/content/browser/i18n.py\n+++ b/plone/app/content/browser/i18n.py\n@@ -39,6 +39,9 @@ def __call__(self, domain=None, language=None):\n         else:\n             if language is None:\n                 language = self.request[\'LANGUAGE\']\n+            tp = language.split("-")\n+            if len(tp) > 1:\n+                language = "%s_%s" % (tp[0],tp[1].upper())            \n             catalog = self._gettext_catalog(domain, language)\n \n         response = self.request.response\n'

