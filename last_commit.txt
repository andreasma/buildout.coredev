Repository: plone.batching


Branch: refs/heads/master
Date: 2018-11-27T21:38:03+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.batching/commit/de67c8a518f8ef25363de7bcd5fbf22f26e2fa85

Do not show batch navigation for single page with orphan.

Files changed:
A news/9.bugfix
M plone/batching/batch.py
M plone/batching/tests.py

b'diff --git a/news/9.bugfix b/news/9.bugfix\nnew file mode 100644\nindex 0000000..cad31f8\n--- /dev/null\n+++ b/news/9.bugfix\n@@ -0,0 +1 @@\n+Do not show batch navigation for single page with orphan.  [maurits]\ndiff --git a/plone/batching/batch.py b/plone/batching/batch.py\nindex f0c8fca..e569351 100644\n--- a/plone/batching/batch.py\n+++ b/plone/batching/batch.py\n@@ -191,7 +191,7 @@ def items_on_page(self):\n     def multiple_pages(self):\n         """ `True`, if batch has more than one page.\n         """\n-        return self.sequence_length > self.pagesize\n+        return self.sequence_length > (self.pagesize + self.orphan)\n \n     @property\n     def previouspage(self):\ndiff --git a/plone/batching/tests.py b/plone/batching/tests.py\nindex f948753..a46b8bc 100644\n--- a/plone/batching/tests.py\n+++ b/plone/batching/tests.py\n@@ -203,6 +203,14 @@ def test_multiple_pages_longer(self):\n         batch = BaseBatch(range(12), 10)\n         self.assertEquals(batch.multiple_pages, True)\n \n+    def test_multiple_pages_orphan(self):\n+        """sequence with orphans"""\n+        self.assertFalse(BaseBatch(range(20), 20, orphan=0).multiple_pages)\n+        self.assertTrue(BaseBatch(range(21), 20, orphan=0).multiple_pages)\n+        self.assertFalse(BaseBatch(range(21), 20, orphan=1).multiple_pages)\n+        self.assertFalse(BaseBatch(range(22), 20, orphan=2).multiple_pages)\n+        self.assertTrue(BaseBatch(range(22), 20, orphan=1).multiple_pages)\n+\n     def test_pagenumber_never_over_numpages(self):\n         """computed _pagenumber is never > numpages, this\n            makes previous_pages not fail."""\n'

Repository: plone.batching


Branch: refs/heads/master
Date: 2018-11-28T09:00:15+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.batching/commit/94e174008eeda4aee5cb205d7aa7b4abc75a670a

Merge pull request #24 from plone/fix-single-page-with-orphan

Do not show batch navigation for single page with orphan.

Files changed:
A news/9.bugfix
M plone/batching/batch.py
M plone/batching/tests.py

b'diff --git a/news/9.bugfix b/news/9.bugfix\nnew file mode 100644\nindex 0000000..cad31f8\n--- /dev/null\n+++ b/news/9.bugfix\n@@ -0,0 +1 @@\n+Do not show batch navigation for single page with orphan.  [maurits]\ndiff --git a/plone/batching/batch.py b/plone/batching/batch.py\nindex f0c8fca..e569351 100644\n--- a/plone/batching/batch.py\n+++ b/plone/batching/batch.py\n@@ -191,7 +191,7 @@ def items_on_page(self):\n     def multiple_pages(self):\n         """ `True`, if batch has more than one page.\n         """\n-        return self.sequence_length > self.pagesize\n+        return self.sequence_length > (self.pagesize + self.orphan)\n \n     @property\n     def previouspage(self):\ndiff --git a/plone/batching/tests.py b/plone/batching/tests.py\nindex f948753..a46b8bc 100644\n--- a/plone/batching/tests.py\n+++ b/plone/batching/tests.py\n@@ -203,6 +203,14 @@ def test_multiple_pages_longer(self):\n         batch = BaseBatch(range(12), 10)\n         self.assertEquals(batch.multiple_pages, True)\n \n+    def test_multiple_pages_orphan(self):\n+        """sequence with orphans"""\n+        self.assertFalse(BaseBatch(range(20), 20, orphan=0).multiple_pages)\n+        self.assertTrue(BaseBatch(range(21), 20, orphan=0).multiple_pages)\n+        self.assertFalse(BaseBatch(range(21), 20, orphan=1).multiple_pages)\n+        self.assertFalse(BaseBatch(range(22), 20, orphan=2).multiple_pages)\n+        self.assertTrue(BaseBatch(range(22), 20, orphan=1).multiple_pages)\n+\n     def test_pagenumber_never_over_numpages(self):\n         """computed _pagenumber is never > numpages, this\n            makes previous_pages not fail."""\n'

