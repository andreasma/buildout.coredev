Repository: plone.app.upgrade


Branch: refs/heads/master
Date: 2019-11-03T14:24:55+01:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/plone.app.upgrade/commit/4c68e428cb9b254613a545cc3cdd64364c847cf2

Revert "Add ``upgrade_static_resources`` util for applying and pending upgrades of plone.staticresources."

This reverts commit fa31f9c99b2dbfbd7a5f61e9b843a37d0190bae9.

Files changed:
M plone/app/upgrade/utils.py
M plone/app/upgrade/v52/configure.zcml
M plone/app/upgrade/v52/profiles/to_521/registry.xml
D news/218.bugfix

b'diff --git a/news/218.bugfix b/news/218.bugfix\ndeleted file mode 100644\nindex 63d956a7..00000000\n--- a/news/218.bugfix\n+++ /dev/null\n@@ -1,2 +0,0 @@\n-Add ``upgrade_static_resources`` util for applying and pending upgrades of plone.staticresources.\n-[thet]\ndiff --git a/plone/app/upgrade/utils.py b/plone/app/upgrade/utils.py\nindex 922410c3..bb17fdba 100644\n--- a/plone/app/upgrade/utils.py\n+++ b/plone/app/upgrade/utils.py\n@@ -39,11 +39,6 @@ def null_upgrade_step(tool):\n     pass\n \n \n-def upgrade_static_resources(tool):\n-    """ Upgrades all pending plone.staticresources upgrade steps """\n-    tool.upgradeProfile(\'plone.staticresources:default\')\n-\n-\n def safeEditProperty(obj, key, value, data_type=\'string\'):\n     """ An add or edit function, surprisingly useful :) """\n     if obj.hasProperty(key):\ndiff --git a/plone/app/upgrade/v52/configure.zcml b/plone/app/upgrade/v52/configure.zcml\nindex 53eb9742..ce754111 100644\n--- a/plone/app/upgrade/v52/configure.zcml\n+++ b/plone/app/upgrade/v52/configure.zcml\n@@ -135,11 +135,6 @@\n             description=""\n             handler=".final.to521"\n             />\n-        <gs:upgradeStep\n-            title="Upgrade static resources"\n-            description=""\n-            handler="..utils.upgrade_static_resources"\n-            />\n \n     </gs:upgradeSteps>\n \ndiff --git a/plone/app/upgrade/v52/profiles/to_521/registry.xml b/plone/app/upgrade/v52/profiles/to_521/registry.xml\nindex 009bfefd..1156921b 100644\n--- a/plone/app/upgrade/v52/profiles/to_521/registry.xml\n+++ b/plone/app/upgrade/v52/profiles/to_521/registry.xml\n@@ -5,4 +5,4 @@\n       <element>Collection</element>\n     </value>\n   </records>\n-</registry>\n+</registry>\n\\ No newline at end of file\n'

Repository: plone.app.upgrade


Branch: refs/heads/master
Date: 2019-11-03T22:29:44+01:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/plone.app.upgrade/commit/6ce9596db0fcc58cd79456f5c29a3b552d6fe80d

Merge pull request #219 from plone/thet-staticresources-autoupgrade

plone.staticresources auto upgrade

Files changed:
M plone/app/upgrade/utils.py
M plone/app/upgrade/v52/configure.zcml
M plone/app/upgrade/v52/profiles/to_521/registry.xml
D news/218.bugfix

b'diff --git a/news/218.bugfix b/news/218.bugfix\ndeleted file mode 100644\nindex 63d956a7..00000000\n--- a/news/218.bugfix\n+++ /dev/null\n@@ -1,2 +0,0 @@\n-Add ``upgrade_static_resources`` util for applying and pending upgrades of plone.staticresources.\n-[thet]\ndiff --git a/plone/app/upgrade/utils.py b/plone/app/upgrade/utils.py\nindex 922410c3..bb17fdba 100644\n--- a/plone/app/upgrade/utils.py\n+++ b/plone/app/upgrade/utils.py\n@@ -39,11 +39,6 @@ def null_upgrade_step(tool):\n     pass\n \n \n-def upgrade_static_resources(tool):\n-    """ Upgrades all pending plone.staticresources upgrade steps """\n-    tool.upgradeProfile(\'plone.staticresources:default\')\n-\n-\n def safeEditProperty(obj, key, value, data_type=\'string\'):\n     """ An add or edit function, surprisingly useful :) """\n     if obj.hasProperty(key):\ndiff --git a/plone/app/upgrade/v52/configure.zcml b/plone/app/upgrade/v52/configure.zcml\nindex 53eb9742..ce754111 100644\n--- a/plone/app/upgrade/v52/configure.zcml\n+++ b/plone/app/upgrade/v52/configure.zcml\n@@ -135,11 +135,6 @@\n             description=""\n             handler=".final.to521"\n             />\n-        <gs:upgradeStep\n-            title="Upgrade static resources"\n-            description=""\n-            handler="..utils.upgrade_static_resources"\n-            />\n \n     </gs:upgradeSteps>\n \ndiff --git a/plone/app/upgrade/v52/profiles/to_521/registry.xml b/plone/app/upgrade/v52/profiles/to_521/registry.xml\nindex 009bfefd..1156921b 100644\n--- a/plone/app/upgrade/v52/profiles/to_521/registry.xml\n+++ b/plone/app/upgrade/v52/profiles/to_521/registry.xml\n@@ -5,4 +5,4 @@\n       <element>Collection</element>\n     </value>\n   </records>\n-</registry>\n+</registry>\n\\ No newline at end of file\n'

