Repository: plone.app.dexterity


Branch: refs/heads/master
Date: 2018-10-22T22:15:19+02:00
Author: Mike Metcalfe (mikejmets) <mike@webtide.co.za>
Commit: https://github.com/plone/plone.app.dexterity/commit/e871c34803e6e4c1a36a8e4900b43ad246af8e03

Dexterity Import Type Profile fails (#278)

* Added missing StringIO import

* Corrected import_types fix to use BytesIO instead of StringIO
Added bugfix news item

Files changed:
A news/279.bugfix
M plone/app/dexterity/browser/import_types.py

b"diff --git a/news/279.bugfix b/news/279.bugfix\nnew file mode 100644\nindex 0000000..d095bcb\n--- /dev/null\n+++ b/news/279.bugfix\n@@ -0,0 +1 @@\n+Import Type Profile fails because code was using StringIO instead of ByteIO\ndiff --git a/plone/app/dexterity/browser/import_types.py b/plone/app/dexterity/browser/import_types.py\nindex 434af41..1310ad7 100644\n--- a/plone/app/dexterity/browser/import_types.py\n+++ b/plone/app/dexterity/browser/import_types.py\n@@ -115,7 +115,7 @@ def add(self, profile_import):\n         types_tool = getToolByName(self.context, 'portal_types')\n         import_context = ZipFileImportContext(\n             types_tool,\n-            StringIO(profile_import.profile_file.data)\n+            BytesIO(profile_import.profile_file.data)\n         )\n         # run the profile\n         setup_tool = getToolByName(self.context, 'portal_setup')\n@@ -127,6 +127,7 @@ def nextURL(self):\n         url = self.context.absolute_url()\n         return url\n \n+\n TypeProfileImportFormPage = wrap_form(TypeProfileImportForm)\n \n \n"

