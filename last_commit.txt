Repository: Products.CMFFormController


Branch: refs/heads/master
Date: 2020-02-12T11:12:00+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/Products.CMFFormController/commit/a9263705366fb4fedb1aee51c4c47e24ff570241

Fixed DeprecationWarning for InitializeClass.

"InitializeClass is deprecated. Please import from AccessControl.class_init."
Works now with Zope 5

Files changed:
A news/22.bugfix
M Products/CMFFormController/BaseControllerPageTemplate.py
M Products/CMFFormController/ControllerBase.py
M Products/CMFFormController/ControllerPageTemplate.py
M Products/CMFFormController/ControllerState.py
M Products/CMFFormController/FSControllerBase.py
M Products/CMFFormController/FSControllerPageTemplate.py
M Products/CMFFormController/FSControllerPythonScript.py
M Products/CMFFormController/FSControllerValidator.py
M Products/CMFFormController/FormAction.py
M Products/CMFFormController/FormController.py
M Products/CMFFormController/FormValidator.py
M Products/CMFFormController/Script.py
M Products/CMFFormController/exportimport/formcontroller.py
M setup.py

b'diff --git a/Products/CMFFormController/BaseControllerPageTemplate.py b/Products/CMFFormController/BaseControllerPageTemplate.py\nindex 222a4c5..ed190d5 100644\n--- a/Products/CMFFormController/BaseControllerPageTemplate.py\n+++ b/Products/CMFFormController/BaseControllerPageTemplate.py\n@@ -1,6 +1,6 @@\n from .ControllerBase import ControllerBase\n from AccessControl import ClassSecurityInfo\n-from App.class_init import InitializeClass\n+from AccessControl.class_init import InitializeClass\n from Products.CMFCore.permissions import View\n from Products.CMFCore.utils import getToolByName\n \ndiff --git a/Products/CMFFormController/ControllerBase.py b/Products/CMFFormController/ControllerBase.py\nindex 13622a3..7f9e28b 100644\n--- a/Products/CMFFormController/ControllerBase.py\n+++ b/Products/CMFFormController/ControllerBase.py\n@@ -4,7 +4,7 @@\n from .utils import log\n from AccessControl import ClassSecurityInfo\n from Acquisition import aq_base, aq_inner\n-from App.class_init import InitializeClass\n+from AccessControl.class_init import InitializeClass\n from Products.CMFCore.FSMetadata import FSMetadata, CMFConfigParser\n from Products.CMFCore.permissions import View, ManagePortal\n from Products.CMFCore.utils import getToolByName\ndiff --git a/Products/CMFFormController/ControllerPageTemplate.py b/Products/CMFFormController/ControllerPageTemplate.py\nindex b57047d..a386448 100644\n--- a/Products/CMFFormController/ControllerPageTemplate.py\n+++ b/Products/CMFFormController/ControllerPageTemplate.py\n@@ -2,7 +2,7 @@\n from .FormAction import FormActionContainer\n from .FormValidator import FormValidatorContainer\n from AccessControl import ClassSecurityInfo\n-from App.class_init import InitializeClass\n+from AccessControl.class_init import InitializeClass\n from App.Common import package_home\n from Products.CMFCore.permissions import View\n from Products.PageTemplates.PageTemplateFile import PageTemplateFile\ndiff --git a/Products/CMFFormController/ControllerState.py b/Products/CMFFormController/ControllerState.py\nindex 656466e..13b2655 100644\n--- a/Products/CMFFormController/ControllerState.py\n+++ b/Products/CMFFormController/ControllerState.py\n@@ -1,7 +1,7 @@\n from .FormAction import FormAction\n from .globalVars import ANY_CONTEXT, ANY_BUTTON\n from AccessControl import ClassSecurityInfo\n-from App.class_init import InitializeClass\n+from AccessControl.class_init import InitializeClass\n from Products.CMFCore.utils import getToolByName\n \n import six\ndiff --git a/Products/CMFFormController/FSControllerBase.py b/Products/CMFFormController/FSControllerBase.py\nindex 8ae44aa..3bb4a35 100644\n--- a/Products/CMFFormController/FSControllerBase.py\n+++ b/Products/CMFFormController/FSControllerBase.py\n@@ -13,7 +13,7 @@\n \n from .ControllerBase import ControllerBase\n from AccessControl import ClassSecurityInfo\n-from App.class_init import InitializeClass\n+from AccessControl.class_init import InitializeClass\n from App.config import getConfiguration\n from Products.CMFCore.FSMetadata import FSMetadata\n \ndiff --git a/Products/CMFFormController/FSControllerPageTemplate.py b/Products/CMFFormController/FSControllerPageTemplate.py\nindex 73926a6..ac7e0c8 100644\n--- a/Products/CMFFormController/FSControllerPageTemplate.py\n+++ b/Products/CMFFormController/FSControllerPageTemplate.py\n@@ -19,7 +19,7 @@\n from .FSControllerBase import FSControllerBase\n from .utils import log, logException\n from AccessControl import ClassSecurityInfo\n-from App.class_init import InitializeClass\n+from AccessControl.class_init import InitializeClass\n from OFS.Cache import Cacheable\n from Products.CMFCore.DirectoryView import registerFileExtension, registerMetaType\n from Products.CMFCore.FSPageTemplate import FSPageTemplate as BaseClass\ndiff --git a/Products/CMFFormController/FSControllerPythonScript.py b/Products/CMFFormController/FSControllerPythonScript.py\nindex 61417e5..4ab176a 100644\n--- a/Products/CMFFormController/FSControllerPythonScript.py\n+++ b/Products/CMFFormController/FSControllerPythonScript.py\n@@ -21,7 +21,7 @@\n from .Script import FSPythonScript as BaseClass\n from .utils import log, logException\n from AccessControl import ClassSecurityInfo\n-from App.class_init import InitializeClass\n+from AccessControl.class_init import InitializeClass\n from OFS.Cache import Cacheable\n from Products.CMFCore.DirectoryView import registerFileExtension, registerMetaType\n from Products.CMFCore.permissions import View\ndiff --git a/Products/CMFFormController/FSControllerValidator.py b/Products/CMFFormController/FSControllerValidator.py\nindex 09f2abc..5f109e2 100644\n--- a/Products/CMFFormController/FSControllerValidator.py\n+++ b/Products/CMFFormController/FSControllerValidator.py\n@@ -20,7 +20,7 @@\n from .Script import FSPythonScript as BaseClass\n from .utils import logException\n from AccessControl import ClassSecurityInfo\n-from App.class_init import InitializeClass\n+from AccessControl.class_init import InitializeClass\n from OFS.Cache import Cacheable\n from Products.CMFCore.DirectoryView import registerFileExtension, registerMetaType\n from Products.CMFCore.permissions import View\ndiff --git a/Products/CMFFormController/FormAction.py b/Products/CMFFormController/FormAction.py\nindex 29f0afa..191bd48 100644\n--- a/Products/CMFFormController/FormAction.py\n+++ b/Products/CMFFormController/FormAction.py\n@@ -3,7 +3,7 @@\n from .Key import Key\n from AccessControl import ClassSecurityInfo\n from Acquisition import aq_base\n-from App.class_init import InitializeClass\n+from AccessControl.class_init import InitializeClass\n from OFS.SimpleItem import SimpleItem\n from Products.CMFCore.utils import getToolByName\n \ndiff --git a/Products/CMFFormController/FormController.py b/Products/CMFFormController/FormController.py\nindex 49ed718..56b9755 100644\n--- a/Products/CMFFormController/FormController.py\n+++ b/Products/CMFFormController/FormController.py\n@@ -4,7 +4,7 @@\n from .FormValidator import FormValidatorKey, FormValidator, FormValidatorContainer\n from .ValidationError import ValidationError\n from AccessControl import ClassSecurityInfo\n-from App.class_init import InitializeClass\n+from AccessControl.class_init import InitializeClass\n from App.Common import package_home\n from OFS.ObjectManager import bad_id\n from Products.CMFCore.permissions import ManagePortal\ndiff --git a/Products/CMFFormController/FormValidator.py b/Products/CMFFormController/FormValidator.py\nindex b449f0c..c7125cd 100644\n--- a/Products/CMFFormController/FormValidator.py\n+++ b/Products/CMFFormController/FormValidator.py\n@@ -3,7 +3,7 @@\n from .Key import Key\n from AccessControl import ClassSecurityInfo\n from Acquisition import aq_base\n-from App.class_init import InitializeClass\n+from AccessControl.class_init import InitializeClass\n from OFS.SimpleItem import SimpleItem\n from Products.CMFCore.utils import getToolByName\n \ndiff --git a/Products/CMFFormController/Script.py b/Products/CMFFormController/Script.py\nindex 779e331..8a0b26b 100644\n--- a/Products/CMFFormController/Script.py\n+++ b/Products/CMFFormController/Script.py\n@@ -12,7 +12,7 @@\n # THIS FILE CONTAINS MODIFIED CODE FROM ZOPE 2.6.2\n ##############################################################################\n \n-from App.class_init import InitializeClass\n+from AccessControl.class_init import InitializeClass\n from Products.CMFCore.FSPythonScript import FSPythonScript as BaseFSPythonScript\n from Products.PythonScripts.PythonScript import PythonScript as BasePythonScript\n from Shared.DC.Scripts.Bindings import NameAssignments as BaseNameAssignments\ndiff --git a/Products/CMFFormController/exportimport/formcontroller.py b/Products/CMFFormController/exportimport/formcontroller.py\nindex 4b55ebb..1585b65 100644\n--- a/Products/CMFFormController/exportimport/formcontroller.py\n+++ b/Products/CMFFormController/exportimport/formcontroller.py\n@@ -17,7 +17,7 @@\n \n import os\n from AccessControl import ClassSecurityInfo\n-from App.class_init import InitializeClass\n+from AccessControl.class_init import InitializeClass\n from App.Common import package_home\n from Products.PageTemplates.PageTemplateFile import PageTemplateFile\n \ndiff --git a/news/22.bugfix b/news/22.bugfix\nnew file mode 100644\nindex 0000000..b86c94b\n--- /dev/null\n+++ b/news/22.bugfix\n@@ -0,0 +1,2 @@\n+Fixed ModuleNotFoundError: No module named \'App.class_init\' on Zope 5.\n+[maurits]\ndiff --git a/setup.py b/setup.py\nindex c74e7ca..46220cb 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -15,6 +15,7 @@\n         "Framework :: Plone :: 5.2",\n         "Framework :: Zope2",\n         "Framework :: Zope :: 4",\n+        "Framework :: Zope :: 5",\n         "License :: OSI Approved :: BSD License",\n         "License :: OSI Approved :: Zope Public License",\n         "Programming Language :: Python",\n'

Repository: Products.CMFFormController


Branch: refs/heads/master
Date: 2020-02-12T11:15:41+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/Products.CMFFormController/commit/e568f29244a43d37fcdb41fbcca4a31263f9e4a6

Fixed AttributeError: 'dict_keys' object has no attribute 'sort' on Python 3.

Fixes https://github.com/plone/Products.CMFFormController/issues/21

Files changed:
A news/21.bugfix
M Products/CMFFormController/FormController.py

b'diff --git a/Products/CMFFormController/FormController.py b/Products/CMFFormController/FormController.py\nindex 56b9755..5fac524 100644\n--- a/Products/CMFFormController/FormController.py\n+++ b/Products/CMFFormController/FormController.py\n@@ -126,8 +126,7 @@ def _checkId(self, id):\n     security.declareProtected(ManagePortal, \'listActionTypes\')\n     def listActionTypes(self):\n         """Return a list of available action types."""\n-        keys = form_action_types.keys()\n-        keys.sort()\n+        keys = sorted(form_action_types.keys())\n         action_types = []\n         for k in keys:\n             action_types.append(form_action_types.get(k))\ndiff --git a/news/21.bugfix b/news/21.bugfix\nnew file mode 100644\nindex 0000000..41ecae1\n--- /dev/null\n+++ b/news/21.bugfix\n@@ -0,0 +1,2 @@\n+Fixed AttributeError: \'dict_keys\' object has no attribute \'sort\' on Python 3.\n+[maurits]\n'

Repository: Products.CMFFormController


Branch: refs/heads/master
Date: 2020-02-14T14:25:50+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.CMFFormController/commit/38bcf1b82f65253264dfe853d6029c0b9ecbb89e

Merge pull request #23 from plone/maurits-zope5-compat

Fixed Zope 5 and Python 3 compatibility

Files changed:
A news/21.bugfix
A news/22.bugfix
M Products/CMFFormController/BaseControllerPageTemplate.py
M Products/CMFFormController/ControllerBase.py
M Products/CMFFormController/ControllerPageTemplate.py
M Products/CMFFormController/ControllerState.py
M Products/CMFFormController/FSControllerBase.py
M Products/CMFFormController/FSControllerPageTemplate.py
M Products/CMFFormController/FSControllerPythonScript.py
M Products/CMFFormController/FSControllerValidator.py
M Products/CMFFormController/FormAction.py
M Products/CMFFormController/FormController.py
M Products/CMFFormController/FormValidator.py
M Products/CMFFormController/Script.py
M Products/CMFFormController/exportimport/formcontroller.py
M setup.py

b'diff --git a/Products/CMFFormController/BaseControllerPageTemplate.py b/Products/CMFFormController/BaseControllerPageTemplate.py\nindex 222a4c5..ed190d5 100644\n--- a/Products/CMFFormController/BaseControllerPageTemplate.py\n+++ b/Products/CMFFormController/BaseControllerPageTemplate.py\n@@ -1,6 +1,6 @@\n from .ControllerBase import ControllerBase\n from AccessControl import ClassSecurityInfo\n-from App.class_init import InitializeClass\n+from AccessControl.class_init import InitializeClass\n from Products.CMFCore.permissions import View\n from Products.CMFCore.utils import getToolByName\n \ndiff --git a/Products/CMFFormController/ControllerBase.py b/Products/CMFFormController/ControllerBase.py\nindex 13622a3..7f9e28b 100644\n--- a/Products/CMFFormController/ControllerBase.py\n+++ b/Products/CMFFormController/ControllerBase.py\n@@ -4,7 +4,7 @@\n from .utils import log\n from AccessControl import ClassSecurityInfo\n from Acquisition import aq_base, aq_inner\n-from App.class_init import InitializeClass\n+from AccessControl.class_init import InitializeClass\n from Products.CMFCore.FSMetadata import FSMetadata, CMFConfigParser\n from Products.CMFCore.permissions import View, ManagePortal\n from Products.CMFCore.utils import getToolByName\ndiff --git a/Products/CMFFormController/ControllerPageTemplate.py b/Products/CMFFormController/ControllerPageTemplate.py\nindex b57047d..a386448 100644\n--- a/Products/CMFFormController/ControllerPageTemplate.py\n+++ b/Products/CMFFormController/ControllerPageTemplate.py\n@@ -2,7 +2,7 @@\n from .FormAction import FormActionContainer\n from .FormValidator import FormValidatorContainer\n from AccessControl import ClassSecurityInfo\n-from App.class_init import InitializeClass\n+from AccessControl.class_init import InitializeClass\n from App.Common import package_home\n from Products.CMFCore.permissions import View\n from Products.PageTemplates.PageTemplateFile import PageTemplateFile\ndiff --git a/Products/CMFFormController/ControllerState.py b/Products/CMFFormController/ControllerState.py\nindex 656466e..13b2655 100644\n--- a/Products/CMFFormController/ControllerState.py\n+++ b/Products/CMFFormController/ControllerState.py\n@@ -1,7 +1,7 @@\n from .FormAction import FormAction\n from .globalVars import ANY_CONTEXT, ANY_BUTTON\n from AccessControl import ClassSecurityInfo\n-from App.class_init import InitializeClass\n+from AccessControl.class_init import InitializeClass\n from Products.CMFCore.utils import getToolByName\n \n import six\ndiff --git a/Products/CMFFormController/FSControllerBase.py b/Products/CMFFormController/FSControllerBase.py\nindex 8ae44aa..3bb4a35 100644\n--- a/Products/CMFFormController/FSControllerBase.py\n+++ b/Products/CMFFormController/FSControllerBase.py\n@@ -13,7 +13,7 @@\n \n from .ControllerBase import ControllerBase\n from AccessControl import ClassSecurityInfo\n-from App.class_init import InitializeClass\n+from AccessControl.class_init import InitializeClass\n from App.config import getConfiguration\n from Products.CMFCore.FSMetadata import FSMetadata\n \ndiff --git a/Products/CMFFormController/FSControllerPageTemplate.py b/Products/CMFFormController/FSControllerPageTemplate.py\nindex 73926a6..ac7e0c8 100644\n--- a/Products/CMFFormController/FSControllerPageTemplate.py\n+++ b/Products/CMFFormController/FSControllerPageTemplate.py\n@@ -19,7 +19,7 @@\n from .FSControllerBase import FSControllerBase\n from .utils import log, logException\n from AccessControl import ClassSecurityInfo\n-from App.class_init import InitializeClass\n+from AccessControl.class_init import InitializeClass\n from OFS.Cache import Cacheable\n from Products.CMFCore.DirectoryView import registerFileExtension, registerMetaType\n from Products.CMFCore.FSPageTemplate import FSPageTemplate as BaseClass\ndiff --git a/Products/CMFFormController/FSControllerPythonScript.py b/Products/CMFFormController/FSControllerPythonScript.py\nindex 61417e5..4ab176a 100644\n--- a/Products/CMFFormController/FSControllerPythonScript.py\n+++ b/Products/CMFFormController/FSControllerPythonScript.py\n@@ -21,7 +21,7 @@\n from .Script import FSPythonScript as BaseClass\n from .utils import log, logException\n from AccessControl import ClassSecurityInfo\n-from App.class_init import InitializeClass\n+from AccessControl.class_init import InitializeClass\n from OFS.Cache import Cacheable\n from Products.CMFCore.DirectoryView import registerFileExtension, registerMetaType\n from Products.CMFCore.permissions import View\ndiff --git a/Products/CMFFormController/FSControllerValidator.py b/Products/CMFFormController/FSControllerValidator.py\nindex 09f2abc..5f109e2 100644\n--- a/Products/CMFFormController/FSControllerValidator.py\n+++ b/Products/CMFFormController/FSControllerValidator.py\n@@ -20,7 +20,7 @@\n from .Script import FSPythonScript as BaseClass\n from .utils import logException\n from AccessControl import ClassSecurityInfo\n-from App.class_init import InitializeClass\n+from AccessControl.class_init import InitializeClass\n from OFS.Cache import Cacheable\n from Products.CMFCore.DirectoryView import registerFileExtension, registerMetaType\n from Products.CMFCore.permissions import View\ndiff --git a/Products/CMFFormController/FormAction.py b/Products/CMFFormController/FormAction.py\nindex 29f0afa..191bd48 100644\n--- a/Products/CMFFormController/FormAction.py\n+++ b/Products/CMFFormController/FormAction.py\n@@ -3,7 +3,7 @@\n from .Key import Key\n from AccessControl import ClassSecurityInfo\n from Acquisition import aq_base\n-from App.class_init import InitializeClass\n+from AccessControl.class_init import InitializeClass\n from OFS.SimpleItem import SimpleItem\n from Products.CMFCore.utils import getToolByName\n \ndiff --git a/Products/CMFFormController/FormController.py b/Products/CMFFormController/FormController.py\nindex 49ed718..5fac524 100644\n--- a/Products/CMFFormController/FormController.py\n+++ b/Products/CMFFormController/FormController.py\n@@ -4,7 +4,7 @@\n from .FormValidator import FormValidatorKey, FormValidator, FormValidatorContainer\n from .ValidationError import ValidationError\n from AccessControl import ClassSecurityInfo\n-from App.class_init import InitializeClass\n+from AccessControl.class_init import InitializeClass\n from App.Common import package_home\n from OFS.ObjectManager import bad_id\n from Products.CMFCore.permissions import ManagePortal\n@@ -126,8 +126,7 @@ def _checkId(self, id):\n     security.declareProtected(ManagePortal, \'listActionTypes\')\n     def listActionTypes(self):\n         """Return a list of available action types."""\n-        keys = form_action_types.keys()\n-        keys.sort()\n+        keys = sorted(form_action_types.keys())\n         action_types = []\n         for k in keys:\n             action_types.append(form_action_types.get(k))\ndiff --git a/Products/CMFFormController/FormValidator.py b/Products/CMFFormController/FormValidator.py\nindex b449f0c..c7125cd 100644\n--- a/Products/CMFFormController/FormValidator.py\n+++ b/Products/CMFFormController/FormValidator.py\n@@ -3,7 +3,7 @@\n from .Key import Key\n from AccessControl import ClassSecurityInfo\n from Acquisition import aq_base\n-from App.class_init import InitializeClass\n+from AccessControl.class_init import InitializeClass\n from OFS.SimpleItem import SimpleItem\n from Products.CMFCore.utils import getToolByName\n \ndiff --git a/Products/CMFFormController/Script.py b/Products/CMFFormController/Script.py\nindex 779e331..8a0b26b 100644\n--- a/Products/CMFFormController/Script.py\n+++ b/Products/CMFFormController/Script.py\n@@ -12,7 +12,7 @@\n # THIS FILE CONTAINS MODIFIED CODE FROM ZOPE 2.6.2\n ##############################################################################\n \n-from App.class_init import InitializeClass\n+from AccessControl.class_init import InitializeClass\n from Products.CMFCore.FSPythonScript import FSPythonScript as BaseFSPythonScript\n from Products.PythonScripts.PythonScript import PythonScript as BasePythonScript\n from Shared.DC.Scripts.Bindings import NameAssignments as BaseNameAssignments\ndiff --git a/Products/CMFFormController/exportimport/formcontroller.py b/Products/CMFFormController/exportimport/formcontroller.py\nindex 4b55ebb..1585b65 100644\n--- a/Products/CMFFormController/exportimport/formcontroller.py\n+++ b/Products/CMFFormController/exportimport/formcontroller.py\n@@ -17,7 +17,7 @@\n \n import os\n from AccessControl import ClassSecurityInfo\n-from App.class_init import InitializeClass\n+from AccessControl.class_init import InitializeClass\n from App.Common import package_home\n from Products.PageTemplates.PageTemplateFile import PageTemplateFile\n \ndiff --git a/news/21.bugfix b/news/21.bugfix\nnew file mode 100644\nindex 0000000..41ecae1\n--- /dev/null\n+++ b/news/21.bugfix\n@@ -0,0 +1,2 @@\n+Fixed AttributeError: \'dict_keys\' object has no attribute \'sort\' on Python 3.\n+[maurits]\ndiff --git a/news/22.bugfix b/news/22.bugfix\nnew file mode 100644\nindex 0000000..b86c94b\n--- /dev/null\n+++ b/news/22.bugfix\n@@ -0,0 +1,2 @@\n+Fixed ModuleNotFoundError: No module named \'App.class_init\' on Zope 5.\n+[maurits]\ndiff --git a/setup.py b/setup.py\nindex c74e7ca..46220cb 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -15,6 +15,7 @@\n         "Framework :: Plone :: 5.2",\n         "Framework :: Zope2",\n         "Framework :: Zope :: 4",\n+        "Framework :: Zope :: 5",\n         "License :: OSI Approved :: BSD License",\n         "License :: OSI Approved :: Zope Public License",\n         "Programming Language :: Python",\n'

