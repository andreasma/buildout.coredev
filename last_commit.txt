Repository: Products.CMFPlone


Branch: refs/heads/5.1.x
Date: 2019-07-08T00:07:40-07:00
Author: Ross Patterson (rpatterson) <me@rpatterson.net>
Commit: https://github.com/plone/Products.CMFPlone/commit/cdb1b827f05af423bd8383068e5d2abf23a4910a

Fix #2914: Fix the TinyMCE pattern loading HTML as CSS...

For some reason, plone.app.theming===2.0.5 [replaces empty resource lists with
empty
strings](https://github.com/plone/plone.app.theming/blob/2.0.x/src/plone/app/theming/utils.py#L318).
While this seems less than ideal to me, that using None/null is more explicit,
it still seems like a bug that in the pattern here the empty string ends up
adding the nav root URL to the list of CSS files to load.  This results in a
warning in the browser console and greatly slows down loading the edit form.

Files changed:
A news/2914.bugfix
M Products/CMFPlone/patterns/tinymce.py

b"diff --git a/Products/CMFPlone/patterns/tinymce.py b/Products/CMFPlone/patterns/tinymce.py\nindex c7bdab7ba..53f81f41c 100644\n--- a/Products/CMFPlone/patterns/tinymce.py\n+++ b/Products/CMFPlone/patterns/tinymce.py\n@@ -48,7 +48,7 @@ def get_content_css(self, style_css=''):\n                 files.append('/'.join([self.nav_root_url, url.strip()]))\n         theme = self.get_theme()\n         tinymce_content_css = getattr(theme, 'tinymce_content_css', None)\n-        if tinymce_content_css is not None:\n+        if tinymce_content_css:\n             for path in theme.tinymce_content_css.split(','):\n                 if path.startswith('http://') or path.startswith('https://'):\n                     files.append(path)\ndiff --git a/news/2914.bugfix b/news/2914.bugfix\nnew file mode 100644\nindex 000000000..befdf96fd\n--- /dev/null\n+++ b/news/2914.bugfix\n@@ -0,0 +1,2 @@\n+Fix the TinyMCE pattern loading HTML as CSS.\n+[rpatterson]\n"

Repository: Products.CMFPlone


Branch: refs/heads/5.1.x
Date: 2019-12-10T18:00:32+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.CMFPlone/commit/c47e556e600de67c3cb234d9bd37f2749dd734b7

Merge pull request #2915 from rpatterson/5.1.x

Fix #2914: Fix the TinyMCE pattern loading HTML as CSS...

Files changed:
A news/2914.bugfix
M Products/CMFPlone/patterns/tinymce.py

b"diff --git a/Products/CMFPlone/patterns/tinymce.py b/Products/CMFPlone/patterns/tinymce.py\nindex c7bdab7ba..53f81f41c 100644\n--- a/Products/CMFPlone/patterns/tinymce.py\n+++ b/Products/CMFPlone/patterns/tinymce.py\n@@ -48,7 +48,7 @@ def get_content_css(self, style_css=''):\n                 files.append('/'.join([self.nav_root_url, url.strip()]))\n         theme = self.get_theme()\n         tinymce_content_css = getattr(theme, 'tinymce_content_css', None)\n-        if tinymce_content_css is not None:\n+        if tinymce_content_css:\n             for path in theme.tinymce_content_css.split(','):\n                 if path.startswith('http://') or path.startswith('https://'):\n                     files.append(path)\ndiff --git a/news/2914.bugfix b/news/2914.bugfix\nnew file mode 100644\nindex 000000000..befdf96fd\n--- /dev/null\n+++ b/news/2914.bugfix\n@@ -0,0 +1,2 @@\n+Fix the TinyMCE pattern loading HTML as CSS.\n+[rpatterson]\n"

