Repository: plone.app.upgrade


Branch: refs/heads/master
Date: 2020-02-17T18:08:03+01:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/plone.app.upgrade/commit/9f40af95c986fe9be2577d22f79ebae4c27393c3

Add Upgrade step for Plone 5.2.2. Move accidentially merged upgrade step for #209 from 5.2.1 to 5.2.2

Files changed:
A plone/app/upgrade/v52/profiles/to_521/registry.xml
A plone/app/upgrade/v52/profiles/to_522/registry/image_captioning.xml
M news/209.feature
M plone/app/upgrade/v52/configure.zcml
M plone/app/upgrade/v52/final.py
M plone/app/upgrade/v52/profiles.zcml
D plone/app/upgrade/v52/profiles/to_521/registry/image_captioning.xml
D plone/app/upgrade/v52/profiles/to_521/registry/types_schema.xml

b'diff --git a/news/209.feature b/news/209.feature\nindex 7a68051e..9886bed6 100644\n--- a/news/209.feature\n+++ b/news/209.feature\n@@ -1,3 +1,6 @@\n+Add upgrade step for Plone 5.2.2.\n+[thet]\n+\n Image caption support\n Allow ``figcaption`` in rich text editor as a valid tag.\n Add registry setting for plone.image_caption outputfilter transform.\ndiff --git a/plone/app/upgrade/v52/configure.zcml b/plone/app/upgrade/v52/configure.zcml\nindex ce754111..7d19c988 100644\n--- a/plone/app/upgrade/v52/configure.zcml\n+++ b/plone/app/upgrade/v52/configure.zcml\n@@ -138,4 +138,17 @@\n \n     </gs:upgradeSteps>\n \n+    <gs:upgradeSteps\n+        source="5208"\n+        destination="5209"\n+        profile="Products.CMFPlone:plone">\n+\n+        <gs:upgradeStep\n+            title="Miscellaneous"\n+            description=""\n+            handler=".final.to522"\n+            />\n+\n+    </gs:upgradeSteps>\n+\n </configure>\ndiff --git a/plone/app/upgrade/v52/final.py b/plone/app/upgrade/v52/final.py\nindex c60414ce..29701a83 100644\n--- a/plone/app/upgrade/v52/final.py\n+++ b/plone/app/upgrade/v52/final.py\n@@ -118,6 +118,7 @@ def change_interface_on_lang_registry_records(context):\n         )\n         record.field.interfaceName = NEW_PREFIX\n \n+\n def to521(context):\n     """5.2.0 -> 5.2.1"""\n     loadMigrationProfile(context, \'profile-plone.app.upgrade.v52:to521\')\n@@ -126,3 +127,8 @@ def to521(context):\n     qi = get_installer(context)\n     if not qi.is_product_installed(\'plone.staticresources\'):\n         qi.install_product(\'plone.staticresources\')\n+\n+\n+def to522(context):\n+    """5.2.1 -> 5.2.2"""\n+    loadMigrationProfile(context, \'profile-plone.app.upgrade.v52:to522\')\ndiff --git a/plone/app/upgrade/v52/profiles.zcml b/plone/app/upgrade/v52/profiles.zcml\nindex 16c30c03..95ee05e2 100644\n--- a/plone/app/upgrade/v52/profiles.zcml\n+++ b/plone/app/upgrade/v52/profiles.zcml\n@@ -48,5 +48,13 @@\n       provides="Products.GenericSetup.interfaces.EXTENSION"\n       />\n \n+  <genericsetup:registerProfile\n+      name="to522"\n+      title="Upgrade profile for Plone 5.2.1 to Plone 5.2.2"\n+      description=""\n+      directory="profiles/to_522"\n+      for="Products.CMFPlone.interfaces.IMigratingPloneSiteRoot"\n+      provides="Products.GenericSetup.interfaces.EXTENSION"\n+      />\n \n </configure>\ndiff --git a/plone/app/upgrade/v52/profiles/to_521/registry/types_schema.xml b/plone/app/upgrade/v52/profiles/to_521/registry.xml\nsimilarity index 100%\nrename from plone/app/upgrade/v52/profiles/to_521/registry/types_schema.xml\nrename to plone/app/upgrade/v52/profiles/to_521/registry.xml\ndiff --git a/plone/app/upgrade/v52/profiles/to_521/registry/image_captioning.xml b/plone/app/upgrade/v52/profiles/to_522/registry/image_captioning.xml\nsimilarity index 100%\nrename from plone/app/upgrade/v52/profiles/to_521/registry/image_captioning.xml\nrename to plone/app/upgrade/v52/profiles/to_522/registry/image_captioning.xml\n'

