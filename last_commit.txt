Repository: plone.dexterity


Branch: refs/heads/master
Date: 2018-10-06T14:50:58+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.dexterity/commit/6ad81412b663f789a42cdeaa68facfcbd3f5a42f

Fixed test for minor check_id change.

We need the 'Access contents information' permission.
https://github.com/plone/Products.CMFPlone/issues/2582

Files changed:
A news/2582.trivial
M plone/dexterity/tests/test_utils.py

b"diff --git a/news/2582.trivial b/news/2582.trivial\nnew file mode 100644\nindex 0000000..1fbbc3b\n--- /dev/null\n+++ b/news/2582.trivial\n@@ -0,0 +1,3 @@\n+Fixed test for minor check_id change.\n+\n+We need the 'Access contents information' permission.\ndiff --git a/plone/dexterity/tests/test_utils.py b/plone/dexterity/tests/test_utils.py\nindex e876380..24f1a86 100644\n--- a/plone/dexterity/tests/test_utils.py\n+++ b/plone/dexterity/tests/test_utils.py\n@@ -52,6 +52,10 @@ def testAddContentToContainer_preserves_existing_id(self):\n         from plone.dexterity.content import Container\n         container = Container()\n         container._ordering = u'unordered'\n+        # Allow anyone to access the contents information on the container.\n+        # This allows to check for existing content with the same id.\n+        container.manage_permission(\n+            'Access contents information', ['Anonymous'], acquire=1)\n \n         from zope.component import provideAdapter, provideUtility\n         from zope.container.interfaces import INameChooser\n"

Repository: plone.dexterity


Branch: refs/heads/master
Date: 2018-10-22T21:22:14+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.dexterity/commit/52df4b33523b4937fbd0961ff8f584f0e1123e84

Merge pull request #92 from plone/fix-check-id-test

Fixed test for minor check_id change.

Files changed:
A news/2582.trivial
M plone/dexterity/tests/test_utils.py

b"diff --git a/news/2582.trivial b/news/2582.trivial\nnew file mode 100644\nindex 0000000..1fbbc3b\n--- /dev/null\n+++ b/news/2582.trivial\n@@ -0,0 +1,3 @@\n+Fixed test for minor check_id change.\n+\n+We need the 'Access contents information' permission.\ndiff --git a/plone/dexterity/tests/test_utils.py b/plone/dexterity/tests/test_utils.py\nindex e876380..24f1a86 100644\n--- a/plone/dexterity/tests/test_utils.py\n+++ b/plone/dexterity/tests/test_utils.py\n@@ -52,6 +52,10 @@ def testAddContentToContainer_preserves_existing_id(self):\n         from plone.dexterity.content import Container\n         container = Container()\n         container._ordering = u'unordered'\n+        # Allow anyone to access the contents information on the container.\n+        # This allows to check for existing content with the same id.\n+        container.manage_permission(\n+            'Access contents information', ['Anonymous'], acquire=1)\n \n         from zope.component import provideAdapter, provideUtility\n         from zope.container.interfaces import INameChooser\n"

