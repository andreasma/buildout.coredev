Repository: plone.app.upgrade


Branch: refs/heads/master
Date: 2019-02-12T20:45:42+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.upgrade/commit/94e8413d8e5be5a909addd73d94f0bd0d302081b

Fixed permission error while removing old resource registries.

Fixes https://github.com/plone/plone.app.upgrade/issues/197

Files changed:
A news/197.bugfix
M plone/app/upgrade/v52/betas.py

b'diff --git a/news/197.bugfix b/news/197.bugfix\nnew file mode 100644\nindex 00000000..4603befd\n--- /dev/null\n+++ b/news/197.bugfix\n@@ -0,0 +1,2 @@\n+Fixed permission error while removing old resource registries.\n+[maurits]\ndiff --git a/plone/app/upgrade/v52/betas.py b/plone/app/upgrade/v52/betas.py\nindex 925ef0e9..8ba2c9fc 100644\n--- a/plone/app/upgrade/v52/betas.py\n+++ b/plone/app/upgrade/v52/betas.py\n@@ -43,9 +43,10 @@ def remove_legacy_resource_registries(context):\n     ]\n \n     # remove obsolete tools\n-    tools = [t for t in tools_to_remove if t in portal]\n-    if tools:\n-        portal.manage_delObjects(tools)\n+    for tool in tools_to_remove:\n+        if tool not in portal:\n+            continue\n+        portal._delObject(tool)\n \n     cleanUpToolRegistry(context)\n \n'

Repository: plone.app.upgrade


Branch: refs/heads/master
Date: 2019-02-19T11:57:28+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.upgrade/commit/2659b4470ca43530c02d2d765cd37050c6510926

Merge pull request #198 from plone/maurits-fix-remove_legacy_resource_registries

Fixed permission error while removing old resource registries.

Files changed:
A news/197.bugfix
M plone/app/upgrade/v52/betas.py

b'diff --git a/news/197.bugfix b/news/197.bugfix\nnew file mode 100644\nindex 00000000..4603befd\n--- /dev/null\n+++ b/news/197.bugfix\n@@ -0,0 +1,2 @@\n+Fixed permission error while removing old resource registries.\n+[maurits]\ndiff --git a/plone/app/upgrade/v52/betas.py b/plone/app/upgrade/v52/betas.py\nindex 925ef0e9..8ba2c9fc 100644\n--- a/plone/app/upgrade/v52/betas.py\n+++ b/plone/app/upgrade/v52/betas.py\n@@ -43,9 +43,10 @@ def remove_legacy_resource_registries(context):\n     ]\n \n     # remove obsolete tools\n-    tools = [t for t in tools_to_remove if t in portal]\n-    if tools:\n-        portal.manage_delObjects(tools)\n+    for tool in tools_to_remove:\n+        if tool not in portal:\n+            continue\n+        portal._delObject(tool)\n \n     cleanUpToolRegistry(context)\n \n'

