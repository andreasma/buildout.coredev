Repository: plone.testing


Branch: refs/heads/4.3.x
Date: 2019-03-27T08:32:08+01:00
Author: Peter Mathis (petschki) <peter.mathis@kombinat.at>
Commit: https://github.com/plone/plone.testing/commit/7a6a4c97426aff6e94d51fe9a1c7a55b592b1a99

set default ZPublisher encoding to utf-8

Files changed:
M CHANGES.rst
M src/plone/testing/z2.py
M src/plone/testing/z2.rst

b"diff --git a/CHANGES.rst b/CHANGES.rst\nindex 841efbf..6c84372 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -14,7 +14,8 @@ New features:\n \n Bug fixes:\n \n-- *add item here*\n+- Set default ZPublisher encoding to utf-8 to avoid encoding errors in testbrowser\n+  [petschki]\n \n \n 4.3.2 (2018-10-05)\ndiff --git a/src/plone/testing/z2.py b/src/plone/testing/z2.py\nindex 6f7d916..fc86f30 100644\n--- a/src/plone/testing/z2.py\n+++ b/src/plone/testing/z2.py\n@@ -622,6 +622,11 @@ def setUpApp(self):\n             del config.testinghome\n             App.config.setConfiguration(config)\n \n+        # set the default ZPublisher encoding to utf-8\n+        # so data without encoding header is handled correctly...\n+        from Zope2.Startup.datatypes import default_zpublisher_encoding\n+        default_zpublisher_encoding('utf-8')\n+\n         # This uses the DB from the dbtab, as configured in setUpDatabase().\n         # That DB then gets stored as Zope2.DB and becomes the default.\n \ndiff --git a/src/plone/testing/z2.rst b/src/plone/testing/z2.rst\nindex f0fb4ac..5b0cc68 100644\n--- a/src/plone/testing/z2.rst\n+++ b/src/plone/testing/z2.rst\n@@ -383,6 +383,11 @@ We can now view this via the test browser:::\n     >>> 'folder1' in browser.contents\n     True\n \n+Check if the default ZPublisher encoding is set to utf-8\n+\n+    >>> browser.headers['content-type']\n+    'text/plain; charset=utf-8'\n+\n The test browser integration converts the URL into a request and passes control to Zope's publisher.\n Let's check that query strings are available for input processing:::\n \n"

Repository: plone.testing


Branch: refs/heads/4.3.x
Date: 2019-03-27T09:16:47+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.testing/commit/b90ad2fabc13b9bd08156fca992127ad3ebbc2d5

Merge pull request #63 from plone/issue_62

set default ZPublisher encoding to utf-8

Files changed:
M CHANGES.rst
M src/plone/testing/z2.py
M src/plone/testing/z2.rst

b"diff --git a/CHANGES.rst b/CHANGES.rst\nindex 841efbf..6c84372 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -14,7 +14,8 @@ New features:\n \n Bug fixes:\n \n-- *add item here*\n+- Set default ZPublisher encoding to utf-8 to avoid encoding errors in testbrowser\n+  [petschki]\n \n \n 4.3.2 (2018-10-05)\ndiff --git a/src/plone/testing/z2.py b/src/plone/testing/z2.py\nindex 6f7d916..fc86f30 100644\n--- a/src/plone/testing/z2.py\n+++ b/src/plone/testing/z2.py\n@@ -622,6 +622,11 @@ def setUpApp(self):\n             del config.testinghome\n             App.config.setConfiguration(config)\n \n+        # set the default ZPublisher encoding to utf-8\n+        # so data without encoding header is handled correctly...\n+        from Zope2.Startup.datatypes import default_zpublisher_encoding\n+        default_zpublisher_encoding('utf-8')\n+\n         # This uses the DB from the dbtab, as configured in setUpDatabase().\n         # That DB then gets stored as Zope2.DB and becomes the default.\n \ndiff --git a/src/plone/testing/z2.rst b/src/plone/testing/z2.rst\nindex f0fb4ac..5b0cc68 100644\n--- a/src/plone/testing/z2.rst\n+++ b/src/plone/testing/z2.rst\n@@ -383,6 +383,11 @@ We can now view this via the test browser:::\n     >>> 'folder1' in browser.contents\n     True\n \n+Check if the default ZPublisher encoding is set to utf-8\n+\n+    >>> browser.headers['content-type']\n+    'text/plain; charset=utf-8'\n+\n The test browser integration converts the URL into a request and passes control to Zope's publisher.\n Let's check that query strings are available for input processing:::\n \n"

