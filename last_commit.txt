Repository: Products.CMFPlone


Branch: refs/heads/5.1.x
Date: 2018-07-10T10:10:41+02:00
Author: Markus Hilbert (iham) <markus.hilbert@iham.at>
Commit: https://github.com/plone/Products.CMFPlone/commit/45ceb3b9a6c77e0c9d964a49110ddbec87c5a3e6

Fixed tests when IRichText behavior is used.

Files changed:
M CHANGES.rst
M Products/CMFPlone/profiles/default/metadata.xml
M Products/CMFPlone/tests/AddMoveAndDeleteDocument.txt
M Products/CMFPlone/tests/browser_collection_views.txt

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex 19fa7b337..82c3b05b0 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -18,7 +18,10 @@ New features:\n \n Bug fixes:\n \n-- *add item here*\n+- Fixed tests when IRichText behavior is used.\n+  IRichText -> IRichTextBehavior\n+  This is a follow up to `issue 476 <https://github.com/plone/plone.app.contenttypes/issues/476>`_.\n+  [iham]\n \n \n 5.1.3 (2018-06-22)\ndiff --git a/Products/CMFPlone/profiles/default/metadata.xml b/Products/CMFPlone/profiles/default/metadata.xml\nindex 010566179..6eb263fea 100644\n--- a/Products/CMFPlone/profiles/default/metadata.xml\n+++ b/Products/CMFPlone/profiles/default/metadata.xml\n@@ -1,4 +1,4 @@\n <?xml version="1.0"?>\n <metadata>\n-  <version>5113</version>\n+  <version>5114</version>\n </metadata>\ndiff --git a/Products/CMFPlone/tests/AddMoveAndDeleteDocument.txt b/Products/CMFPlone/tests/AddMoveAndDeleteDocument.txt\nindex 1674c4048..abd67864d 100644\n--- a/Products/CMFPlone/tests/AddMoveAndDeleteDocument.txt\n+++ b/Products/CMFPlone/tests/AddMoveAndDeleteDocument.txt\n@@ -51,7 +51,7 @@ browser.\n Now that the document has been added, we can edit it, but we pretend\n we don\'t know better and forget to type in a Title:\n \n-    >>> browser.getControl(name=\'form.widgets.IRichText.text\').value = \'About me\'\n+    >>> browser.getControl(name=\'form.widgets.IRichTextBehavior.text\').value = \'About me\'\n     >>> browser.getControl(\'Save\').click()\n     >>> \'Required input is missing.\' in browser.contents\n     True\n@@ -186,7 +186,7 @@ between cut and paste, the page should say so and not give a stacktrace.\n \n     >>> browser.open(\'http://nohost/plone\')\n     >>> browser.getLink(\'Page\').click()\n-    >>> browser.getControl(name=\'form.widgets.IRichText.text\').value = \'\'\n+    >>> browser.getControl(name=\'form.widgets.IRichTextBehavior.text\').value = \'\'\n     >>> browser.getControl(\'Title\').value = \'Op een dag\'\n     >>> browser.getControl(\'Save\').click()\n     >>> \'Op een dag\' in browser.contents\ndiff --git a/Products/CMFPlone/tests/browser_collection_views.txt b/Products/CMFPlone/tests/browser_collection_views.txt\nindex 2d0465e61..263f12361 100644\n--- a/Products/CMFPlone/tests/browser_collection_views.txt\n+++ b/Products/CMFPlone/tests/browser_collection_views.txt\n@@ -35,8 +35,8 @@ First create a folder and a demo collection:\n     >>> collection_description = \'Description. Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod.\'\n     >>> browser.getControl(name=\'form.widgets.IDublinCore.description\').value = collection_description\n     >>> collection_text = \'<p>Text. Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>\'\n-    >>> browser.getControl(name=\'form.widgets.IRichText.text\').value = collection_text\n-    >>> browser.getControl(name=\'form.widgets.IRichText.text.mimeType\').value = [\'text/html\']\n+    >>> browser.getControl(name=\'form.widgets.IRichTextBehavior.text\').value = collection_text\n+    >>> browser.getControl(name=\'form.widgets.IRichTextBehavior.text.mimeType\').value = [\'text/html\']\n     >>> browser.getControl(\'Save\').click()\n \n Now let\'s login and visit the collection in the test browser:\n'

Repository: Products.CMFPlone


Branch: refs/heads/5.1.x
Date: 2018-07-11T12:02:06+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.CMFPlone/commit/d215798db016e99537f9a0615d80e6c07dad3a7a

Merge branch '5.1.x' into issue_2466

Files changed:
M CHANGES.rst
M Products/CMFPlone/tests/testCatalogTool.py

b"diff --git a/CHANGES.rst b/CHANGES.rst\nindex 82c3b05b0..7d8e56639 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -23,6 +23,9 @@ Bug fixes:\n   This is a follow up to `issue 476 <https://github.com/plone/plone.app.contenttypes/issues/476>`_.\n   [iham]\n \n+- Add test for issue #2469.\n+  [jensens]\n+\n \n 5.1.3 (2018-06-22)\n ------------------\ndiff --git a/Products/CMFPlone/tests/testCatalogTool.py b/Products/CMFPlone/tests/testCatalogTool.py\nindex c64e08ff4..fdf695cc8 100644\n--- a/Products/CMFPlone/tests/testCatalogTool.py\n+++ b/Products/CMFPlone/tests/testCatalogTool.py\n@@ -339,6 +339,20 @@ def testClearFindAndRebuildKeepsModificationDate(self):\n         self.assertEqual(self.folder.doc.modified(), DateTime(0))\n         self.assertEqual(len(self.catalog(modified=DateTime(0))), 1)\n \n+    def test_acquired_attributes_are_not_indexed(self):\n+        # create an index for foo:\n+        # from Products.PluginIndexes.FieldIndex.FieldIndex import FieldIndex\n+        self.catalog.addIndex('foo', 'FieldIndex')\n+\n+        # create attribute foo on folder and index on both, folder and\n+        # contained\n+        self.folder.foo = 'FOO'\n+        self.catalog.clearFindAndRebuild()\n+\n+        # lets see if we have one result for folder, but nothing for doc:\n+        brains = self.catalog(foo='FOO')\n+        self.assertEqual(len(brains), 1)\n+\n \n class TestCatalogSearching(PloneTestCase):\n \n"

Repository: Products.CMFPlone


Branch: refs/heads/5.1.x
Date: 2018-07-11T12:25:56+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.CMFPlone/commit/6a00ba130a0b8234d480700cab53b96229f57a43

Merge pull request #2467 from plone/issue_2466

Fixed tests when IRichText behavior is used.

Files changed:
M CHANGES.rst
M Products/CMFPlone/tests/AddMoveAndDeleteDocument.txt
M Products/CMFPlone/tests/browser_collection_views.txt

b"diff --git a/CHANGES.rst b/CHANGES.rst\nindex 692e26ff7..7d8e56639 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -18,6 +18,11 @@ New features:\n \n Bug fixes:\n \n+- Fixed tests when IRichText behavior is used.\n+  IRichText -> IRichTextBehavior\n+  This is a follow up to `issue 476 <https://github.com/plone/plone.app.contenttypes/issues/476>`_.\n+  [iham]\n+\n - Add test for issue #2469.\n   [jensens]\n \ndiff --git a/Products/CMFPlone/tests/AddMoveAndDeleteDocument.txt b/Products/CMFPlone/tests/AddMoveAndDeleteDocument.txt\nindex 1674c4048..abd67864d 100644\n--- a/Products/CMFPlone/tests/AddMoveAndDeleteDocument.txt\n+++ b/Products/CMFPlone/tests/AddMoveAndDeleteDocument.txt\n@@ -51,7 +51,7 @@ browser.\n Now that the document has been added, we can edit it, but we pretend\n we don't know better and forget to type in a Title:\n \n-    >>> browser.getControl(name='form.widgets.IRichText.text').value = 'About me'\n+    >>> browser.getControl(name='form.widgets.IRichTextBehavior.text').value = 'About me'\n     >>> browser.getControl('Save').click()\n     >>> 'Required input is missing.' in browser.contents\n     True\n@@ -186,7 +186,7 @@ between cut and paste, the page should say so and not give a stacktrace.\n \n     >>> browser.open('http://nohost/plone')\n     >>> browser.getLink('Page').click()\n-    >>> browser.getControl(name='form.widgets.IRichText.text').value = ''\n+    >>> browser.getControl(name='form.widgets.IRichTextBehavior.text').value = ''\n     >>> browser.getControl('Title').value = 'Op een dag'\n     >>> browser.getControl('Save').click()\n     >>> 'Op een dag' in browser.contents\ndiff --git a/Products/CMFPlone/tests/browser_collection_views.txt b/Products/CMFPlone/tests/browser_collection_views.txt\nindex 2d0465e61..263f12361 100644\n--- a/Products/CMFPlone/tests/browser_collection_views.txt\n+++ b/Products/CMFPlone/tests/browser_collection_views.txt\n@@ -35,8 +35,8 @@ First create a folder and a demo collection:\n     >>> collection_description = 'Description. Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod.'\n     >>> browser.getControl(name='form.widgets.IDublinCore.description').value = collection_description\n     >>> collection_text = '<p>Text. Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>'\n-    >>> browser.getControl(name='form.widgets.IRichText.text').value = collection_text\n-    >>> browser.getControl(name='form.widgets.IRichText.text.mimeType').value = ['text/html']\n+    >>> browser.getControl(name='form.widgets.IRichTextBehavior.text').value = collection_text\n+    >>> browser.getControl(name='form.widgets.IRichTextBehavior.text.mimeType').value = ['text/html']\n     >>> browser.getControl('Save').click()\n \n Now let's login and visit the collection in the test browser:\n"

