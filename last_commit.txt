Repository: plone.app.content


Branch: refs/heads/master
Date: 2018-10-02T15:43:15+02:00
Author: Manuel Reinhardt (reinhardt) <reinhardt@syslab.com>
Commit: https://github.com/plone/plone.app.content/commit/0ca604e2773aee7b12ff5d20f9de1d0e3e76b60a

Use obj.get_size() instead of getObjSize skin script.
Allows removing the script and also returns a numerical value
which makes more sense here. #1801

Files changed:
M CHANGES.rst
M plone/app/content/browser/file.py
M plone/app/content/browser/reviewlist.py

b"diff --git a/CHANGES.rst b/CHANGES.rst\nindex f5cc852..d8c7acb 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -10,7 +10,10 @@ Breaking changes:\n \n New features:\n \n-- *add item here*\n+- Use obj.get_size() instead of getObjSize skin script.\n+  Allows removing the script and also returns a numerical value.\n+  #1801\n+  [reinhardt]\n \n Bug fixes:\n \ndiff --git a/plone/app/content/browser/file.py b/plone/app/content/browser/file.py\nindex 6fce2c6..105bcbb 100644\n--- a/plone/app/content/browser/file.py\n+++ b/plone/app/content/browser/file.py\n@@ -180,7 +180,7 @@ def __call__(self):\n             try:\n                 result['size'] = obj.getSize()\n             except AttributeError:\n-                result['size'] = obj.getObjSize()\n+                result['size'] = obj.get_size()\n \n         if tusrequest:\n             tus.cleanup_file()\ndiff --git a/plone/app/content/browser/reviewlist.py b/plone/app/content/browser/reviewlist.py\nindex 9419a52..613c60a 100644\n--- a/plone/app/content/browser/reviewlist.py\n+++ b/plone/app/content/browser/reviewlist.py\n@@ -5,6 +5,7 @@\n from plone.registry.interfaces import IRegistry\n from Products.CMFCore.utils import getToolByName\n from Products.CMFPlone.utils import safe_unicode\n+from Products.CMFPlone.utils import human_readable_size\n from six.moves import map\n from six.moves.urllib.parse import quote_plus\n from zope.component import getMultiAdapter\n@@ -114,7 +115,7 @@ def items(self):\n                 title_or_id=obj.pretty_title_or_id(),\n                 description=obj.Description(),\n                 obj_type=obj.Type,\n-                size=obj.getObjSize(),\n+                size=human_readable_size(obj.get_size()),\n                 modified=modified,\n                 type_class=type_class,\n                 wf_state=review_state,\n"

Repository: plone.app.content


Branch: refs/heads/master
Date: 2018-10-02T16:48:20+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.content/commit/c9d8444703ea019ba377ed23c43e248cc1212c86

bump version

Files changed:
M CHANGES.rst
M setup.py

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex d8c7acb..32cee5e 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -1,7 +1,7 @@\n Changelog\n =========\n \n-3.5.5 (unreleased)\n+3.6.0 (unreleased)\n ------------------\n \n Breaking changes:\ndiff --git a/setup.py b/setup.py\nindex d9eeb1a..f9ba034 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -2,7 +2,7 @@\n from setuptools import find_packages\n from setuptools import setup\n \n-version = \'3.5.5.dev0\'\n+version = \'3.6.0.dev0\'\n \n setup(\n     name=\'plone.app.content\',\n@@ -14,7 +14,6 @@\n     ]),\n     classifiers=[\n         "Framework :: Plone",\n-        "Framework :: Plone :: 5.1",\n         "Framework :: Plone :: 5.2",\n         "License :: OSI Approved :: GNU General Public License v2 (GPLv2)",\n         "Programming Language :: Python",\n'

Repository: plone.app.content


Branch: refs/heads/master
Date: 2018-10-02T16:50:32+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.content/commit/3eb4e28260edf154bc5f8ad55637064cf1bd8479

Merge pull request #163 from plone/1801-get-size

Use get_size instead of getObjSize

Files changed:
M CHANGES.rst
M plone/app/content/browser/file.py
M plone/app/content/browser/reviewlist.py
M setup.py

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex f5cc852..32cee5e 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -1,7 +1,7 @@\n Changelog\n =========\n \n-3.5.5 (unreleased)\n+3.6.0 (unreleased)\n ------------------\n \n Breaking changes:\n@@ -10,7 +10,10 @@ Breaking changes:\n \n New features:\n \n-- *add item here*\n+- Use obj.get_size() instead of getObjSize skin script.\n+  Allows removing the script and also returns a numerical value.\n+  #1801\n+  [reinhardt]\n \n Bug fixes:\n \ndiff --git a/plone/app/content/browser/file.py b/plone/app/content/browser/file.py\nindex 6fce2c6..105bcbb 100644\n--- a/plone/app/content/browser/file.py\n+++ b/plone/app/content/browser/file.py\n@@ -180,7 +180,7 @@ def __call__(self):\n             try:\n                 result[\'size\'] = obj.getSize()\n             except AttributeError:\n-                result[\'size\'] = obj.getObjSize()\n+                result[\'size\'] = obj.get_size()\n \n         if tusrequest:\n             tus.cleanup_file()\ndiff --git a/plone/app/content/browser/reviewlist.py b/plone/app/content/browser/reviewlist.py\nindex 9419a52..613c60a 100644\n--- a/plone/app/content/browser/reviewlist.py\n+++ b/plone/app/content/browser/reviewlist.py\n@@ -5,6 +5,7 @@\n from plone.registry.interfaces import IRegistry\n from Products.CMFCore.utils import getToolByName\n from Products.CMFPlone.utils import safe_unicode\n+from Products.CMFPlone.utils import human_readable_size\n from six.moves import map\n from six.moves.urllib.parse import quote_plus\n from zope.component import getMultiAdapter\n@@ -114,7 +115,7 @@ def items(self):\n                 title_or_id=obj.pretty_title_or_id(),\n                 description=obj.Description(),\n                 obj_type=obj.Type,\n-                size=obj.getObjSize(),\n+                size=human_readable_size(obj.get_size()),\n                 modified=modified,\n                 type_class=type_class,\n                 wf_state=review_state,\ndiff --git a/setup.py b/setup.py\nindex d9eeb1a..f9ba034 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -2,7 +2,7 @@\n from setuptools import find_packages\n from setuptools import setup\n \n-version = \'3.5.5.dev0\'\n+version = \'3.6.0.dev0\'\n \n setup(\n     name=\'plone.app.content\',\n@@ -14,7 +14,6 @@\n     ]),\n     classifiers=[\n         "Framework :: Plone",\n-        "Framework :: Plone :: 5.1",\n         "Framework :: Plone :: 5.2",\n         "License :: OSI Approved :: GNU General Public License v2 (GPLv2)",\n         "Programming Language :: Python",\n'

