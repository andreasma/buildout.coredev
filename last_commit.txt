Repository: plone.app.z3cform


Branch: refs/heads/master
Date: 2018-10-14T11:57:11+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.app.z3cform/commit/eef6587f58531bd8d27964b46dc466deaae5c19d

fix rendering in py2

Files changed:
M plone/app/z3cform/widget.py

b"diff --git a/plone/app/z3cform/widget.py b/plone/app/z3cform/widget.py\nindex a671c5a..d28134c 100644\n--- a/plone/app/z3cform/widget.py\n+++ b/plone/app/z3cform/widget.py\n@@ -698,7 +698,7 @@ def render(self):\n                     mt_select.append(opt)\n \n                 # Render the combined widget\n-                rendered = '{0}\\n{1}'.format(\n+                rendered = u'{0}\\n{1}'.format(\n                     textarea_widget.render(),\n                     etree.tostring(mt_select, encoding='unicode'),\n                 )\n"

Repository: plone.app.z3cform


Branch: refs/heads/master
Date: 2018-10-14T11:58:03+02:00
Author: David Glick (davisagli) <david@glicksoftware.com>
Commit: https://github.com/plone/plone.app.z3cform/commit/5eead45e89ef2d836ed3398e93ac4c73ea7827e0

Try to fix weird double import/identity problem

Files changed:
M plone/app/z3cform/tests/test_widgets.py

b"diff --git a/plone/app/z3cform/tests/test_widgets.py b/plone/app/z3cform/tests/test_widgets.py\nindex 117bbd4..ee9cbd5 100644\n--- a/plone/app/z3cform/tests/test_widgets.py\n+++ b/plone/app/z3cform/tests/test_widgets.py\n@@ -6,6 +6,7 @@\n from lxml import html\n from plone.app.testing import setRoles\n from plone.app.testing import TEST_USER_ID\n+from plone.app.widgets.utils import NotImplemented as PatternNotImplemented\n from plone.app.z3cform.tests.layer import PAZ3CForm_INTEGRATION_TESTING\n from plone.app.z3cform.widget import BaseWidget\n from plone.app.z3cform.widget import DateWidget\n@@ -74,13 +75,11 @@ def setUp(self):\n         self.maxDiff = 999999\n \n     def test_widget_pattern_notimplemented(self):\n-        from plone.app.widgets.utils import NotImplemented\n-\n         widget = BaseWidget(self.request)\n         widget.field = self.field\n \n         self.assertRaises(\n-            NotImplemented,\n+            PatternNotImplemented,\n             widget._base_args,\n         )\n \n@@ -97,14 +96,13 @@ def test_widget_pattern_notimplemented(self):\n     def test_widget_base_notimplemented(self):\n         from plone.app.z3cform.widget import BaseWidget\n         from plone.app.widgets.base import InputWidget\n-        from plone.app.widgets.utils import NotImplemented\n \n         widget = BaseWidget(self.request)\n         widget.field = self.field\n         widget.pattern = 'example'\n \n         self.assertRaises(\n-            NotImplemented,\n+            PatternNotImplemented,\n             widget.render,\n         )\n \n"

Repository: plone.app.z3cform


Branch: refs/heads/master
Date: 2018-10-14T11:58:03+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.z3cform/commit/08c315da5694adfdd1af6f009aac19ec15c7d7a2

solve zcml loading name collision

Files changed:
A plone/app/z3cform/views.py
M plone/app/z3cform/configure.zcml
D plone/app/z3cform/templates.py

b'diff --git a/plone/app/z3cform/configure.zcml b/plone/app/z3cform/configure.zcml\nindex d6394dd..7792d3c 100644\n--- a/plone/app/z3cform/configure.zcml\n+++ b/plone/app/z3cform/configure.zcml\n@@ -20,7 +20,7 @@\n       name="ploneform-macros"\n       for="*"\n       layer=".interfaces.IPloneFormLayer"\n-      class=".templates.Macros"\n+      class=".views.Macros"\n       template="templates/macros.pt"\n       allowed_interface="zope.interface.common.mapping.IItemMapping"\n       permission="zope.Public"\n@@ -29,19 +29,19 @@\n       name="ploneform-render-widget"\n       for="z3c.form.interfaces.IWidget"\n       layer="plone.app.z3cform.interfaces.IPloneFormLayer"\n-      class=".templates.RenderWidget"\n+      class=".views.RenderWidget"\n       permission="zope.Public"\n       />\n   <browser:page\n       name="ploneform-render-widget"\n       for="zope.contentprovider.interfaces.IContentProvider"\n       layer="plone.app.z3cform.interfaces.IPloneFormLayer"\n-      class=".templates.RenderContentProvider"\n+      class=".views.RenderContentProvider"\n       permission="zope.Public"\n       />\n \n-  <adapter factory=".templates.layout_factory" />\n-  <adapter factory=".templates.form_factory" />\n+  <adapter factory=".views.layout_factory" />\n+  <adapter factory=".views.form_factory" />\n \n   <!-- Make the default widget for sequence-of-text-lines a textlines\n        widget; the default is too confusing\ndiff --git a/plone/app/z3cform/templates.py b/plone/app/z3cform/views.py\nsimilarity index 100%\nrename from plone/app/z3cform/templates.py\nrename to plone/app/z3cform/views.py\n'

Repository: plone.app.z3cform


Branch: refs/heads/master
Date: 2018-10-14T12:00:11+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.app.z3cform/commit/04ad571f9f425e7121a6e4354aca1b3408acb2c8

Merge branch 'python3' into fix-tests

Files changed:
M plone/app/z3cform/widget.py

b"diff --git a/plone/app/z3cform/widget.py b/plone/app/z3cform/widget.py\nindex a671c5a..d28134c 100644\n--- a/plone/app/z3cform/widget.py\n+++ b/plone/app/z3cform/widget.py\n@@ -698,7 +698,7 @@ def render(self):\n                     mt_select.append(opt)\n \n                 # Render the combined widget\n-                rendered = '{0}\\n{1}'.format(\n+                rendered = u'{0}\\n{1}'.format(\n                     textarea_widget.render(),\n                     etree.tostring(mt_select, encoding='unicode'),\n                 )\n"

Repository: plone.app.z3cform


Branch: refs/heads/master
Date: 2018-10-14T13:54:01+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.app.z3cform/commit/1a205fc38b785a229c89592a6c6111db36caa378

Merge pull request #96 from plone/fix-tests

Fix tests

Files changed:
A plone/app/z3cform/views.py
M plone/app/z3cform/configure.zcml
M plone/app/z3cform/tests/test_widgets.py
M plone/app/z3cform/widget.py
D plone/app/z3cform/templates.py

b'diff --git a/plone/app/z3cform/configure.zcml b/plone/app/z3cform/configure.zcml\nindex d6394dd..7792d3c 100644\n--- a/plone/app/z3cform/configure.zcml\n+++ b/plone/app/z3cform/configure.zcml\n@@ -20,7 +20,7 @@\n       name="ploneform-macros"\n       for="*"\n       layer=".interfaces.IPloneFormLayer"\n-      class=".templates.Macros"\n+      class=".views.Macros"\n       template="templates/macros.pt"\n       allowed_interface="zope.interface.common.mapping.IItemMapping"\n       permission="zope.Public"\n@@ -29,19 +29,19 @@\n       name="ploneform-render-widget"\n       for="z3c.form.interfaces.IWidget"\n       layer="plone.app.z3cform.interfaces.IPloneFormLayer"\n-      class=".templates.RenderWidget"\n+      class=".views.RenderWidget"\n       permission="zope.Public"\n       />\n   <browser:page\n       name="ploneform-render-widget"\n       for="zope.contentprovider.interfaces.IContentProvider"\n       layer="plone.app.z3cform.interfaces.IPloneFormLayer"\n-      class=".templates.RenderContentProvider"\n+      class=".views.RenderContentProvider"\n       permission="zope.Public"\n       />\n \n-  <adapter factory=".templates.layout_factory" />\n-  <adapter factory=".templates.form_factory" />\n+  <adapter factory=".views.layout_factory" />\n+  <adapter factory=".views.form_factory" />\n \n   <!-- Make the default widget for sequence-of-text-lines a textlines\n        widget; the default is too confusing\ndiff --git a/plone/app/z3cform/tests/test_widgets.py b/plone/app/z3cform/tests/test_widgets.py\nindex 117bbd4..ee9cbd5 100644\n--- a/plone/app/z3cform/tests/test_widgets.py\n+++ b/plone/app/z3cform/tests/test_widgets.py\n@@ -6,6 +6,7 @@\n from lxml import html\n from plone.app.testing import setRoles\n from plone.app.testing import TEST_USER_ID\n+from plone.app.widgets.utils import NotImplemented as PatternNotImplemented\n from plone.app.z3cform.tests.layer import PAZ3CForm_INTEGRATION_TESTING\n from plone.app.z3cform.widget import BaseWidget\n from plone.app.z3cform.widget import DateWidget\n@@ -74,13 +75,11 @@ def setUp(self):\n         self.maxDiff = 999999\n \n     def test_widget_pattern_notimplemented(self):\n-        from plone.app.widgets.utils import NotImplemented\n-\n         widget = BaseWidget(self.request)\n         widget.field = self.field\n \n         self.assertRaises(\n-            NotImplemented,\n+            PatternNotImplemented,\n             widget._base_args,\n         )\n \n@@ -97,14 +96,13 @@ def test_widget_pattern_notimplemented(self):\n     def test_widget_base_notimplemented(self):\n         from plone.app.z3cform.widget import BaseWidget\n         from plone.app.widgets.base import InputWidget\n-        from plone.app.widgets.utils import NotImplemented\n \n         widget = BaseWidget(self.request)\n         widget.field = self.field\n         widget.pattern = \'example\'\n \n         self.assertRaises(\n-            NotImplemented,\n+            PatternNotImplemented,\n             widget.render,\n         )\n \ndiff --git a/plone/app/z3cform/templates.py b/plone/app/z3cform/views.py\nsimilarity index 100%\nrename from plone/app/z3cform/templates.py\nrename to plone/app/z3cform/views.py\ndiff --git a/plone/app/z3cform/widget.py b/plone/app/z3cform/widget.py\nindex a671c5a..d28134c 100644\n--- a/plone/app/z3cform/widget.py\n+++ b/plone/app/z3cform/widget.py\n@@ -698,7 +698,7 @@ def render(self):\n                     mt_select.append(opt)\n \n                 # Render the combined widget\n-                rendered = \'{0}\\n{1}\'.format(\n+                rendered = u\'{0}\\n{1}\'.format(\n                     textarea_widget.render(),\n                     etree.tostring(mt_select, encoding=\'unicode\'),\n                 )\n'

