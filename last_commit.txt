Repository: Products.CMFPlone


Branch: refs/heads/5.1.x
Date: 2018-04-12T01:00:33+02:00
Author: Joni Orponen (Rotonen) <joni.orponen@gmail.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/e6f52ab9d70c09049dec3581be64cea01f12a8ed

Move the gtbn_funcglobals patch security test to functional tests.

Files changed:
M CHANGES.rst
M Products/CMFPlone/tests/testSecurity.py

diff --git a/CHANGES.rst b/CHANGES.rst
index f56dc9639..a71789552 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -18,7 +18,8 @@ New features:
 
 Bug fixes:
 
-- *add item here*
+- Unflakied a unit test.
+  [Rotonen]
 
 
 5.1.2 (2018-04-08)
diff --git a/Products/CMFPlone/tests/testSecurity.py b/Products/CMFPlone/tests/testSecurity.py
index 7a61d6d0d..7b1112ca1 100644
--- a/Products/CMFPlone/tests/testSecurity.py
+++ b/Products/CMFPlone/tests/testSecurity.py
@@ -11,15 +11,6 @@
 
 class TestAttackVectorsUnit(unittest.TestCase):
 
-    def test_gtbn_funcglobals(self):
-        from Products.CMFPlone.utils import getToolByName
-        try:
-            getToolByName(self.assertTrue, 'func_globals')['__builtins__']
-        except TypeError:
-            pass
-        else:
-            self.fail('getToolByName should block access to non CMF tools')
-
     def test_setHeader_drops_LF(self):
         from ZPublisher.HTTPResponse import HTTPResponse
         response = HTTPResponse()
@@ -62,6 +53,15 @@ def test_get_request_var_or_attr_disallowed(self):
 
 class TestAttackVectorsFunctional(PloneTestCase):
 
+    def test_gtbn_funcglobals(self):
+        from Products.CMFPlone.utils import getToolByName
+        try:
+            getToolByName(self.assertTrue, 'func_globals')['__builtins__']
+        except TypeError:
+            pass
+        else:
+            self.fail('getToolByName should block access to non CMF tools')
+
     def test_widget_traversal_1(self):
         res = self.publish(
             '/plone/@@discussion-settings/++widget++moderator_email')


Repository: Products.CMFPlone


Branch: refs/heads/5.1.x
Date: 2018-04-12T08:23:29+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/Products.CMFPlone/commit/e143f0f674562f847b653a879915df635e53ba82

Merge pull request #2381 from plone/roto-move-test-5.1.x

Move the gtbn_funcglobals patch security test to functional tests

Files changed:
M CHANGES.rst
M Products/CMFPlone/tests/testSecurity.py

diff --git a/CHANGES.rst b/CHANGES.rst
index f56dc9639..a71789552 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -18,7 +18,8 @@ New features:
 
 Bug fixes:
 
-- *add item here*
+- Unflakied a unit test.
+  [Rotonen]
 
 
 5.1.2 (2018-04-08)
diff --git a/Products/CMFPlone/tests/testSecurity.py b/Products/CMFPlone/tests/testSecurity.py
index 7a61d6d0d..7b1112ca1 100644
--- a/Products/CMFPlone/tests/testSecurity.py
+++ b/Products/CMFPlone/tests/testSecurity.py
@@ -11,15 +11,6 @@
 
 class TestAttackVectorsUnit(unittest.TestCase):
 
-    def test_gtbn_funcglobals(self):
-        from Products.CMFPlone.utils import getToolByName
-        try:
-            getToolByName(self.assertTrue, 'func_globals')['__builtins__']
-        except TypeError:
-            pass
-        else:
-            self.fail('getToolByName should block access to non CMF tools')
-
     def test_setHeader_drops_LF(self):
         from ZPublisher.HTTPResponse import HTTPResponse
         response = HTTPResponse()
@@ -62,6 +53,15 @@ def test_get_request_var_or_attr_disallowed(self):
 
 class TestAttackVectorsFunctional(PloneTestCase):
 
+    def test_gtbn_funcglobals(self):
+        from Products.CMFPlone.utils import getToolByName
+        try:
+            getToolByName(self.assertTrue, 'func_globals')['__builtins__']
+        except TypeError:
+            pass
+        else:
+            self.fail('getToolByName should block access to non CMF tools')
+
     def test_widget_traversal_1(self):
         res = self.publish(
             '/plone/@@discussion-settings/++widget++moderator_email')


