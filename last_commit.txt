Repository: plone.app.contenttypes


Branch: refs/heads/1.2.x
Date: 2018-10-01T15:27:46+02:00
Author: ale-rt (ale-rt) <alessandro.pisa@gmail.com>
Commit: https://github.com/plone/plone.app.contenttypes/commit/9fcfd4a35e47f488df776905c4f2495e57f1d687

Fix the Format accessor

The ``Format`` accessor should actually return the ``format`` attribute
(see plone/Products.CMFPlone#2540)

Files changed:
M CHANGES.rst
M plone/app/contenttypes/content.py

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex 9580584f..8dad06f1 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -14,7 +14,9 @@ New features:\n \n Bug fixes:\n \n-- *add item here*\n+- The ``Format`` accessor should actually return the ``format`` attribute\n+  (see plone/Products.CMFPlone#2540)\n+  [ale-rt]\n \n \n 1.2.26 (2017-10-06)\ndiff --git a/plone/app/contenttypes/content.py b/plone/app/contenttypes/content.py\nindex 90e732ba..e5f0ead4 100644\n--- a/plone/app/contenttypes/content.py\n+++ b/plone/app/contenttypes/content.py\n@@ -73,6 +73,14 @@ def results(self, **kwargs):\n class Document(Item):\n     """Convenience subclass for ``Document`` portal type\n     """\n+    def Format(self):\n+        \'\'\' Provide a proper accessor for the format attribute\n+        See https://github.com/plone/Products.CMFPlone/issues/2540\n+        \'\'\'\n+        format = self.format\n+        if six.PY2 and isinstance(format, six.text_type):\n+            format = self.format.encode()\n+        return format\n \n \n @implementer(IFile)\n'

Repository: plone.app.contenttypes


Branch: refs/heads/1.2.x
Date: 2018-10-01T18:38:42+02:00
Author: ale-rt (ale-rt) <alessandro.pisa@gmail.com>
Commit: https://github.com/plone/plone.app.contenttypes/commit/1e9886f7afbecf7f8a28acba8728c3af738dbb62

Require six

Files changed:
M plone/app/contenttypes/content.py
M setup.py

b"diff --git a/plone/app/contenttypes/content.py b/plone/app/contenttypes/content.py\nindex e5f0ead4..61327180 100644\n--- a/plone/app/contenttypes/content.py\n+++ b/plone/app/contenttypes/content.py\n@@ -15,6 +15,8 @@\n from zope.interface import implementer\n from zope.lifecycleevent import modified\n \n+import six\n+\n \n @implementer(ICollection)\n class Collection(Item):\ndiff --git a/setup.py b/setup.py\nindex 5304ef35..a0f65fc8 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -52,6 +52,7 @@ def read(*rnames):\n           'plone.app.lockingbehavior',\n           'pytz',\n           'plone.app.z3cform>=1.1.0.dev0',\n+          'six',\n           'zope.deprecation',\n       ],\n       extras_require={\n"

Repository: plone.app.contenttypes


Branch: refs/heads/1.2.x
Date: 2018-10-02T09:50:56+02:00
Author: Alessandro Pisa (ale-rt) <alessandro.pisa@gmail.com>
Commit: https://github.com/plone/plone.app.contenttypes/commit/097140514a3e6f31fc7df41ba576bc76aab8f25e

Merge pull request #492 from plone/fix-format-1.2

Fix the Format accessor (1.2.x)

Files changed:
M CHANGES.rst
M plone/app/contenttypes/content.py
M setup.py

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex 9580584f..8dad06f1 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -14,7 +14,9 @@ New features:\n \n Bug fixes:\n \n-- *add item here*\n+- The ``Format`` accessor should actually return the ``format`` attribute\n+  (see plone/Products.CMFPlone#2540)\n+  [ale-rt]\n \n \n 1.2.26 (2017-10-06)\ndiff --git a/plone/app/contenttypes/content.py b/plone/app/contenttypes/content.py\nindex 90e732ba..61327180 100644\n--- a/plone/app/contenttypes/content.py\n+++ b/plone/app/contenttypes/content.py\n@@ -15,6 +15,8 @@\n from zope.interface import implementer\n from zope.lifecycleevent import modified\n \n+import six\n+\n \n @implementer(ICollection)\n class Collection(Item):\n@@ -73,6 +75,14 @@ def results(self, **kwargs):\n class Document(Item):\n     """Convenience subclass for ``Document`` portal type\n     """\n+    def Format(self):\n+        \'\'\' Provide a proper accessor for the format attribute\n+        See https://github.com/plone/Products.CMFPlone/issues/2540\n+        \'\'\'\n+        format = self.format\n+        if six.PY2 and isinstance(format, six.text_type):\n+            format = self.format.encode()\n+        return format\n \n \n @implementer(IFile)\ndiff --git a/setup.py b/setup.py\nindex 5304ef35..a0f65fc8 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -52,6 +52,7 @@ def read(*rnames):\n           \'plone.app.lockingbehavior\',\n           \'pytz\',\n           \'plone.app.z3cform>=1.1.0.dev0\',\n+          \'six\',\n           \'zope.deprecation\',\n       ],\n       extras_require={\n'

